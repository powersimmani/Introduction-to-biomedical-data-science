<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAM/BAM Formats</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px 20px;
        }
        .container { width: 960px; padding: 35px 45px; }
        .title {
            font-size: 36px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 30px;
            text-align: center;
        }
        .section {
            margin-bottom: 25px;
        }
        .section-title {
            font-size: 22px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #e0e8f4;
        }
        .content-box {
            background: #f8fbff;
            border: 2px solid #1E64C8;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
        }
        .bullet-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .bullet-item {
            display: flex;
            align-items: flex-start;
            font-size: 17px;
            color: #333;
        }
        .bullet-item::before {
            content: "‚Ä¢";
            color: #1E64C8;
            font-weight: bold;
            margin-right: 12px;
            font-size: 20px;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .info-box {
            background: #f0f5fc;
            border-left: 4px solid #1E64C8;
            padding: 18px 22px;
            border-radius: 6px;
        }
        .info-label {
            font-size: 16px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 8px;
        }
        .info-text {
            font-size: 16px;
            color: #333;
            line-height: 1.6;
        }
        .highlight-box {
            background: #fff4e6;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 18px 24px;
            text-align: center;
        }
        .highlight-text {
            font-size: 18px;
            color: #333;
            font-weight: 500;
        }
        .spec-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        .spec-box {
            background: #f0f5fc;
            border: 2px solid #1E64C8;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        .spec-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        .spec-value {
            font-size: 18px;
            font-weight: 700;
            color: #1E64C8;
        }
        .example-box {
            background: #ffffff;
            border: 2px solid #4CAF50;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .example-title {
            font-size: 18px;
            font-weight: 600;
            color: #4CAF50;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
        }
        .example-title::before {
            content: "üìå";
            margin-right: 8px;
        }
        .example-content {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.8;
            margin-bottom: 12px;
        }
        .example-description {
            font-size: 15px;
            color: #555;
            line-height: 1.7;
            padding-left: 10px;
        }
        .visual-diagram {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border: 2px solid #1E64C8;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
        }
        .flag-box {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        .flag-item {
            background: #e3f2fd;
            border: 1px solid #2196F3;
            border-radius: 6px;
            padding: 8px 12px;
            font-size: 13px;
            font-family: monospace;
        }
        .cigar-example {
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        .cigar-block {
            padding: 8px 12px;
            border-radius: 5px;
            font-family: monospace;
            font-weight: bold;
            font-size: 14px;
        }
        .cigar-match { background: #c8e6c9; color: #2e7d32; }
        .cigar-insert { background: #fff9c4; color: #f57f17; }
        .cigar-delete { background: #ffcdd2; color: #c62828; }
        .table-container {
            overflow-x: auto;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        th {
            background: #1E64C8;
            color: white;
            padding: 12px;
            text-align: left;
            font-size: 14px;
        }
        td {
            padding: 10px 12px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 13px;
        }
        tr:hover {
            background: #f5f5f5;
        }
        .coord-visual {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .chromosome-bar {
            height: 30px;
            background: linear-gradient(to right, #bbdefb, #2196F3);
            border-radius: 15px;
            position: relative;
            margin: 20px 0;
        }
        .read-marker {
            position: absolute;
            height: 40px;
            background: #4CAF50;
            border: 2px solid #2e7d32;
            border-radius: 5px;
            top: -5px;
        }
        .position-label {
            position: absolute;
            top: 45px;
            font-size: 12px;
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">SAM/BAM Formats</div>
        
        <div class="content-box">
            <div class="section-title">SAM (Sequence Alignment/Map) Format</div>
            <div style="background: #f5f5f5; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 13px; line-height: 1.6; overflow-x: auto;">
                <div><strong>Header:</strong> @HD VN:1.6 SO:coordinate</div>
                <div>@SQ SN:chr1 LN:248956422</div>
                <div><strong>Alignment:</strong> READ1 99 chr1 10001 60 76M = 10052 127 ACGT... IIII...</div>
            </div>
        </div>

        <div class="info-grid">
            <div class="info-box">
                <div class="info-label">SAM (Text)</div>
                <div class="info-text">‚Ä¢ Human-readable<br>‚Ä¢ Tab-delimited<br>‚Ä¢ Large file size<br>‚Ä¢ 11 mandatory fields</div>
            </div>
            <div class="info-box">
                <div class="info-label">BAM (Binary)</div>
                <div class="info-text">‚Ä¢ Compressed SAM<br>‚Ä¢ ~3-5x smaller<br>‚Ä¢ Faster to process<br>‚Ä¢ Requires indexing (.bai)</div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">Key SAM Fields</div>
            <div class="bullet-list">
                <div class="bullet-item">QNAME - Read name</div>
                <div class="bullet-item">FLAG - Bitwise flag (paired, mapped, reverse, etc.)</div>
                <div class="bullet-item">RNAME - Reference sequence name (chromosome)</div>
                <div class="bullet-item">POS - Alignment position</div>
                <div class="bullet-item">MAPQ - Mapping quality score</div>
                <div class="bullet-item">CIGAR - Alignment string (M=match, I=insertion, D=deletion)</div>
            </div>
        </div>

        <!-- ÏÉÅÏÑ∏ ÏòàÏãú ÏÑπÏÖò ÏãúÏûë -->
        <div class="section" style="margin-top: 40px;">
            <div class="section-title">üìä Detailed Examples and Explanations by Field</div>
            
            <!-- QNAME ÏòàÏãú -->
            <div class="example-box">
                <div class="example-title">1. QNAME (Query Name) - Read Name</div>
                <parameter name="example-content">
                    QNAME: HWUSI-EAS100R:6:73:941:1973<br>
                    QNAME: SRR123456.1<br>
                    QNAME: READ_00001
                </div>
                <div class="example-description">
                    <strong>Description:</strong> Unique identifier for each read generated by the sequencing instrument.<br>
                    ‚Ä¢ Typically contains sequencer information and coordinate data<br>
                    ‚Ä¢ Paired reads from the same DNA fragment share the same QNAME<br>
                    ‚Ä¢ Format: InstrumentID:RunNumber:FlowCell:Lane:Tile:X-coord:Y-coord
                </div>
            </div>

            <!-- FLAG ÏòàÏãú -->
            <div class="example-box">
                <div class="example-title">2. FLAG - Bitwise Flag</div>
                <div class="visual-diagram">
                    <div style="font-weight: 600; margin-bottom: 15px; font-size: 16px;">FLAG Value Calculation Example</div>
                    <div class="example-content">
                        FLAG = 99 (0x63)<br>
                        = 1 (paired) + 2 (properly paired) + 32 (mate reverse strand) + 64 (first in pair)
                    </div>
                    <div class="flag-box">
                        <div class="flag-item">0x1 (1) = paired</div>
                        <div class="flag-item">0x2 (2) = properly paired</div>
                        <div class="flag-item">0x4 (4) = unmapped</div>
                        <div class="flag-item">0x8 (8) = mate unmapped</div>
                        <div class="flag-item">0x10 (16) = reverse strand</div>
                        <div class="flag-item">0x20 (32) = mate reverse</div>
                        <div class="flag-item">0x40 (64) = first in pair</div>
                        <div class="flag-item">0x80 (128) = second in pair</div>
                    </div>
                </div>
                <div class="example-description">
                    <strong>Description:</strong> Integer value representing various read attributes in binary format.<br>
                    ‚Ä¢ Efficiently stores multiple attributes in a single number<br>
                    ‚Ä¢ Each bit has independent meaning (verified using AND operation)<br>
                    ‚Ä¢ Example: FLAG=99 ‚Üí Paired read, properly mapped, first read, mate is reverse strand
                </div>
            </div>

            <!-- RNAME & POS ÏòàÏãú -->
            <div class="example-box">
                <div class="example-title">3. RNAME & POS - Reference Sequence Name and Position</div>
                <div class="example-content">
                    RNAME: chr1, chr2, chrX, chrY, chrM<br>
                    POS: 10001 (1-based coordinate)
                </div>
                <div class="coord-visual">
                    <div style="font-weight: 600; margin-bottom: 10px;">Chromosome Position Visualization</div>
                    <div class="chromosome-bar">
                        <div class="read-marker" style="left: 15%; width: 100px;">
                            <div class="position-label" style="left: 30px;">POS: 10001</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 60px; color: #666; font-size: 14px;">
                        ‚Üê chr1 start (1) ¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑ Read mapping position ¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑ chr1 end (248,956,422) ‚Üí
                    </div>
                </div>
                <div class="example-description">
                    <strong>Description:</strong><br>
                    ‚Ä¢ <strong>RNAME:</strong> Chromosome or contig name in reference genome (e.g., chr1, chr2, chrX)<br>
                    ‚Ä¢ <strong>POS:</strong> 1-based coordinate where the read is mapped (chromosome starts at 1)<br>
                    ‚Ä¢ '*' or '0' indicates an unmapped read<br>
                    ‚Ä¢ BAM file indexing (.bai) enables rapid retrieval of specific regions
                </div>
            </div>

            <!-- MAPQ ÏòàÏãú -->
            <div class="example-box">
                <div class="example-title">4. MAPQ - Mapping Quality Score</div>
                <div class="visual-diagram">
                    <div class="table-container">
                        <table>
                            <tr>
                                <th>MAPQ Value</th>
                                <th>Meaning</th>
                                <th>Error Probability</th>
                                <th>Confidence</th>
                            </tr>
                            <tr>
                                <td><strong>60</strong></td>
                                <td>Very high quality</td>
                                <td>0.0001% (1/1,000,000)</td>
                                <td>‚úì‚úì‚úì‚úì‚úì</td>
                            </tr>
                            <tr>
                                <td><strong>40</strong></td>
                                <td>High quality</td>
                                <td>0.01% (1/10,000)</td>
                                <td>‚úì‚úì‚úì‚úì</td>
                            </tr>
                            <tr>
                                <td><strong>20</strong></td>
                                <td>Medium quality</td>
                                <td>1% (1/100)</td>
                                <td>‚úì‚úì‚úì</td>
                            </tr>
                            <tr>
                                <td><strong>10</strong></td>
                                <td>Low quality</td>
                                <td>10% (1/10)</td>
                                <td>‚úì‚úì</td>
                            </tr>
                            <tr>
                                <td><strong>0</strong></td>
                                <td>No mapping confidence</td>
                                <td>-</td>
                                <td>‚úó</td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="example-description">
                    <strong>Description:</strong> Phred-scaled mapping quality score (-10 √ó log‚ÇÅ‚ÇÄ(P))<br>
                    ‚Ä¢ Represents the probability that the read is mapped to an incorrect position<br>
                    ‚Ä¢ MAPQ ‚â• 30: Generally considered reliable mapping<br>
                    ‚Ä¢ MAPQ 0: Multi-mapping (maps equally well to multiple locations)<br>
                    ‚Ä¢ Frequently used as filtering criteria in variant calling
                </div>
            </div>

            <!-- CIGAR ÏòàÏãú -->
            <div class="example-box">
                <div class="example-title">5. CIGAR - Alignment String</div>
                <div class="visual-diagram">
                    <div style="font-weight: 600; margin-bottom: 15px;">CIGAR: 50M2I48M1D25M</div>
                    <div class="cigar-example">
                        <div class="cigar-block cigar-match">50M</div>
                        <div class="cigar-block cigar-insert">2I</div>
                        <div class="cigar-block cigar-match">48M</div>
                        <div class="cigar-block cigar-delete">1D</div>
                        <div class="cigar-block cigar-match">25M</div>
                    </div>
                    <div style="margin-top: 20px; font-size: 14px; line-height: 1.8;">
                        <strong>Visual Representation:</strong><br>
                        <div style="font-family: monospace; background: white; padding: 15px; border-radius: 5px; margin-top: 10px;">
                            Ref:  ACGTACGT<span style="color: #c62828;">-</span>ACGTACGT<span style="background: #ffcdd2;">A</span>CGTACGT<br>
                            Read: ACGTACGT<span style="background: #fff9c4;">TT</span>ACGTACGT<span style="color: #c62828;">-</span>CGTACGT<br>
                            CIGAR: <span style="color: #2e7d32;">8M</span><span style="color: #f57f17;">2I</span><span style="color: #2e7d32;">8M</span><span style="color: #c62828;">1D</span><span style="color: #2e7d32;">7M</span>
                        </div>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <tr>
                            <th>Operator</th>
                            <th>Meaning</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td><strong>M</strong></td>
                            <td>Match/Mismatch</td>
                            <td>Aligned to reference (includes matches/mismatches)</td>
                        </tr>
                        <tr>
                            <td><strong>I</strong></td>
                            <td>Insertion</td>
                            <td>Base inserted in read (not in reference)</td>
                        </tr>
                        <tr>
                            <td><strong>D</strong></td>
                            <td>Deletion</td>
                            <td>Base deleted in read (present in reference)</td>
                        </tr>
                        <tr>
                            <td><strong>S</strong></td>
                            <td>Soft Clipping</td>
                            <td>Unaligned read ends (sequence retained)</td>
                        </tr>
                        <tr>
                            <td><strong>H</strong></td>
                            <td>Hard Clipping</td>
                            <td>Unaligned read ends (sequence removed)</td>
                        </tr>
                        <tr>
                            <td><strong>N</strong></td>
                            <td>Skipped Region</td>
                            <td>Skipped reference region (RNA-seq introns)</td>
                        </tr>
                    </table>
                </div>
                <div class="example-description">
                    <strong>Description:</strong> Compact representation of alignment between read and reference sequence<br>
                    ‚Ä¢ Each operation: number (length) + character (operation type)<br>
                    ‚Ä¢ Critical information for structural variant and splice junction detection<br>
                    ‚Ä¢ In RNA-seq, 'N' operation represents splicing junctions
                </div>
            </div>

            <!-- Ï†ÑÏ≤¥ SAM ÎùºÏù∏ ÏòàÏãú -->
            <div class="example-box">
                <div class="example-title">6. Complete SAM Line Example</div>
                <div class="example-content" style="overflow-x: auto;">
READ1   99   chr1   10001   60   76M   =   10052   127   ACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGTACGT   IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII   NM:i:0   MD:Z:76   AS:i:76
                </div>
                <div class="table-container">
                    <table>
                        <tr>
                            <th>Field</th>
                            <th>Value</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>QNAME</td>
                            <td>READ1</td>
                            <td>Read identifier</td>
                        </tr>
                        <tr>
                            <td>FLAG</td>
                            <td>99</td>
                            <td>Paired, properly mapped, first read, mate reverse strand</td>
                        </tr>
                        <tr>
                            <td>RNAME</td>
                            <td>chr1</td>
                            <td>Chromosome 1</td>
                        </tr>
                        <tr>
                            <td>POS</td>
                            <td>10001</td>
                            <td>Start position</td>
                        </tr>
                        <tr>
                            <td>MAPQ</td>
                            <td>60</td>
                            <td>Very high mapping quality</td>
                        </tr>
                        <tr>
                            <td>CIGAR</td>
                            <td>76M</td>
                            <td>76 bases perfectly aligned</td>
                        </tr>
                        <tr>
                            <td>RNEXT</td>
                            <td>=</td>
                            <td>Mate also mapped to same chromosome</td>
                        </tr>
                        <tr>
                            <td>PNEXT</td>
                            <td>10052</td>
                            <td>Mate start position</td>
                        </tr>
                        <tr>
                            <td>TLEN</td>
                            <td>127</td>
                            <td>Template length (insert size)</td>
                        </tr>
                        <tr>
                            <td>SEQ</td>
                            <td>ACGT...</td>
                            <td>Read sequence</td>
                        </tr>
                        <tr>
                            <td>QUAL</td>
                            <td>IIII...</td>
                            <td>Per-base quality scores (Phred+33)</td>
                        </tr>
                    </table>
                </div>
            </div>

            <!-- BAM Ïù∏Îç±Ïã± -->
            <div class="example-box">
                <div class="example-title">7. BAM File Operations Example</div>
                <div class="example-content">
# Convert SAM to BAM<br>
samtools view -bS input.sam > output.bam<br>
<br>
# Sort BAM<br>
samtools sort output.bam -o sorted.bam<br>
<br>
# Index BAM (creates .bai file)<br>
samtools index sorted.bam<br>
<br>
# Extract specific region<br>
samtools view sorted.bam chr1:10000-20000<br>
<br>
# View statistics<br>
samtools flagstat sorted.bam
                </div>
                <div class="example-description">
                    <strong>Description:</strong> BAM files are essential for efficient data processing.<br>
                    ‚Ä¢ Only sorted BAM files can be indexed<br>
                    ‚Ä¢ .bai index file enables rapid retrieval of specific regions<br>
                    ‚Ä¢ Visualization tools like IGV require BAM + index<br>
                    ‚Ä¢ Typical compression ratio is 1/3 to 1/5 compared to SAM
                </div>
            </div>

        </div>

        <div class="highlight-box" style="margin-top: 30px;">
            <div class="highlight-text">
                üí° SAM/BAM formats are the standard formats for NGS data analysis,<br>
                serving as the foundation for all sequencing analyses including variant analysis, RNA-seq, and ChIP-seq.
            </div>
        </div>
    </div>
</body>
</html>