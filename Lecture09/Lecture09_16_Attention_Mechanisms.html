<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attention Mechanisms - Detailed Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            width: 960px;
            padding: 35px 45px;
            background: white;
        }
        
        .title {
            font-size: 28px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .attention-section {
            background: #f8fbff;
            border: 2.5px solid #1E64C8;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .attention-title {
            font-size: 18px;
            font-weight: 700;
            color: #1E64C8;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
            margin-bottom: 40px;
        }
        
        .concept-card {
            background: white;
            border: 2.5px solid #1E64C8;
            border-radius: 10px;
            padding: 16px;
            transition: all 0.3s;
            min-height: 110px;
        }
        
        .concept-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(30, 100, 200, 0.2);
            background: #f8fbff;
        }
        
        .concept-name {
            font-size: 17px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 8px;
        }
        
        .concept-desc {
            font-size: 14px;
            color: #333;
            line-height: 1.5;
        }

        .detailed-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 3px solid #1E64C8;
        }

        .section-title {
            font-size: 24px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 20px;
            text-align: center;
        }

        .detail-card {
            background: #f8fbff;
            border: 2.5px solid #1E64C8;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 35px;
        }

        .detail-title {
            font-size: 20px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .detail-title::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #1E64C8;
            border-radius: 50%;
            margin-right: 12px;
        }

        .detail-content {
            font-size: 15px;
            color: #333;
            line-height: 1.7;
            margin-bottom: 20px;
        }

        .detail-content p {
            margin-bottom: 12px;
        }

        .detail-content strong {
            color: #1E64C8;
            font-weight: 600;
        }

        .visualization-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
        }

        .key-points {
            background: #fff9e6;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
        }

        .key-points-title {
            font-size: 14px;
            font-weight: 700;
            color: #e67e00;
            margin-bottom: 10px;
        }

        .key-points ul {
            margin-left: 20px;
            font-size: 14px;
            color: #555;
            line-height: 1.6;
        }

        .key-points li {
            margin-bottom: 6px;
        }

        .formula {
            background: #f0f7ff;
            border: 1px solid #1E64C8;
            border-radius: 6px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            text-align: center;
            margin: 15px 0;
            color: #1E64C8;
        }

        .applications {
            background: #e8ffe8;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
        }

        .applications-title {
            font-size: 14px;
            font-weight: 700;
            color: #28a745;
            margin-bottom: 10px;
        }

        .applications ul {
            margin-left: 20px;
            font-size: 14px;
            color: #555;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Attention Mechanisms</div>
        
        <div class="attention-section">
            <div class="attention-title">Self-Attention Mechanism</div>
            <svg width="880" height="240" viewBox="0 0 880 240">
                <!-- Input sequence -->
                <g transform="translate(30, 20)">
                    <text x="100" y="0" font-size="12" fill="#1E64C8" font-weight="700" text-anchor="middle">Input Sequence</text>
                    
                    <!-- Image patches -->
                    <rect x="10" y="15" width="40" height="40" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="30" y="40" font-size="9" fill="#666" text-anchor="middle">Patch 1</text>
                    
                    <rect x="60" y="15" width="40" height="40" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="80" y="40" font-size="9" fill="#666" text-anchor="middle">Patch 2</text>
                    
                    <rect x="110" y="15" width="40" height="40" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="130" y="40" font-size="9" fill="#666" text-anchor="middle">Patch 3</text>
                    
                    <rect x="160" y="15" width="40" height="40" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="180" y="40" font-size="9" fill="#666" text-anchor="middle">Patch N</text>
                    
                    <text x="145" y="40" font-size="12" fill="#999">...</text>
                </g>
                
                <!-- Q, K, V transformation -->
                <g transform="translate(30, 85)">
                    <text x="100" y="0" font-size="11" fill="#1E64C8" font-weight="700" text-anchor="middle">Linear Projections</text>
                    
                    <!-- Q -->
                    <rect x="10" y="10" width="50" height="30" rx="5" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="35" y="29" font-size="11" fill="#1E64C8" font-weight="700" text-anchor="middle">Query (Q)</text>
                    
                    <!-- K -->
                    <rect x="75" y="10" width="50" height="30" rx="5" fill="#d4e7ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="100" y="29" font-size="11" fill="#1E64C8" font-weight="700" text-anchor="middle">Key (K)</text>
                    
                    <!-- V -->
                    <rect x="140" y="10" width="50" height="30" rx="5" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="165" y="29" font-size="11" fill="#1E64C8" font-weight="700" text-anchor="middle">Value (V)</text>
                    
                    <!-- Arrows from input -->
                    <path d="M 30 -30 L 30 10" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrowhead)"/>
                    <path d="M 80 -30 L 95 10" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrowhead)"/>
                    <path d="M 130 -30 L 160 10" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrowhead)"/>
                </g>
                
                <!-- Attention computation -->
                <g transform="translate(280, 20)">
                    <text x="150" y="0" font-size="12" fill="#1E64C8" font-weight="700" text-anchor="middle">Attention Computation</text>
                    
                    <!-- Step 1: Similarity -->
                    <rect x="20" y="15" width="120" height="50" rx="8" fill="#fff9e6" stroke="#1E64C8" stroke-width="2"/>
                    <text x="80" y="33" font-size="11" fill="#1E64C8" font-weight="600" text-anchor="middle">1. Compute Similarity</text>
                    <text x="80" y="48" font-size="9" fill="#666" text-anchor="middle">Score = Q · K^T / √d_k</text>
                    
                    <!-- Arrow -->
                    <path d="M 80 65 L 80 85" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrowhead)"/>
                    
                    <!-- Step 2: Softmax -->
                    <rect x="20" y="85" width="120" height="45" rx="8" fill="#ffe6f0" stroke="#1E64C8" stroke-width="2"/>
                    <text x="80" y="103" font-size="11" fill="#1E64C8" font-weight="600" text-anchor="middle">2. Softmax</text>
                    <text x="80" y="118" font-size="9" fill="#666" text-anchor="middle">Attention Weights</text>
                    
                    <!-- Arrow -->
                    <path d="M 80 130 L 80 150" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrowhead)"/>
                    
                    <!-- Step 3: Weighted Sum -->
                    <rect x="20" y="150" width="120" height="45" rx="8" fill="#e6f5ff" stroke="#1E64C8" stroke-width="2"/>
                    <text x="80" y="168" font-size="11" fill="#1E64C8" font-weight="600" text-anchor="middle">3. Weighted Sum</text>
                    <text x="80" y="183" font-size="9" fill="#666" text-anchor="middle">Output = Weights · V</text>
                    
                    <!-- Attention heatmap visualization -->
                    <g transform="translate(160, 50)">
                        <text x="60" y="-5" font-size="10" fill="#666" text-anchor="middle">Attention Map</text>
                        
                        <!-- Heatmap grid -->
                        <rect x="10" y="0" width="25" height="25" fill="#1E64C8" opacity="0.8"/>
                        <rect x="35" y="0" width="25" height="25" fill="#1E64C8" opacity="0.3"/>
                        <rect x="60" y="0" width="25" height="25" fill="#1E64C8" opacity="0.2"/>
                        <rect x="85" y="0" width="25" height="25" fill="#1E64C8" opacity="0.1"/>
                        
                        <rect x="10" y="25" width="25" height="25" fill="#1E64C8" opacity="0.2"/>
                        <rect x="35" y="25" width="25" height="25" fill="#1E64C8" opacity="0.7"/>
                        <rect x="60" y="25" width="25" height="25" fill="#1E64C8" opacity="0.4"/>
                        <rect x="85" y="25" width="25" height="25" fill="#1E64C8" opacity="0.1"/>
                        
                        <rect x="10" y="50" width="25" height="25" fill="#1E64C8" opacity="0.1"/>
                        <rect x="35" y="50" width="25" height="25" fill="#1E64C8" opacity="0.3"/>
                        <rect x="60" y="50" width="25" height="25" fill="#1E64C8" opacity="0.9"/>
                        <rect x="85" y="50" width="25" height="25" fill="#1E64C8" opacity="0.2"/>
                        
                        <rect x="10" y="75" width="25" height="25" fill="#1E64C8" opacity="0.1"/>
                        <rect x="35" y="75" width="25" height="25" fill="#1E64C8" opacity="0.2"/>
                        <rect x="60" y="75" width="25" height="25" fill="#1E64C8" opacity="0.3"/>
                        <rect x="85" y="75" width="25" height="25" fill="#1E64C8" opacity="0.8"/>
                        
                        <!-- Labels -->
                        <text x="22.5" y="115" font-size="7" fill="#666" text-anchor="middle">P1</text>
                        <text x="47.5" y="115" font-size="7" fill="#666" text-anchor="middle">P2</text>
                        <text x="72.5" y="115" font-size="7" fill="#666" text-anchor="middle">P3</text>
                        <text x="97.5" y="115" font-size="7" fill="#666" text-anchor="middle">PN</text>
                    </g>
                </g>
                
                <!-- Output -->
                <g transform="translate(650, 80)">
                    <text x="100" y="0" font-size="12" fill="#1E64C8" font-weight="700" text-anchor="middle">Context-Aware Output</text>
                    
                    <rect x="10" y="15" width="180" height="80" rx="8" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2.5"/>
                    <text x="100" y="40" font-size="11" fill="#333" text-anchor="middle">Each position attends to</text>
                    <text x="100" y="55" font-size="11" fill="#333" text-anchor="middle">all other positions</text>
                    <text x="100" y="75" font-size="10" fill="#1E64C8" font-weight="600" text-anchor="middle">Global receptive field</text>
                    
                    <!-- Arrow from attention -->
                    <path d="M 640 107 L 650 55" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrowhead)"/>
                </g>
                
                <!-- Benefits -->
                <g transform="translate(650, 180)">
                    <rect x="0" y="0" width="200" height="50" rx="8" fill="#e8ffe8" stroke="#1E64C8" stroke-width="2"/>
                    <text x="100" y="18" font-size="10" fill="#28a745" font-weight="700" text-anchor="middle">✓ Long-range dependencies</text>
                    <text x="100" y="32" font-size="10" fill="#28a745" font-weight="700" text-anchor="middle">✓ Parallel computation</text>
                    <text x="100" y="46" font-size="10" fill="#28a745" font-weight="700" text-anchor="middle">✓ Interpretable weights</text>
                </g>
                
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8" />
                    </marker>
                </defs>
            </svg>
        </div>
        
        <div class="concept-grid">
            <div class="concept-card">
                <div class="concept-name">Self-Attention</div>
                <div class="concept-desc">Capture long-range dependencies. Every position attends to all others</div>
            </div>
        
            <div class="concept-card">
                <div class="concept-name">Cross-Attention</div>
                <div class="concept-desc">Attend between different modalities or sequences. Query from one, key/value from another</div>
            </div>
        
            <div class="concept-card">
                <div class="concept-name">Vision Transformers</div>
                <div class="concept-desc">Pure attention-based architecture. ViT, Swin Transformer for medical imaging</div>
            </div>
        
            <div class="concept-card">
                <div class="concept-name">Hybrid Architectures</div>
                <div class="concept-desc">CNN backbone + Transformer head. CoAtNet, TransUNet combine local and global context</div>
            </div>
        
            <div class="concept-card">
                <div class="concept-name">Interpretability Benefits</div>
                <div class="concept-desc">Attention maps show model focus. More intuitive than CNN activation maps</div>
            </div>
        </div>

        <!-- Detailed Sections -->
        <div class="detailed-section">
            <div class="section-title">Detailed Explanation of Attention Mechanisms</div>

            <!-- 1. Self-Attention -->
            <div class="detail-card">
                <div class="detail-title">1. Self-Attention</div>
                <div class="detail-content">
                    <p><strong>Self-attention</strong> is a mechanism that allows each element in a sequence to attend to all other elements in the same sequence. This enables the model to capture long-range dependencies and contextual relationships regardless of their distance in the sequence.</p>
                    
                    <p><strong>How it works:</strong> For each position in the input sequence, self-attention computes three vectors: Query (Q), Key (K), and Value (V). The attention score between two positions is calculated by the dot product of their Query and Key vectors, normalized by softmax. These scores determine how much each position should attend to every other position.</p>

                    <div class="formula">
                        Attention(Q, K, V) = softmax(QK^T / √d_k) × V
                    </div>

                    <p>where d_k is the dimension of the key vectors, used for scaling to prevent extremely small gradients.</p>
                </div>

                <div class="visualization-container">
                    <svg width="870" height="280" viewBox="0 0 870 280">
                        <!-- Title -->
                        <text x="435" y="20" font-size="14" fill="#1E64C8" font-weight="700" text-anchor="middle">Self-Attention Example: Medical Image Analysis</text>
                        
                        <!-- Input Image Representation -->
                        <g transform="translate(50, 50)">
                            <text x="100" y="-10" font-size="12" fill="#333" font-weight="600" text-anchor="middle">Input: CT Scan Patches</text>
                            
                            <!-- CT scan patches -->
                            <rect x="10" y="0" width="45" height="45" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                            <text x="32.5" y="25" font-size="10" fill="#666" text-anchor="middle">Lung</text>
                            <text x="32.5" y="55" font-size="8" fill="#999" text-anchor="middle">Patch 1</text>
                            
                            <rect x="70" y="0" width="45" height="45" fill="#ffe8e8" stroke="#dc3545" stroke-width="2"/>
                            <text x="92.5" y="25" font-size="10" fill="#666" text-anchor="middle">Tumor</text>
                            <text x="92.5" y="55" font-size="8" fill="#999" text-anchor="middle">Patch 2</text>
                            
                            <rect x="130" y="0" width="45" height="45" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                            <text x="152.5" y="25" font-size="10" fill="#666" text-anchor="middle">Vessel</text>
                            <text x="152.5" y="55" font-size="8" fill="#999" text-anchor="middle">Patch 3</text>
                            
                            <rect x="190" y="0" width="45" height="45" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                            <text x="212.5" y="25" font-size="10" fill="#666" text-anchor="middle">Bone</text>
                            <text x="212.5" y="55" font-size="8" fill="#999" text-anchor="middle">Patch 4</text>
                        </g>

                        <!-- Attention Matrix -->
                        <g transform="translate(330, 50)">
                            <text x="100" y="-10" font-size="12" fill="#333" font-weight="600" text-anchor="middle">Attention Weights Matrix</text>
                            
                            <!-- Matrix showing attention patterns -->
                            <g>
                                <!-- Row 1: Lung patch attention -->
                                <rect x="40" y="0" width="35" height="35" fill="#1E64C8" opacity="0.3"/>
                                <rect x="75" y="0" width="35" height="35" fill="#1E64C8" opacity="0.2"/>
                                <rect x="110" y="0" width="35" height="35" fill="#1E64C8" opacity="0.4"/>
                                <rect x="145" y="0" width="35" height="35" fill="#1E64C8" opacity="0.1"/>
                                
                                <!-- Row 2: Tumor patch attention (high attention to surrounding areas) -->
                                <rect x="40" y="35" width="35" height="35" fill="#dc3545" opacity="0.6"/>
                                <rect x="75" y="35" width="35" height="35" fill="#dc3545" opacity="0.9"/>
                                <rect x="110" y="35" width="35" height="35" fill="#dc3545" opacity="0.7"/>
                                <rect x="145" y="35" width="35" height="35" fill="#dc3545" opacity="0.4"/>
                                
                                <!-- Row 3: Vessel patch attention -->
                                <rect x="40" y="70" width="35" height="35" fill="#1E64C8" opacity="0.5"/>
                                <rect x="75" y="70" width="35" height="35" fill="#1E64C8" opacity="0.6"/>
                                <rect x="110" y="70" width="35" height="35" fill="#1E64C8" opacity="0.4"/>
                                <rect x="145" y="70" width="35" height="35" fill="#1E64C8" opacity="0.2"/>
                                
                                <!-- Row 4: Bone patch attention -->
                                <rect x="40" y="105" width="35" height="35" fill="#1E64C8" opacity="0.1"/>
                                <rect x="75" y="105" width="35" height="35" fill="#1E64C8" opacity="0.3"/>
                                <rect x="110" y="105" width="35" height="35" fill="#1E64C8" opacity="0.2"/>
                                <rect x="145" y="105" width="35" height="35" fill="#1E64C8" opacity="0.4"/>
                                
                                <!-- Labels -->
                                <text x="0" y="20" font-size="9" fill="#666">Lung</text>
                                <text x="0" y="55" font-size="9" fill="#dc3545" font-weight="600">Tumor</text>
                                <text x="0" y="90" font-size="9" fill="#666">Vessel</text>
                                <text x="0" y="125" font-size="9" fill="#666">Bone</text>
                                
                                <text x="57.5" y="155" font-size="9" fill="#666" text-anchor="middle">Lung</text>
                                <text x="92.5" y="155" font-size="9" fill="#dc3545" font-weight="600" text-anchor="middle">Tumor</text>
                                <text x="127.5" y="155" font-size="9" fill="#666" text-anchor="middle">Vessel</text>
                                <text x="162.5" y="155" font-size="9" fill="#666" text-anchor="middle">Bone</text>
                            </g>
                            
                            <!-- Annotation -->
                            <text x="100" y="175" font-size="9" fill="#dc3545" font-weight="600" text-anchor="middle">Tumor patch attends strongly to all regions</text>
                        </g>

                        <!-- Output Interpretation -->
                        <g transform="translate(600, 50)">
                            <text x="120" y="-10" font-size="12" fill="#333" font-weight="600" text-anchor="middle">Context-Aware Features</text>
                            
                            <rect x="10" y="0" width="220" height="140" rx="8" fill="#e8ffe8" stroke="#28a745" stroke-width="2"/>
                            
                            <text x="120" y="25" font-size="11" fill="#333" text-anchor="middle" font-weight="600">Key Insights:</text>
                            
                            <text x="20" y="50" font-size="10" fill="#555">• Tumor patch has high attention</text>
                            <text x="20" y="68" font-size="10" fill="#555">  to surrounding tissues</text>
                            
                            <text x="20" y="88" font-size="10" fill="#555">• Each patch understands its</text>
                            <text x="20" y="103" font-size="10" fill="#555">  relationship to other regions</text>
                            
                            <text x="20" y="123" font-size="10" fill="#555">• Global context improves</text>
                            <text x="20" y="138" font-size="10" fill="#555">  diagnostic accuracy</text>
                        </g>

                        <!-- Arrow showing flow -->
                        <path d="M 295 90 L 320 90" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow1)"/>
                        <path d="M 555 90 L 590 90" stroke="#28a745" stroke-width="2" marker-end="url(#arrow2)"/>

                        <defs>
                            <marker id="arrow1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#1E64C8" />
                            </marker>
                            <marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#28a745" />
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="key-points">
                    <div class="key-points-title">Key Advantages:</div>
                    <ul>
                        <li><strong>Global receptive field:</strong> Every position can directly attend to every other position, regardless of distance</li>
                        <li><strong>Parallel processing:</strong> All attention scores can be computed simultaneously, enabling efficient GPU utilization</li>
                        <li><strong>Dynamic weighting:</strong> Attention weights adapt based on input content, not fixed like CNN filters</li>
                        <li><strong>Positional relationships:</strong> Captures complex spatial and semantic relationships in medical images</li>
                    </ul>
                </div>

                <div class="applications">
                    <div class="applications-title">Medical Imaging Applications:</div>
                    <ul>
                        <li>Tumor detection and segmentation in CT and MRI scans</li>
                        <li>Multi-organ segmentation requiring context from entire image</li>
                        <li>Pathology image analysis where distant tissue regions interact</li>
                        <li>Disease classification that depends on global image features</li>
                    </ul>
                </div>
            </div>

            <!-- 2. Cross-Attention -->
            <div class="detail-card">
                <div class="detail-title">2. Cross-Attention</div>
                <div class="detail-content">
                    <p><strong>Cross-attention</strong> enables interaction between two different sequences or modalities. Unlike self-attention where queries, keys, and values come from the same sequence, cross-attention uses queries from one sequence and keys/values from another.</p>
                    
                    <p><strong>Mechanism:</strong> The query comes from the target sequence (e.g., decoder in a transformer), while keys and values come from the source sequence (e.g., encoder output). This allows the model to focus on relevant parts of the source when generating each element of the target.</p>

                    <div class="formula">
                        CrossAttention(Q_target, K_source, V_source) = softmax(Q_target × K_source^T / √d_k) × V_source
                    </div>
                </div>

                <div class="visualization-container">
                    <svg width="870" height="320" viewBox="0 0 870 320">
                        <!-- Title -->
                        <text x="435" y="20" font-size="14" fill="#1E64C8" font-weight="700" text-anchor="middle">Cross-Attention: Multi-Modal Medical Data Fusion</text>
                        
                        <!-- Modality 1: CT Scan -->
                        <g transform="translate(50, 50)">
                            <text x="100" y="-10" font-size="12" fill="#1E64C8" font-weight="600" text-anchor="middle">Modality 1: CT Scan</text>
                            
                            <rect x="0" y="0" width="200" height="120" rx="6" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                            
                            <!-- CT scan representation -->
                            <circle cx="40" cy="30" r="8" fill="#666"/>
                            <circle cx="70" cy="30" r="8" fill="#666"/>
                            <circle cx="100" cy="30" r="8" fill="#dc3545"/>
                            <circle cx="130" cy="30" r="8" fill="#666"/>
                            <circle cx="160" cy="30" r="8" fill="#666"/>
                            
                            <text x="100" y="60" font-size="10" fill="#333" text-anchor="middle">Spatial Features</text>
                            <text x="100" y="75" font-size="9" fill="#666" text-anchor="middle">• Anatomical structure</text>
                            <text x="100" y="90" font-size="9" fill="#666" text-anchor="middle">• Density information</text>
                            <text x="100" y="105" font-size="9" fill="#666" text-anchor="middle">• Tumor location</text>
                            
                            <text x="100" y="145" font-size="10" fill="#1E64C8" font-weight="600" text-anchor="middle">Keys & Values (K, V)</text>
                        </g>

                        <!-- Modality 2: Clinical Data -->
                        <g transform="translate(50, 210)">
                            <text x="100" y="-10" font-size="12" fill="#28a745" font-weight="600" text-anchor="middle">Modality 2: Clinical Data</text>
                            
                            <rect x="0" y="0" width="200" height="80" rx="6" fill="#e8ffe8" stroke="#28a745" stroke-width="2"/>
                            
                            <text x="100" y="25" font-size="10" fill="#333" text-anchor="middle">Patient Information</text>
                            <text x="100" y="42" font-size="9" fill="#666" text-anchor="middle">• Age: 65, Gender: M</text>
                            <text x="100" y="57" font-size="9" fill="#666" text-anchor="middle">• Symptoms: Cough, Weight loss</text>
                            <text x="100" y="72" font-size="9" fill="#666" text-anchor="middle">• History: Smoking 40 years</text>
                            
                            <text x="100" y="105" font-size="10" fill="#28a745" font-weight="600" text-anchor="middle">Query (Q)</text>
                        </g>

                        <!-- Cross-Attention Mechanism -->
                        <g transform="translate(320, 100)">
                            <text x="120" y="-10" font-size="12" fill="#333" font-weight="600" text-anchor="middle">Cross-Attention Process</text>
                            
                            <!-- Attention flow visualization -->
                            <rect x="20" y="0" width="200" height="150" rx="8" fill="#fff9e6" stroke="#ffc107" stroke-width="2"/>
                            
                            <text x="120" y="25" font-size="11" fill="#e67e00" font-weight="600" text-anchor="middle">Query from Clinical Data</text>
                            <text x="120" y="42" font-size="10" fill="#666" text-anchor="middle">↓</text>
                            <text x="120" y="57" font-size="11" fill="#e67e00" font-weight="600" text-anchor="middle">attends to</text>
                            <text x="120" y="74" font-size="10" fill="#666" text-anchor="middle">↓</text>
                            <text x="120" y="89" font-size="11" fill="#e67e00" font-weight="600" text-anchor="middle">Keys/Values from CT Scan</text>
                            
                            <text x="120" y="115" font-size="9" fill="#555" text-anchor="middle">Patient symptoms guide</text>
                            <text x="120" y="130" font-size="9" fill="#555" text-anchor="middle">which CT regions to focus on</text>
                            <text x="120" y="145" font-size="9" fill="#555" text-anchor="middle">for diagnosis</text>
                        </g>

                        <!-- Attention weights visualization -->
                        <g transform="translate(330, 175)">
                            <text x="90" y="0" font-size="10" fill="#666" font-weight="600" text-anchor="middle">Attention Weights</text>
                            
                            <!-- Bars showing attention distribution -->
                            <rect x="10" y="10" width="30" height="15" fill="#1E64C8" opacity="0.3"/>
                            <text x="45" y="22" font-size="8" fill="#666">Region 1: 0.15</text>
                            
                            <rect x="10" y="30" width="50" height="15" fill="#1E64C8" opacity="0.5"/>
                            <text x="65" y="42" font-size="8" fill="#666">Region 2: 0.25</text>
                            
                            <rect x="10" y="50" width="80" height="15" fill="#dc3545" opacity="0.9"/>
                            <text x="95" y="62" font-size="8" fill="#dc3545" font-weight="600">Region 3: 0.45 (Tumor)</text>
                            
                            <rect x="10" y="70" width="25" height="15" fill="#1E64C8" opacity="0.2"/>
                            <text x="40" y="82" font-size="8" fill="#666">Region 4: 0.10</text>
                            
                            <rect x="10" y="90" width="15" height="15" fill="#1E64C8" opacity="0.1"/>
                            <text x="30" y="102" font-size="8" fill="#666">Region 5: 0.05</text>
                        </g>

                        <!-- Output -->
                        <g transform="translate(600, 100)">
                            <text x="120" y="-10" font-size="12" fill="#333" font-weight="600" text-anchor="middle">Fused Representation</text>
                            
                            <rect x="10" y="0" width="220" height="150" rx="8" fill="#f0f7ff" stroke="#1E64C8" stroke-width="2.5"/>
                            
                            <text x="120" y="25" font-size="11" fill="#1E64C8" font-weight="600" text-anchor="middle">Integrated Diagnosis</text>
                            
                            <text x="120" y="50" font-size="10" fill="#555" text-anchor="middle">Clinical symptoms (cough,</text>
                            <text x="120" y="65" font-size="10" fill="#555" text-anchor="middle">weight loss) + smoking history</text>
                            
                            <text x="120" y="85" font-size="10" fill="#555" text-anchor="middle">↓ guide attention to ↓</text>
                            
                            <text x="120" y="105" font-size="10" fill="#555" text-anchor="middle">Suspicious lung region in CT</text>
                            
                            <text x="120" y="130" font-size="9" fill="#dc3545" font-weight="600" text-anchor="middle">Result: High probability of</text>
                            <text x="120" y="145" font-size="9" fill="#dc3545" font-weight="600" text-anchor="middle">lung cancer detected</text>
                        </g>

                        <!-- Arrows -->
                        <path d="M 255 110 L 310 120" stroke="#ffc107" stroke-width="2" marker-end="url(#arrow3)"/>
                        <path d="M 255 255 L 310 200" stroke="#ffc107" stroke-width="2" marker-end="url(#arrow3)"/>
                        <path d="M 530 175 L 590 175" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow4)"/>

                        <defs>
                            <marker id="arrow3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#ffc107" />
                            </marker>
                            <marker id="arrow4" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#1E64C8" />
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="key-points">
                    <div class="key-points-title">Key Characteristics:</div>
                    <ul>
                        <li><strong>Multi-modal fusion:</strong> Combines information from different data sources (imaging + clinical data)</li>
                        <li><strong>Selective attention:</strong> Query from one modality selectively attends to relevant information in another</li>
                        <li><strong>Asymmetric information flow:</strong> Direction of attention is from target to source, not bidirectional</li>
                        <li><strong>Enhanced context:</strong> Clinical context guides where to look in imaging data</li>
                    </ul>
                </div>

                <div class="applications">
                    <div class="applications-title">Medical Applications:</div>
                    <ul>
                        <li>Combining CT/MRI scans with patient clinical records for diagnosis</li>
                        <li>Image-to-text generation for automated radiology report writing</li>
                        <li>Multi-modal disease prediction using imaging, genomics, and clinical data</li>
                        <li>Treatment planning by integrating imaging with treatment response history</li>
                    </ul>
                </div>
            </div>

            <!-- 3. Vision Transformers -->
            <div class="detail-card">
                <div class="detail-title">3. Vision Transformers (ViT)</div>
                <div class="detail-content">
                    <p><strong>Vision Transformers</strong> apply the transformer architecture, originally designed for natural language processing, directly to images. Instead of using convolutional layers, ViT divides an image into fixed-size patches, linearly embeds them, and processes them through transformer encoder layers.</p>
                    
                    <p><strong>Architecture:</strong> An input image is split into non-overlapping patches (typically 16×16 pixels). Each patch is flattened and linearly projected to create patch embeddings. A learnable classification token ([CLS]) is prepended, and positional embeddings are added. The sequence is then processed by multiple transformer encoder blocks consisting of multi-head self-attention and feed-forward layers.</p>
                </div>

                <div class="visualization-container">
                    <svg width="870" height="350" viewBox="0 0 870 350">
                        <!-- Title -->
                        <text x="435" y="20" font-size="14" fill="#1E64C8" font-weight="700" text-anchor="middle">Vision Transformer Architecture for Medical Imaging</text>
                        
                        <!-- Input Image -->
                        <g transform="translate(40, 50)">
                            <text x="80" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">1. Input Medical Image</text>
                            
                            <rect x="0" y="0" width="160" height="160" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2"/>
                            
                            <!-- Simulated medical image grid -->
                            <g opacity="0.6">
                                <line x1="40" y1="0" x2="40" y2="160" stroke="#1E64C8" stroke-width="1" stroke-dasharray="3,3"/>
                                <line x1="80" y1="0" x2="80" y2="160" stroke="#1E64C8" stroke-width="1" stroke-dasharray="3,3"/>
                                <line x1="120" y1="0" x2="120" y2="160" stroke="#1E64C8" stroke-width="1" stroke-dasharray="3,3"/>
                                
                                <line x1="0" y1="40" x2="160" y2="40" stroke="#1E64C8" stroke-width="1" stroke-dasharray="3,3"/>
                                <line x1="0" y1="80" x2="160" y2="80" stroke="#1E64C8" stroke-width="1" stroke-dasharray="3,3"/>
                                <line x1="0" y1="120" x2="160" y2="120" stroke="#1E64C8" stroke-width="1" stroke-dasharray="3,3"/>
                            </g>
                            
                            <text x="80" y="85" font-size="12" fill="#666" text-anchor="middle" font-weight="600">Chest X-Ray</text>
                            <text x="80" y="100" font-size="9" fill="#666" text-anchor="middle">224 × 224 pixels</text>
                            
                            <text x="80" y="180" font-size="9" fill="#999" text-anchor="middle">Divided into 16×16 patches</text>
                            <text x="80" y="193" font-size="9" fill="#999" text-anchor="middle">(14×14 = 196 patches)</text>
                        </g>

                        <!-- Patch Embedding -->
                        <g transform="translate(240, 50)">
                            <text x="70" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">2. Patch Embedding</text>
                            
                            <!-- Individual patches -->
                            <g>
                                <rect x="0" y="0" width="35" height="35" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2" rx="3"/>
                                <text x="17.5" y="22" font-size="8" fill="#333" text-anchor="middle">P1</text>
                                
                                <rect x="0" y="40" width="35" height="35" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2" rx="3"/>
                                <text x="17.5" y="62" font-size="8" fill="#333" text-anchor="middle">P2</text>
                                
                                <rect x="0" y="80" width="35" height="35" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2" rx="3"/>
                                <text x="17.5" y="102" font-size="8" fill="#333" text-anchor="middle">P3</text>
                                
                                <text x="17.5" y="130" font-size="14" fill="#999" text-anchor="middle">⋮</text>
                                
                                <rect x="0" y="145" width="35" height="35" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2" rx="3"/>
                                <text x="17.5" y="167" font-size="8" fill="#333" text-anchor="middle">P196</text>
                            </g>
                            
                            <!-- CLS token -->
                            <rect x="50" y="60" width="40" height="40" fill="#ffc107" stroke="#e67e00" stroke-width="2.5" rx="5"/>
                            <text x="70" y="77" font-size="9" fill="#333" text-anchor="middle" font-weight="700">[CLS]</text>
                            <text x="70" y="89" font-size="7" fill="#555" text-anchor="middle">Class</text>
                            <text x="70" y="97" font-size="7" fill="#555" text-anchor="middle">Token</text>
                            
                            <text x="70" y="195" font-size="8" fill="#999" text-anchor="middle">+ Positional</text>
                            <text x="70" y="206" font-size="8" fill="#999" text-anchor="middle">Embeddings</text>
                        </g>

                        <!-- Transformer Encoder -->
                        <g transform="translate(380, 50)">
                            <text x="100" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">3. Transformer Encoder (×L layers)</text>
                            
                            <!-- Encoder block -->
                            <rect x="0" y="0" width="200" height="200" rx="10" fill="#f8fbff" stroke="#1E64C8" stroke-width="2"/>
                            
                            <!-- Multi-head attention -->
                            <rect x="20" y="15" width="160" height="45" rx="6" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2"/>
                            <text x="100" y="33" font-size="10" fill="#1E64C8" font-weight="600" text-anchor="middle">Multi-Head Self-Attention</text>
                            <text x="100" y="48" font-size="8" fill="#666" text-anchor="middle">Global context across patches</text>
                            
                            <!-- Arrow -->
                            <path d="M 100 60 L 100 75" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrow5)"/>
                            
                            <!-- Add & Norm -->
                            <rect x="40" y="75" width="120" height="25" rx="4" fill="#d4e7ff" stroke="#1E64C8" stroke-width="1.5"/>
                            <text x="100" y="91" font-size="9" fill="#333" text-anchor="middle">Add & LayerNorm</text>
                            
                            <!-- Arrow -->
                            <path d="M 100 100 L 100 115" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrow5)"/>
                            
                            <!-- Feed-forward -->
                            <rect x="20" y="115" width="160" height="40" rx="6" fill="#b3d7ff" stroke="#1E64C8" stroke-width="2"/>
                            <text x="100" y="132" font-size="10" fill="#1E64C8" font-weight="600" text-anchor="middle">Feed-Forward Network</text>
                            <text x="100" y="147" font-size="8" fill="#666" text-anchor="middle">MLP with GELU activation</text>
                            
                            <!-- Arrow -->
                            <path d="M 100 155 L 100 165" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrow5)"/>
                            
                            <!-- Add & Norm -->
                            <rect x="40" y="165" width="120" height="25" rx="4" fill="#d4e7ff" stroke="#1E64C8" stroke-width="1.5"/>
                            <text x="100" y="181" font-size="9" fill="#333" text-anchor="middle">Add & LayerNorm</text>
                        </g>

                        <!-- Classification Head -->
                        <g transform="translate(640, 80)">
                            <text x="100" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">4. Classification Head</text>
                            
                            <!-- CLS token output -->
                            <rect x="30" y="0" width="140" height="40" rx="6" fill="#ffc107" stroke="#e67e00" stroke-width="2"/>
                            <text x="100" y="18" font-size="10" fill="#333" text-anchor="middle" font-weight="600">[CLS] Token Output</text>
                            <text x="100" y="32" font-size="8" fill="#555" text-anchor="middle">Aggregated global features</text>
                            
                            <!-- Arrow -->
                            <path d="M 100 40 L 100 60" stroke="#28a745" stroke-width="2" marker-end="url(#arrow6)"/>
                            
                            <!-- MLP Head -->
                            <rect x="30" y="60" width="140" height="35" rx="6" fill="#e8ffe8" stroke="#28a745" stroke-width="2"/>
                            <text x="100" y="81" font-size="10" fill="#28a745" text-anchor="middle" font-weight="600">MLP Classification Head</text>
                            
                            <!-- Arrow -->
                            <path d="M 100 95 L 100 110" stroke="#28a745" stroke-width="2" marker-end="url(#arrow6)"/>
                            
                            <!-- Prediction -->
                            <rect x="10" y="110" width="180" height="70" rx="8" fill="#d4edda" stroke="#28a745" stroke-width="2.5"/>
                            <text x="100" y="130" font-size="11" fill="#28a745" text-anchor="middle" font-weight="700">Diagnosis Output</text>
                            <text x="100" y="148" font-size="9" fill="#555" text-anchor="middle">• Normal: 5%</text>
                            <text x="100" y="162" font-size="9" fill="#555" text-anchor="middle">• Pneumonia: 12%</text>
                            <text x="100" y="176" font-size="9" fill="#dc3545" text-anchor="middle" font-weight="600">• COVID-19: 83%</text>
                        </g>

                        <!-- Comparison box -->
                        <g transform="translate(40, 270)">
                            <rect x="0" y="0" width="800" height="65" rx="8" fill="#fff9e6" stroke="#ffc107" stroke-width="2"/>
                            
                            <text x="400" y="20" font-size="11" fill="#e67e00" font-weight="700" text-anchor="middle">ViT vs CNN Comparison</text>
                            
                            <g transform="translate(50, 30)">
                                <text x="0" y="15" font-size="9" fill="#333" font-weight="600">Vision Transformer:</text>
                                <text x="0" y="28" font-size="8" fill="#555">✓ Global receptive field from first layer</text>
                                <text x="0" y="40" font-size="8" fill="#555">✓ Better at capturing long-range dependencies</text>
                            </g>
                            
                            <g transform="translate(420, 30)">
                                <text x="0" y="15" font-size="9" fill="#333" font-weight="600">CNN:</text>
                                <text x="0" y="28" font-size="8" fill="#555">• Local receptive fields</text>
                                <text x="0" y="40" font-size="8" fill="#555">• Builds global context gradually</text>
                            </g>
                        </g>

                        <!-- Arrows connecting stages -->
                        <path d="M 205 125 L 230 125" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow5)"/>
                        <path d="M 345 150 L 370 150" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow5)"/>
                        <path d="M 585 150 L 630 135" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow5)"/>

                        <defs>
                            <marker id="arrow5" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#1E64C8" />
                            </marker>
                            <marker id="arrow6" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#28a745" />
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="key-points">
                    <div class="key-points-title">Key Architectural Features:</div>
                    <ul>
                        <li><strong>Patch-based processing:</strong> Images divided into fixed-size patches, treating them as tokens (like words in NLP)</li>
                        <li><strong>Global attention:</strong> Every patch can attend to every other patch from the first layer</li>
                        <li><strong>Scalability:</strong> Performance improves with larger datasets and model sizes</li>
                        <li><strong>Positional encoding:</strong> Learnable position embeddings encode spatial information</li>
                        <li><strong>No convolutions:</strong> Pure attention mechanism without inductive biases of CNNs</li>
                    </ul>
                </div>

                <div class="applications">
                    <div class="applications-title">Medical Imaging Applications:</div>
                    <ul>
                        <li><strong>Chest X-ray analysis:</strong> COVID-19, pneumonia, and tuberculosis detection</li>
                        <li><strong>Histopathology:</strong> Cancer detection in whole slide images where context matters</li>
                        <li><strong>3D medical imaging:</strong> Extensions like 3D-ViT for volumetric CT/MRI analysis</li>
                        <li><strong>Multi-task learning:</strong> Simultaneous disease classification and localization</li>
                        <li><strong>Swin Transformer:</strong> Hierarchical vision transformer with shifted windows for efficient processing</li>
                    </ul>
                </div>
            </div>

            <!-- 4. Hybrid Architectures -->
            <div class="detail-card">
                <div class="detail-title">4. Hybrid Architectures</div>
                <div class="detail-content">
                    <p><strong>Hybrid architectures</strong> combine the strengths of convolutional neural networks (CNNs) and transformers. CNNs excel at capturing local patterns and spatial hierarchies with strong inductive biases, while transformers provide global context through self-attention. Hybrid models leverage both approaches for improved performance.</p>
                    
                    <p><strong>Design philosophy:</strong> Typically, a CNN backbone extracts local features and reduces spatial dimensions, then transformer layers process these features to capture global dependencies. This design is more data-efficient than pure transformers and computationally more efficient than pure CNNs for global modeling.</p>
                </div>

                <div class="visualization-container">
                    <svg width="870" height="380" viewBox="0 0 870 380">
                        <!-- Title -->
                        <text x="435" y="20" font-size="14" fill="#1E64C8" font-weight="700" text-anchor="middle">Hybrid Architecture: TransUNet for Medical Image Segmentation</text>
                        
                        <!-- Input -->
                        <g transform="translate(40, 50)">
                            <text x="60" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Input Image</text>
                            <rect x="0" y="0" width="120" height="120" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2" rx="6"/>
                            <text x="60" y="55" font-size="10" fill="#666" text-anchor="middle">MRI Scan</text>
                            <text x="60" y="70" font-size="9" fill="#999" text-anchor="middle">512 × 512</text>
                        </g>

                        <!-- CNN Encoder -->
                        <g transform="translate(200, 50)">
                            <text x="80" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">CNN Encoder Backbone</text>
                            
                            <!-- Multi-level feature extraction -->
                            <rect x="0" y="0" width="160" height="120" rx="8" fill="#f8fbff" stroke="#1E64C8" stroke-width="2"/>
                            
                            <!-- Level 1 -->
                            <rect x="15" y="10" width="50" height="20" rx="3" fill="#b3d7ff" stroke="#1E64C8" stroke-width="1.5"/>
                            <text x="40" y="23" font-size="8" fill="#333" text-anchor="middle">Conv Block 1</text>
                            <text x="130" y="20" font-size="7" fill="#999">256×256×64</text>
                            
                            <path d="M 40 30 L 40 40" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrow7)"/>
                            
                            <!-- Level 2 -->
                            <rect x="15" y="40" width="50" height="20" rx="3" fill="#8ec3ff" stroke="#1E64C8" stroke-width="1.5"/>
                            <text x="40" y="53" font-size="8" fill="#333" text-anchor="middle">Conv Block 2</text>
                            <text x="130" y="50" font-size="7" fill="#999">128×128×128</text>
                            
                            <path d="M 40 60 L 40 70" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrow7)"/>
                            
                            <!-- Level 3 -->
                            <rect x="15" y="70" width="50" height="20" rx="3" fill="#5ba3ff" stroke="#1E64C8" stroke-width="1.5"/>
                            <text x="40" y="83" font-size="8" fill="#333" text-anchor="middle">Conv Block 3</text>
                            <text x="130" y="80" font-size="7" fill="#999">64×64×256</text>
                            
                            <path d="M 40 90 L 40 100" stroke="#1E64C8" stroke-width="1.5" marker-end="url(#arrow7)"/>
                            
                            <!-- Level 4 -->
                            <rect x="15" y="100" width="50" height="15" rx="3" fill="#2e82ff" stroke="#1E64C8" stroke-width="1.5"/>
                            <text x="40" y="110" font-size="7" fill="#fff" text-anchor="middle">Conv Block 4</text>
                            
                            <!-- Skip connections arrows -->
                            <path d="M 65 20 L 520 70" stroke="#28a745" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.6"/>
                            <path d="M 65 50 L 520 120" stroke="#28a745" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.6"/>
                            <path d="M 65 80 L 520 170" stroke="#28a745" stroke-width="1.5" stroke-dasharray="4,3" opacity="0.6"/>
                            
                            <text x="80" y="135" font-size="8" fill="#28a745" font-weight="600">Skip Connections →</text>
                        </g>

                        <!-- Bottleneck with Transformer -->
                        <g transform="translate(400, 50)">
                            <text x="60" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Transformer</text>
                            <text x="60" y="3" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Bottleneck</text>
                            
                            <rect x="0" y="15" width="120" height="105" rx="8" fill="#fff9e6" stroke="#ffc107" stroke-width="2.5"/>
                            
                            <!-- Patch embedding -->
                            <rect x="15" y="25" width="90" height="20" rx="4" fill="#ffe8a1" stroke="#e67e00" stroke-width="1.5"/>
                            <text x="60" y="38" font-size="8" fill="#333" text-anchor="middle">Patch Embed</text>
                            
                            <path d="M 60 45 L 60 53" stroke="#ffc107" stroke-width="1.5" marker-end="url(#arrow8)"/>
                            
                            <!-- Transformer blocks -->
                            <rect x="15" y="53" width="90" height="22" rx="4" fill="#ffd966" stroke="#e67e00" stroke-width="1.5"/>
                            <text x="60" y="63" font-size="8" fill="#333" text-anchor="middle">Transformer</text>
                            <text x="60" y="72" font-size="7" fill="#555" text-anchor="middle">×L layers</text>
                            
                            <path d="M 60 75 L 60 83" stroke="#ffc107" stroke-width="1.5" marker-end="url(#arrow8)"/>
                            
                            <!-- Reshape -->
                            <rect x="15" y="83" width="90" height="20" rx="4" fill="#ffe8a1" stroke="#e67e00" stroke-width="1.5"/>
                            <text x="60" y="96" font-size="8" fill="#333" text-anchor="middle">Reshape</text>
                            
                            <text x="60" y="128" font-size="7" fill="#e67e00" font-weight="600" text-anchor="middle">Global Context</text>
                            <text x="60" y="138" font-size="7" fill="#e67e00" font-weight="600" text-anchor="middle">32×32×512</text>
                        </g>

                        <!-- CNN Decoder -->
                        <g transform="translate(560, 50)">
                            <text x="80" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">CNN Decoder</text>
                            
                            <rect x="0" y="0" width="160" height="180" rx="8" fill="#f8fff8" stroke="#28a745" stroke-width="2"/>
                            
                            <!-- Upsample 1 -->
                            <rect x="15" y="10" width="70" height="25" rx="3" fill="#c3e6c3" stroke="#28a745" stroke-width="1.5"/>
                            <text x="50" y="20" font-size="8" fill="#333" text-anchor="middle">Upsample +</text>
                            <text x="50" y="30" font-size="8" fill="#333" text-anchor="middle">Skip Connection</text>
                            <text x="130" y="22" font-size="7" fill="#999">64×64×256</text>
                            
                            <path d="M 50 35 L 50 50" stroke="#28a745" stroke-width="1.5" marker-end="url(#arrow9)"/>
                            
                            <!-- Upsample 2 -->
                            <rect x="15" y="50" width="70" height="25" rx="3" fill="#a8d8a8" stroke="#28a745" stroke-width="1.5"/>
                            <text x="50" y="60" font-size="8" fill="#333" text-anchor="middle">Upsample +</text>
                            <text x="50" y="70" font-size="8" fill="#333" text-anchor="middle">Skip Connection</text>
                            <text x="130" y="62" font-size="7" fill="#999">128×128×128</text>
                            
                            <path d="M 50 75 L 50 90" stroke="#28a745" stroke-width="1.5" marker-end="url(#arrow9)"/>
                            
                            <!-- Upsample 3 -->
                            <rect x="15" y="90" width="70" height="25" rx="3" fill="#8dc98d" stroke="#28a745" stroke-width="1.5"/>
                            <text x="50" y="100" font-size="8" fill="#333" text-anchor="middle">Upsample +</text>
                            <text x="50" y="110" font-size="8" fill="#333" text-anchor="middle">Skip Connection</text>
                            <text x="130" y="102" font-size="7" fill="#999">256×256×64</text>
                            
                            <path d="M 50 115 L 50 130" stroke="#28a745" stroke-width="1.5" marker-end="url(#arrow9)"/>
                            
                            <!-- Final -->
                            <rect x="15" y="130" width="70" height="25" rx="3" fill="#6fbf6f" stroke="#28a745" stroke-width="1.5"/>
                            <text x="50" y="140" font-size="8" fill="#fff" text-anchor="middle">Upsample +</text>
                            <text x="50" y="150" font-size="8" fill="#fff" text-anchor="middle">Conv 1×1</text>
                            <text x="130" y="142" font-size="7" fill="#999">512×512×C</text>
                            
                            <text x="80" y="170" font-size="7" fill="#28a745" font-weight="600" text-anchor="middle">C = number of classes</text>
                        </g>

                        <!-- Output -->
                        <g transform="translate(760, 90)">
                            <text x="50" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Segmentation</text>
                            <text x="50" y="3" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Output</text>
                            
                            <rect x="0" y="15" width="100" height="100" fill="#e8ffe8" stroke="#28a745" stroke-width="2" rx="6"/>
                            <text x="50" y="60" font-size="10" fill="#666" text-anchor="middle">Pixel-wise</text>
                            <text x="50" y="75" font-size="10" fill="#666" text-anchor="middle">Classification</text>
                            <text x="50" y="93" font-size="8" fill="#999" text-anchor="middle">512 × 512</text>
                        </g>

                        <!-- Benefits explanation -->
                        <g transform="translate(40, 250)">
                            <rect x="0" y="0" width="800" height="115" rx="8" fill="#f0f7ff" stroke="#1E64C8" stroke-width="2"/>
                            
                            <text x="400" y="22" font-size="12" fill="#1E64C8" font-weight="700" text-anchor="middle">Why Hybrid Architecture Works</text>
                            
                            <g transform="translate(30, 40)">
                                <text x="0" y="0" font-size="10" fill="#1E64C8" font-weight="600">CNN Backbone Benefits:</text>
                                <text x="0" y="16" font-size="9" fill="#555">• Strong inductive biases for local patterns</text>
                                <text x="0" y="30" font-size="9" fill="#555">• Efficient spatial dimension reduction</text>
                                <text x="0" y="44" font-size="9" fill="#555">• Parameter-efficient feature extraction</text>
                                <text x="0" y="58" font-size="9" fill="#555">• Translation invariance and locality</text>
                            </g>
                            
                            <g transform="translate(400, 40)">
                                <text x="0" y="0" font-size="10" fill="#ffc107" font-weight="600">Transformer Benefits:</text>
                                <text x="0" y="16" font-size="9" fill="#555">• Global receptive field at bottleneck</text>
                                <text x="0" y="30" font-size="9" fill="#555">• Long-range dependency modeling</text>
                                <text x="0" y="44" font-size="9" fill="#555">• Context-aware feature enhancement</text>
                                <text x="0" y="58" font-size="9" fill="#555">• Better semantic understanding</text>
                            </g>
                            
                            <text x="400" y="95" font-size="9" fill="#28a745" font-weight="600" text-anchor="middle">Result: Best of both worlds - local detail + global context</text>
                        </g>

                        <!-- Arrows -->
                        <path d="M 165 110 L 195 110" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow7)"/>
                        <path d="M 365 110 L 395 102" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow7)"/>
                        <path d="M 525 102 L 555 140" stroke="#ffc107" stroke-width="2" marker-end="url(#arrow8)"/>
                        <path d="M 725 140 L 755 140" stroke="#28a745" stroke-width="2" marker-end="url(#arrow9)"/>

                        <defs>
                            <marker id="arrow7" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#1E64C8" />
                            </marker>
                            <marker id="arrow8" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#ffc107" />
                            </marker>
                            <marker id="arrow9" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#28a745" />
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="key-points">
                    <div class="key-points-title">Key Design Principles:</div>
                    <ul>
                        <li><strong>Hierarchical processing:</strong> CNN extracts multi-scale features, transformer refines at bottleneck</li>
                        <li><strong>Skip connections:</strong> Preserve spatial details from encoder for precise segmentation</li>
                        <li><strong>Computational efficiency:</strong> Transformer operates on reduced spatial dimensions</li>
                        <li><strong>Data efficiency:</strong> CNN inductive biases require less training data than pure transformers</li>
                        <li><strong>Best of both worlds:</strong> Local feature extraction + global context modeling</li>
                    </ul>
                </div>

                <div class="applications">
                    <div class="applications-title">Notable Hybrid Architectures:</div>
                    <ul>
                        <li><strong>TransUNet:</strong> U-Net with transformer bottleneck for medical image segmentation</li>
                        <li><strong>CoAtNet:</strong> Combines convolution and self-attention, state-of-the-art on ImageNet</li>
                        <li><strong>Swin-UNet:</strong> Swin Transformer-based U-Net for medical image segmentation</li>
                        <li><strong>UNETR:</strong> Pure transformer encoder with CNN decoder for 3D medical imaging</li>
                        <li><strong>SegFormer:</strong> Hierarchical transformer encoder with lightweight MLP decoder</li>
                    </ul>
                </div>
            </div>

            <!-- 5. Interpretability Benefits -->
            <div class="detail-card">
                <div class="detail-title">5. Interpretability Benefits</div>
                <div class="detail-content">
                    <p><strong>Interpretability</strong> is crucial in medical AI, where understanding model decisions can be as important as accuracy. Attention mechanisms provide inherent interpretability through attention weights, which reveal which parts of the input the model focuses on when making predictions.</p>
                    
                    <p><strong>Advantages over CNNs:</strong> While CNN activation maps show which features are activated, attention maps directly show the relationships and dependencies between different regions. This makes attention mechanisms more intuitive for clinicians to understand and trust, especially in critical medical decision-making scenarios.</p>
                </div>

                <div class="visualization-container">
                    <svg width="870" height="400" viewBox="0 0 870 400">
                        <!-- Title -->
                        <text x="435" y="20" font-size="14" fill="#1E64C8" font-weight="700" text-anchor="middle">Attention-Based Interpretability in Medical Diagnosis</text>
                        
                        <!-- Original Image -->
                        <g transform="translate(40, 50)">
                            <text x="100" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Input: Chest X-Ray</text>
                            
                            <rect x="0" y="0" width="200" height="200" fill="#e8f2ff" stroke="#1E64C8" stroke-width="2" rx="6"/>
                            
                            <!-- Simulated lung regions -->
                            <ellipse cx="70" cy="80" rx="35" ry="50" fill="#bdd9ff" stroke="#1E64C8" stroke-width="1.5" opacity="0.6"/>
                            <ellipse cx="130" cy="80" rx="35" ry="50" fill="#bdd9ff" stroke="#1E64C8" stroke-width="1.5" opacity="0.6"/>
                            
                            <!-- Abnormality -->
                            <circle cx="130" cy="70" r="18" fill="#ff6b6b" opacity="0.7"/>
                            
                            <text x="100" y="220" font-size="9" fill="#666" text-anchor="middle">Original medical image</text>
                        </g>

                        <!-- Attention Heatmap -->
                        <g transform="translate(280, 50)">
                            <text x="100" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Attention Heatmap</text>
                            
                            <rect x="0" y="0" width="200" height="200" fill="#e8f2ff" stroke="#dc3545" stroke-width="2.5" rx="6"/>
                            
                            <!-- Heatmap overlay -->
                            <ellipse cx="70" cy="80" rx="35" ry="50" fill="#ffeb3b" opacity="0.3"/>
                            <ellipse cx="130" cy="80" rx="35" ry="50" fill="#ffeb3b" opacity="0.3"/>
                            
                            <!-- High attention area -->
                            <circle cx="130" cy="70" r="25" fill="#dc3545" opacity="0.8"/>
                            <circle cx="130" cy="70" r="18" fill="#c82333" opacity="0.9"/>
                            <circle cx="130" cy="70" r="12" fill="#a71d2a" opacity="1"/>
                            
                            <!-- Color scale -->
                            <g transform="translate(10, 160)">
                                <text x="0" y="0" font-size="8" fill="#666">Attention:</text>
                                <rect x="0" y="5" width="30" height="8" fill="#ffeb3b" opacity="0.3"/>
                                <text x="32" y="13" font-size="7" fill="#666">Low</text>
                                
                                <rect x="70" y="5" width="30" height="8" fill="#ff9800" opacity="0.7"/>
                                <text x="102" y="13" font-size="7" fill="#666">Med</text>
                                
                                <rect x="140" y="5" width="30" height="8" fill="#dc3545" opacity="1"/>
                                <text x="172" y="13" font-size="7" fill="#666">High</text>
                            </g>
                            
                            <text x="100" y="220" font-size="9" fill="#dc3545" font-weight="600" text-anchor="middle">Model focuses on abnormal region</text>
                        </g>

                        <!-- Interpretation -->
                        <g transform="translate(520, 50)">
                            <text x="160" y="-10" font-size="11" fill="#333" font-weight="600" text-anchor="middle">Clinical Interpretation</text>
                            
                            <rect x="0" y="0" width="320" height="200" rx="8" fill="#fff9e6" stroke="#ffc107" stroke-width="2"/>
                            
                            <text x="160" y="25" font-size="11" fill="#e67e00" font-weight="700" text-anchor="middle">Attention Analysis</text>
                            
                            <g transform="translate(20, 45)">
                                <text x="0" y="0" font-size="10" fill="#333" font-weight="600">High Attention Regions:</text>
                                <text x="0" y="18" font-size="9" fill="#dc3545">● Right upper lung (0.68 attention weight)</text>
                                <text x="10" y="32" font-size="8" fill="#555">→ Consolidation pattern detected</text>
                                <text x="10" y="44" font-size="8" fill="#555">→ Consistent with pneumonia</text>
                                
                                <text x="0" y="62" font-size="9" fill="#ff9800">● Surrounding lung tissue (0.22)</text>
                                <text x="10" y="76" font-size="8" fill="#555">→ Model checks adjacent areas</text>
                                <text x="10" y="88" font-size="8" fill="#555">→ Assessing extent of infection</text>
                                
                                <text x="0" y="106" font-size="9" fill="#28a745">● Left lung relatively normal (0.10)</text>
                                <text x="10" y="120" font-size="8" fill="#555">→ Lower attention weight</text>
                                <text x="10" y="132" font-size="8" fill="#555">→ Confirms unilateral condition</text>
                            </g>
                            
                            <rect x="10" y="165" width="300" height="25" rx="4" fill="#e8ffe8" stroke="#28a745" stroke-width="1.5"/>
                            <text x="160" y="182" font-size="9" fill="#28a745" font-weight="600" text-anchor="middle">✓ Clinically meaningful and trustworthy</text>
                        </g>

                        <!-- Comparison with CNN -->
                        <g transform="translate(40, 280)">
                            <rect x="0" y="0" width="800" height="105" rx="8" fill="#f0f7ff" stroke="#1E64C8" stroke-width="2"/>
                            
                            <text x="400" y="22" font-size="12" fill="#1E64C8" font-weight="700" text-anchor="middle">Attention vs CNN Activation Maps</text>
                            
                            <!-- Attention column -->
                            <g transform="translate(50, 40)">
                                <text x="150" y="0" font-size="10" fill="#28a745" font-weight="600" text-anchor="middle">Attention Mechanisms</text>
                                
                                <text x="0" y="18" font-size="9" fill="#555">✓ <tspan font-weight="600">Direct relationships:</tspan> Shows which</text>
                                <text x="5" y="31" font-size="9" fill="#555">regions are related to each other</text>
                                
                                <text x="0" y="46" font-size="9" fill="#555">✓ <tspan font-weight="600">Global context:</tspan> Attention weights</text>
                                <text x="5" y="59" font-size="9" fill="#555">reflect long-range dependencies</text>
                            </g>
                            
                            <!-- CNN column -->
                            <g transform="translate(450, 40)">
                                <text x="150" y="0" font-size="10" fill="#666" font-weight="600" text-anchor="middle">CNN Activation Maps</text>
                                
                                <text x="0" y="18" font-size="9" fill="#555">• <tspan font-weight="600">Feature detection:</tspan> Shows which</text>
                                <text x="5" y="31" font-size="9" fill="#555">features are activated</text>
                                
                                <text x="0" y="46" font-size="9" fill="#555">• <tspan font-weight="600">Local patterns:</tspan> Limited to</text>
                                <text x="5" y="59" font-size="9" fill="#555">receptive field of filters</text>
                            </g>
                        </g>
                    </svg>
                </div>

                <div class="key-points">
                    <div class="key-points-title">Interpretability Advantages:</div>
                    <ul>
                        <li><strong>Direct visualization:</strong> Attention weights directly show importance of each region</li>
                        <li><strong>Clinical relevance:</strong> Attention patterns often align with clinical features radiologists look for</li>
                        <li><strong>Trust building:</strong> Explainable decisions help clinicians trust and adopt AI systems</li>
                        <li><strong>Error analysis:</strong> When model fails, attention maps reveal why it made incorrect decisions</li>
                        <li><strong>Multi-head insights:</strong> Different attention heads can focus on different clinical aspects</li>
                        <li><strong>Regulatory compliance:</strong> Interpretability aids in meeting medical AI regulatory requirements</li>
                    </ul>
                </div>

                <div class="applications">
                    <div class="applications-title">Practical Applications:</div>
                    <ul>
                        <li><strong>Diagnostic validation:</strong> Verify AI is looking at clinically relevant regions</li>
                        <li><strong>Educational tool:</strong> Teaching medical students by showing what experts focus on</li>
                        <li><strong>Quality control:</strong> Detect when model makes predictions based on artifacts or irrelevant features</li>
                        <li><strong>Clinical workflow integration:</strong> Attention maps guide radiologists to suspicious regions</li>
                        <li><strong>Research insights:</strong> Discover new imaging biomarkers through attention pattern analysis</li>
                        <li><strong>Patient communication:</strong> Help explain diagnoses to patients using visual attention maps</li>
                    </ul>
                </div>

                <div class="key-points" style="background: #ffe6e6; border-left-color: #dc3545;">
                    <div class="key-points-title" style="color: #dc3545;">Important Considerations:</div>
                    <ul>
                        <li>Attention weights don't always equal model importance - they show correlation, not causation</li>
                        <li>Different attention heads may focus on different features - comprehensive analysis requires examining multiple heads</li>
                        <li>High attention doesn't guarantee correct prediction - model can focus on right region but make wrong diagnosis</li>
                        <li>Interpretability should complement, not replace, rigorous clinical validation</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</body>
</html>