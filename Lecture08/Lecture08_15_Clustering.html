<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering for Subtypes - Enhanced</title>
<style>
* {margin:0;padding:0;box-sizing:border-box;}
body {font-family:Aptos,'Segoe UI',sans-serif;background:#f5f5f5;padding:40px 20px;}
.container {max-width:1200px;margin:0 auto;background:white;padding:50px;border-radius:15px;box-shadow:0 4px 20px rgba(0,0,0,0.1);}
.title {font-size:42px;font-weight:700;color:#1E64C8;margin-bottom:20px;text-align:center;}
.subtitle {font-size:18px;color:#666;margin-bottom:40px;text-align:center;}
.methods-grid {display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:60px;}
.method-card {background:#f8fbff;border:3px solid #1E64C8;border-radius:10px;padding:20px 25px;}
.method-name {font-size:20px;font-weight:700;color:#1E64C8;margin-bottom:12px;}
.method-desc {font-size:15px;color:#333;line-height:1.5;margin-bottom:12px;}
.clinical-use {background:white;border:2px dashed #1E64C8;border-radius:6px;padding:10px 14px;font-size:14px;color:#555;}

/* Detailed sections */
.detailed-section {margin-bottom:50px;padding:30px;background:#fafafa;border-radius:12px;border-left:5px solid #1E64C8;}
.section-title {font-size:32px;font-weight:700;color:#1E64C8;margin-bottom:25px;}
.section-content {display:grid;grid-template-columns:1fr 1fr;gap:30px;align-items:start;}
.text-content {padding-right:20px;}
.visual-content {background:white;padding:25px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.08);}
.subsection-title {font-size:20px;font-weight:600;color:#333;margin:20px 0 10px 0;}
.description {font-size:15px;color:#555;line-height:1.7;margin-bottom:15px;}
.key-points {background:white;padding:15px 20px;border-radius:8px;margin:15px 0;}
.key-point {font-size:14px;color:#333;margin:8px 0;padding-left:20px;position:relative;}
.key-point:before {content:"▸";position:absolute;left:0;color:#1E64C8;font-weight:bold;}
.algorithm-steps {background:#e8f4ff;padding:15px 20px;border-radius:8px;margin:15px 0;}
.step {font-size:14px;color:#333;margin:8px 0;padding-left:25px;}

/* SVG styles */
.cluster-viz {width:100%;height:auto;}
svg text {font-family:Aptos,'Segoe UI',sans-serif;}

.pros-cons {display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-top:20px;}
.pros, .cons {padding:15px;border-radius:8px;}
.pros {background:#e8f8e8;border-left:4px solid #4CAF50;}
.cons {background:#ffe8e8;border-left:4px solid #f44336;}
.pros-title, .cons-title {font-weight:600;margin-bottom:10px;font-size:16px;}
.pros-title {color:#2e7d32;}
.cons-title {color:#c62828;}
</style>
</head>
<body>
<div class="container">
<!-- Original Summary Section -->
<div class="title">Clustering for Disease Subtypes</div>
<div class="subtitle">Discover hidden patient subgroups with distinct characteristics</div>

<div class="methods-grid">
<div class="method-card">
<div class="method-name">K-means</div>
<div class="method-desc">Fast, scalable clustering with predefined number of clusters</div>
<div class="clinical-use">Cancer subtypes from gene expression</div>
</div>
<div class="method-card">
<div class="method-name">Hierarchical Clustering</div>
<div class="method-desc">Dendrogram-based, no need to specify K upfront</div>
<div class="clinical-use">Patient stratification visualization</div>
</div>
<div class="method-card">
<div class="method-name">DBSCAN</div>
<div class="method-desc">Density-based, finds arbitrary shapes, handles outliers</div>
<div class="clinical-use">Anomaly detection in clinical data</div>
</div>
<div class="method-card">
<div class="method-name">Consensus Clustering</div>
<div class="method-desc">Robust clustering through multiple runs and voting</div>
<div class="clinical-use">Stable disease subtype identification</div>
</div>
</div>

<!-- Detailed Section 1: K-means -->
<div class="detailed-section">
<div class="section-title">1. K-means Clustering</div>
<div class="section-content">
<div class="text-content">
<div class="description">
K-means is a partitioning method that divides data into K distinct, non-overlapping clusters. Each data point belongs to the cluster with the nearest mean (centroid). It's one of the most popular clustering algorithms due to its simplicity and efficiency.
</div>

<div class="algorithm-steps">
<div class="subsection-title">Algorithm Steps:</div>
<div class="step">1. Initialize K centroids randomly</div>
<div class="step">2. Assign each point to nearest centroid</div>
<div class="step">3. Recalculate centroids as cluster means</div>
<div class="step">4. Repeat steps 2-3 until convergence</div>
</div>

<div class="key-points">
<div class="subsection-title">Key Characteristics:</div>
<div class="key-point">Requires specifying K (number of clusters) in advance</div>
<div class="key-point">Uses Euclidean distance for similarity</div>
<div class="key-point">Assumes spherical, equal-sized clusters</div>
<div class="key-point">Time complexity: O(n·K·i·d) where i = iterations, d = dimensions</div>
</div>

<div class="pros-cons">
<div class="pros">
<div class="pros-title">✓ Advantages</div>
<div class="key-point">Fast and scalable</div>
<div class="key-point">Easy to implement</div>
<div class="key-point">Works well with large datasets</div>
</div>
<div class="cons">
<div class="cons-title">✗ Limitations</div>
<div class="key-point">Sensitive to initialization</div>
<div class="key-point">Struggles with non-spherical shapes</div>
<div class="key-point">Affected by outliers</div>
</div>
</div>

<div class="subsection-title" style="margin-top:20px;">Clinical Example:</div>
<div class="description">
Identifying breast cancer subtypes (Luminal A, Luminal B, HER2+, Basal-like) based on gene expression profiles of ER, PR, and HER2 markers.
</div>
</div>

<div class="visual-content">
<svg class="cluster-viz" viewBox="0 0 400 380" xmlns="http://www.w3.org/2000/svg">
<!-- Title -->
<text x="200" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#1E64C8">K-means Clustering (K=3)</text>
<text x="200" y="45" text-anchor="middle" font-size="12" fill="#666">Iteration: Final Result</text>

<!-- Cluster 1 (Blue) - Top Left -->
<circle cx="80" cy="100" r="6" fill="#4A90E2" opacity="0.7"/>
<circle cx="95" cy="90" r="6" fill="#4A90E2" opacity="0.7"/>
<circle cx="70" cy="115" r="6" fill="#4A90E2" opacity="0.7"/>
<circle cx="90" cy="120" r="6" fill="#4A90E2" opacity="0.7"/>
<circle cx="105" cy="105" r="6" fill="#4A90E2" opacity="0.7"/>
<circle cx="75" cy="95" r="6" fill="#4A90E2" opacity="0.7"/>
<circle cx="85" cy="110" r="6" fill="#4A90E2" opacity="0.7"/>
<!-- Centroid 1 -->
<circle cx="85" cy="105" r="10" fill="none" stroke="#1E64C8" stroke-width="3"/>
<circle cx="85" cy="105" r="4" fill="#1E64C8"/>
<text x="85" y="145" text-anchor="middle" font-size="11" fill="#1E64C8" font-weight="600">Cluster 1</text>

<!-- Cluster 2 (Green) - Top Right -->
<circle cx="290" cy="90" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="310" cy="100" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="300" cy="115" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="280" cy="105" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="320" cy="110" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="295" cy="95" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="305" cy="120" r="6" fill="#50C878" opacity="0.7"/>
<circle cx="315" cy="95" r="6" fill="#50C878" opacity="0.7"/>
<!-- Centroid 2 -->
<circle cx="300" cy="105" r="10" fill="none" stroke="#2E7D32" stroke-width="3"/>
<circle cx="300" cy="105" r="4" fill="#2E7D32"/>
<text x="300" y="145" text-anchor="middle" font-size="11" fill="#2E7D32" font-weight="600">Cluster 2</text>

<!-- Cluster 3 (Orange) - Bottom Center -->
<circle cx="180" cy="250" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="200" cy="240" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="190" cy="265" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="210" cy="255" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="195" cy="245" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="185" cy="260" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="205" cy="270" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="175" cy="255" r="6" fill="#FF9F40" opacity="0.7"/>
<circle cx="215" cy="245" r="6" fill="#FF9F40" opacity="0.7"/>
<!-- Centroid 3 -->
<circle cx="195" cy="255" r="10" fill="none" stroke="#E65100" stroke-width="3"/>
<circle cx="195" cy="255" r="4" fill="#E65100"/>
<text x="195" y="295" text-anchor="middle" font-size="11" fill="#E65100" font-weight="600">Cluster 3</text>

<!-- Legend -->
<rect x="50" y="320" width="300" height="50" fill="#f8f8f8" rx="5" stroke="#ddd"/>
<circle cx="80" cy="340" r="5" fill="#4A90E2" opacity="0.7"/>
<text x="92" y="344" font-size="11" fill="#333">Data Points</text>
<circle cx="180" cy="340" r="8" fill="none" stroke="#1E64C8" stroke-width="2"/>
<circle cx="180" cy="340" r="3" fill="#1E64C8"/>
<text x="195" y="344" font-size="11" fill="#333">Centroids</text>
<text x="200" y="360" text-anchor="middle" font-size="10" fill="#666" font-style="italic">Points assigned to nearest centroid</text>
</svg>
</div>
</div>
</div>

<!-- Detailed Section 2: Hierarchical Clustering -->
<div class="detailed-section">
<div class="section-title">2. Hierarchical Clustering</div>
<div class="section-content">
<div class="text-content">
<div class="description">
Hierarchical clustering builds a tree-like structure (dendrogram) showing relationships between data points. It can be agglomerative (bottom-up) or divisive (top-down), with agglomerative being more common in biomedical applications.
</div>

<div class="algorithm-steps">
<div class="subsection-title">Algorithm Steps (Agglomerative):</div>
<div class="step">1. Start with each point as its own cluster</div>
<div class="step">2. Find the two most similar clusters</div>
<div class="step">3. Merge them into a single cluster</div>
<div class="step">4. Repeat until all points are in one cluster</div>
</div>

<div class="key-points">
<div class="subsection-title">Key Characteristics:</div>
<div class="key-point">No need to specify K in advance</div>
<div class="key-point">Creates hierarchical structure (dendrogram)</div>
<div class="key-point">Multiple linkage methods: single, complete, average, Ward</div>
<div class="key-point">Time complexity: O(n³) or O(n²log n) with optimizations</div>
</div>

<div class="key-points">
<div class="subsection-title">Linkage Methods:</div>
<div class="key-point"><strong>Single:</strong> Minimum distance between clusters</div>
<div class="key-point"><strong>Complete:</strong> Maximum distance between clusters</div>
<div class="key-point"><strong>Average:</strong> Average distance between all pairs</div>
<div class="key-point"><strong>Ward:</strong> Minimizes within-cluster variance</div>
</div>

<div class="pros-cons">
<div class="pros">
<div class="pros-title">✓ Advantages</div>
<div class="key-point">No pre-specified K needed</div>
<div class="key-point">Dendrogram shows relationships</div>
<div class="key-point">Deterministic results</div>
</div>
<div class="cons">
<div class="cons-title">✗ Limitations</div>
<div class="key-point">Computationally expensive</div>
<div class="key-point">Doesn't scale to large datasets</div>
<div class="key-point">Sensitive to noise/outliers</div>
</div>
</div>

<div class="subsection-title" style="margin-top:20px;">Clinical Example:</div>
<div class="description">
Patient stratification based on multiple clinical variables (age, lab values, symptoms) to visualize patient similarity and identify natural groupings for personalized treatment.
</div>
</div>

<div class="visual-content">
<svg class="cluster-viz" viewBox="0 0 400 380" xmlns="http://www.w3.org/2000/svg">
<!-- Title -->
<text x="200" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#1E64C8">Hierarchical Clustering Dendrogram</text>

<!-- Patient labels at bottom -->
<text x="50" y="330" text-anchor="middle" font-size="10" fill="#333">P1</text>
<text x="90" y="330" text-anchor="middle" font-size="10" fill="#333">P2</text>
<text x="130" y="330" text-anchor="middle" font-size="10" fill="#333">P3</text>
<text x="170" y="330" text-anchor="middle" font-size="10" fill="#333">P4</text>
<text x="230" y="330" text-anchor="middle" font-size="10" fill="#333">P5</text>
<text x="270" y="330" text-anchor="middle" font-size="10" fill="#333">P6</text>
<text x="310" y="330" text-anchor="middle" font-size="10" fill="#333">P7</text>
<text x="350" y="330" text-anchor="middle" font-size="10" fill="#333">P8</text>

<!-- Vertical lines from patients -->
<line x1="50" y1="320" x2="50" y2="280" stroke="#666" stroke-width="2"/>
<line x1="90" y1="320" x2="90" y2="290" stroke="#666" stroke-width="2"/>
<line x1="130" y1="320" x2="130" y2="270" stroke="#666" stroke-width="2"/>
<line x1="170" y1="320" x2="170" y2="265" stroke="#666" stroke-width="2"/>
<line x1="230" y1="320" x2="230" y2="240" stroke="#666" stroke-width="2"/>
<line x1="270" y1="320" x2="270" y2="250" stroke="#666" stroke-width="2"/>
<line x1="310" y1="320" x2="310" y2="220" stroke="#666" stroke-width="2"/>
<line x1="350" y1="320" x2="350" y2="230" stroke="#666" stroke-width="2"/>

<!-- First level merges -->
<line x1="50" y1="280" x2="90" y2="280" stroke="#4A90E2" stroke-width="2.5"/>
<line x1="130" y1="270" x2="170" y2="270" stroke="#50C878" stroke-width="2.5"/>
<line x1="310" y1="220" x2="350" y2="220" stroke="#FF9F40" stroke-width="2.5"/>
<line x1="230" y1="240" x2="270" y2="240" stroke="#FF9F40" stroke-width="2.5"/>

<!-- Second level merges -->
<line x1="70" y1="280" x2="70" y2="210" stroke="#4A90E2" stroke-width="2.5"/>
<line x1="150" y1="270" x2="150" y2="200" stroke="#50C878" stroke-width="2.5"/>
<line x1="70" y1="210" x2="150" y2="210" stroke="#1E64C8" stroke-width="3"/>

<line x1="250" y1="240" x2="250" y2="170" stroke="#FF9F40" stroke-width="2.5"/>
<line x1="330" y1="220" x2="330" y2="170" stroke="#FF9F40" stroke-width="2.5"/>
<line x1="250" y1="170" x2="330" y2="170" stroke="#E65100" stroke-width="3"/>

<!-- Top level merge -->
<line x1="110" y1="210" x2="110" y2="100" stroke="#1E64C8" stroke-width="3"/>
<line x1="290" y1="170" x2="290" y2="100" stroke="#E65100" stroke-width="3"/>
<line x1="110" y1="100" x2="290" y2="100" stroke="#333" stroke-width="3.5"/>

<!-- Height axis -->
<line x1="20" y1="320" x2="20" y2="80" stroke="#999" stroke-width="1.5"/>
<text x="15" y="85" text-anchor="end" font-size="10" fill="#666">Height</text>
<line x1="15" y1="320" x2="20" y2="320" stroke="#999" stroke-width="1.5"/>
<line x1="15" y1="240" x2="20" y2="240" stroke="#999" stroke-width="1.5"/>
<line x1="15" y1="170" x2="20" y2="170" stroke="#999" stroke-width="1.5"/>
<line x1="15" y1="100" x2="20" y2="100" stroke="#999" stroke-width="1.5"/>

<!-- Cluster boxes -->
<rect x="35" y="185" width="130" height="20" fill="none" stroke="#4A90E2" stroke-width="2" stroke-dasharray="5,3" rx="3"/>
<text x="100" y="200" text-anchor="middle" font-size="11" fill="#1E64C8" font-weight="600">Cluster A</text>

<rect x="215" y="145" width="145" height="20" fill="none" stroke="#FF9F40" stroke-width="2" stroke-dasharray="5,3" rx="3"/>
<text x="287" y="160" text-anchor="middle" font-size="11" fill="#E65100" font-weight="600">Cluster B</text>

<!-- Legend -->
<text x="200" y="360" text-anchor="middle" font-size="10" fill="#666" font-style="italic">Cut height determines number of clusters</text>
</svg>
</div>
</div>
</div>

<!-- Detailed Section 3: DBSCAN -->
<div class="detailed-section">
<div class="section-title">3. DBSCAN (Density-Based Spatial Clustering)</div>
<div class="section-content">
<div class="text-content">
<div class="description">
DBSCAN identifies clusters based on density - regions where points are closely packed together. Unlike K-means, it can find arbitrarily-shaped clusters and automatically identifies outliers as noise points.
</div>

<div class="algorithm-steps">
<div class="subsection-title">Algorithm Steps:</div>
<div class="step">1. Pick a random unvisited point</div>
<div class="step">2. Find all points within ε distance (neighbors)</div>
<div class="step">3. If neighbors ≥ minPts, start a new cluster</div>
<div class="step">4. Recursively add density-reachable points</div>
<div class="step">5. Mark isolated points as noise/outliers</div>
</div>

<div class="key-points">
<div class="subsection-title">Key Parameters:</div>
<div class="key-point"><strong>ε (epsilon):</strong> Maximum distance for neighborhood</div>
<div class="key-point"><strong>minPts:</strong> Minimum points to form dense region</div>
<div class="key-point"><strong>Core point:</strong> Has ≥ minPts within ε distance</div>
<div class="key-point"><strong>Border point:</strong> In neighborhood of core point</div>
<div class="key-point"><strong>Noise point:</strong> Neither core nor border</div>
</div>

<div class="pros-cons">
<div class="pros">
<div class="pros-title">✓ Advantages</div>
<div class="key-point">Finds arbitrary-shaped clusters</div>
<div class="key-point">Identifies outliers/noise</div>
<div class="key-point">No need to specify K</div>
<div class="key-point">Robust to outliers</div>
</div>
<div class="cons">
<div class="cons-title">✗ Limitations</div>
<div class="key-point">Struggles with varying densities</div>
<div class="key-point">Sensitive to ε and minPts</div>
<div class="key-point">High-dimensional challenges</div>
</div>
</div>

<div class="subsection-title" style="margin-top:20px;">Clinical Example:</div>
<div class="description">
Detecting unusual patient clusters in electronic health records that may represent rare disease phenotypes or adverse drug reactions, while identifying outlier cases that need special attention.
</div>
</div>

<div class="visual-content">
<svg class="cluster-viz" viewBox="0 0 400 380" xmlns="http://www.w3.org/2000/svg">
<!-- Title -->
<text x="200" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#1E64C8">DBSCAN Clustering</text>
<text x="200" y="45" text-anchor="middle" font-size="12" fill="#666">ε = radius, minPts = 4</text>

<!-- Cluster 1 (Blue) - Left dense region -->
<circle cx="80" cy="120" r="7" fill="#4A90E2"/>
<circle cx="95" cy="110" r="7" fill="#4A90E2"/>
<circle cx="70" cy="135" r="7" fill="#4A90E2"/>
<circle cx="90" cy="140" r="7" fill="#4A90E2"/>
<circle cx="105" cy="125" r="7" fill="#4A90E2"/>
<circle cx="75" cy="115" r="7" fill="#4A90E2"/>
<circle cx="85" cy="130" r="7" fill="#4A90E2"/>
<circle cx="100" cy="145" r="7" fill="#4A90E2"/>
<circle cx="65" cy="125" r="7" fill="#4A90E2"/>

<!-- Example epsilon circle on one core point -->
<circle cx="85" cy="130" r="35" fill="none" stroke="#4A90E2" stroke-width="1.5" stroke-dasharray="3,3" opacity="0.5"/>

<!-- Cluster 2 (Green) - Right curved cluster -->
<circle cx="280" cy="100" r="7" fill="#50C878"/>
<circle cx="300" cy="110" r="7" fill="#50C878"/>
<circle cx="310" cy="130" r="7" fill="#50C878"/>
<circle cx="315" cy="155" r="7" fill="#50C878"/>
<circle cx="310" cy="180" r="7" fill="#50C878"/>
<circle cx="295" cy="195" r="7" fill="#50C878"/>
<circle cx="275" cy="200" r="7" fill="#50C878"/>
<circle cx="260" cy="190" r="7" fill="#50C878"/>
<circle cx="295" cy="130" r="7" fill="#50C878"/>
<circle cx="285" cy="160" r="7" fill="#50C878"/>

<!-- Cluster 3 (Orange) - Bottom small cluster -->
<circle cx="180" cy="250" r="7" fill="#FF9F40"/>
<circle cx="195" cy="245" r="7" fill="#FF9F40"/>
<circle cx="190" cy="265" r="7" fill="#FF9F40"/>
<circle cx="205" cy="260" r="7" fill="#FF9F40"/>
<circle cx="185" cy="255" r="7" fill="#FF9F40"/>

<!-- Noise/Outlier points (Red X) -->
<g transform="translate(150, 90)">
<line x1="-5" y1="-5" x2="5" y2="5" stroke="#E53935" stroke-width="3"/>
<line x1="-5" y1="5" x2="5" y2="-5" stroke="#E53935" stroke-width="3"/>
</g>
<g transform="translate(250, 90)">
<line x1="-5" y1="-5" x2="5" y2="5" stroke="#E53935" stroke-width="3"/>
<line x1="-5" y1="5" x2="5" y2="-5" stroke="#E53935" stroke-width="3"/>
</g>
<g transform="translate(140, 200)">
<line x1="-5" y1="-5" x2="5" y2="5" stroke="#E53935" stroke-width="3"/>
<line x1="-5" y1="5" x2="5" y2="-5" stroke="#E53935" stroke-width="3"/>
</g>
<g transform="translate(330, 230)">
<line x1="-5" y1="-5" x2="5" y2="5" stroke="#E53935" stroke-width="3"/>
<line x1="-5" y1="5" x2="5" y2="-5" stroke="#E53935" stroke-width="3"/>
</g>

<!-- Labels -->
<text x="85" y="175" text-anchor="middle" font-size="11" fill="#1E64C8" font-weight="600">Dense Cluster</text>
<text x="285" y="225" text-anchor="middle" font-size="11" fill="#2E7D32" font-weight="600">Curved Cluster</text>
<text x="195" y="285" text-anchor="middle" font-size="11" fill="#E65100" font-weight="600">Small Cluster</text>

<!-- Legend -->
<rect x="50" y="310" width="300" height="60" fill="#f8f8f8" rx="5" stroke="#ddd"/>
<circle cx="80" cy="330" r="6" fill="#4A90E2"/>
<text x="92" y="334" font-size="11" fill="#333">Core/Border Points</text>

<g transform="translate(220, 330)">
<line x1="-4" y1="-4" x2="4" y2="4" stroke="#E53935" stroke-width="2.5"/>
<line x1="-4" y1="4" x2="4" y2="-4" stroke="#E53935" stroke-width="2.5"/>
</g>
<text x="232" y="334" font-size="11" fill="#333">Noise/Outliers</text>

<circle cx="80" cy="350" r="25" fill="none" stroke="#999" stroke-width="1" stroke-dasharray="2,2"/>
<text x="92" y="354" font-size="11" fill="#333">ε neighborhood</text>
<text x="200" y="354" text-anchor="middle" font-size="10" fill="#666" font-style="italic">Density-based grouping</text>
</svg>
</div>
</div>
</div>

<!-- Detailed Section 4: Consensus Clustering -->
<div class="detailed-section">
<div class="section-title">4. Consensus Clustering</div>
<div class="section-content">
<div class="text-content">
<div class="description">
Consensus clustering improves clustering stability and reliability by running multiple clustering iterations with resampled data, then combining results through voting. It provides confidence measures for cluster assignments.
</div>

<div class="algorithm-steps">
<div class="subsection-title">Algorithm Steps:</div>
<div class="step">1. Resample data multiple times (e.g., 1000 runs)</div>
<div class="step">2. Apply base clustering algorithm (e.g., K-means) to each sample</div>
<div class="step">3. Record co-clustering frequency for all pairs</div>
<div class="step">4. Build consensus matrix from frequencies</div>
<div class="step">5. Apply final clustering to consensus matrix</div>
</div>

<div class="key-points">
<div class="subsection-title">Key Characteristics:</div>
<div class="key-point">Meta-clustering approach (combines multiple runs)</div>
<div class="key-point">Provides stability assessment via consensus matrix</div>
<div class="key-point">Helps determine optimal number of clusters</div>
<div class="key-point">Reduces sensitivity to initialization and sampling</div>
<div class="key-point">Can use any base clustering algorithm</div>
</div>

<div class="key-points">
<div class="subsection-title">Consensus Matrix:</div>
<div class="key-point">Entry (i,j) = proportion of runs where i and j are in same cluster</div>
<div class="key-point">Values near 1: strong evidence of co-clustering</div>
<div class="key-point">Values near 0: strong evidence of separation</div>
<div class="key-point">Intermediate values: uncertain assignments</div>
</div>

<div class="pros-cons">
<div class="pros">
<div class="pros-title">✓ Advantages</div>
<div class="key-point">More robust and stable results</div>
<div class="key-point">Provides confidence measures</div>
<div class="key-point">Helps determine optimal K</div>
<div class="key-point">Reduces algorithm bias</div>
</div>
<div class="cons">
<div class="cons-title">✗ Limitations</div>
<div class="key-point">Computationally intensive</div>
<div class="key-point">Requires many iterations</div>
<div class="key-point">More complex to implement</div>
</div>
</div>

<div class="subsection-title" style="margin-top:20px;">Clinical Example:</div>
<div class="description">
Identifying stable molecular subtypes in heterogeneous cancers (e.g., glioblastoma) where robust classification is critical for treatment decisions and prognosis prediction.
</div>
</div>

<div class="visual-content">
<svg class="cluster-viz" viewBox="0 0 400 400" xmlns="http://www.w3.org/2000/svg">
<!-- Title -->
<text x="200" y="25" text-anchor="middle" font-size="18" font-weight="bold" fill="#1E64C8">Consensus Clustering Process</text>

<!-- Step 1: Multiple runs -->
<rect x="30" y="50" width="340" height="80" fill="#f0f8ff" stroke="#1E64C8" stroke-width="2" rx="5"/>
<text x="200" y="70" text-anchor="middle" font-size="13" font-weight="600" fill="#333">Step 1: Multiple Clustering Runs</text>

<rect x="45" y="80" width="90" height="35" fill="white" stroke="#4A90E2" stroke-width="1.5" rx="3"/>
<text x="90" y="95" text-anchor="middle" font-size="10" fill="#333">Run 1</text>
<text x="90" y="108" text-anchor="middle" font-size="9" fill="#666">K-means</text>

<rect x="155" y="80" width="90" height="35" fill="white" stroke="#4A90E2" stroke-width="1.5" rx="3"/>
<text x="200" y="95" text-anchor="middle" font-size="10" fill="#333">Run 2</text>
<text x="200" y="108" text-anchor="middle" font-size="9" fill="#666">K-means</text>

<rect x="265" y="80" width="90" height="35" fill="white" stroke="#4A90E2" stroke-width="1.5" rx="3"/>
<text x="310" y="95" text-anchor="middle" font-size="10" fill="#333">Run N</text>
<text x="310" y="108" text-anchor="middle" font-size="9" fill="#666">K-means</text>

<text x="245" y="100" text-anchor="middle" font-size="12" fill="#666">...</text>

<!-- Arrow -->
<path d="M 200 135 L 200 155" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

<!-- Step 2: Consensus Matrix -->
<rect x="30" y="160" width="160" height="180" fill="#f0f8ff" stroke="#1E64C8" stroke-width="2" rx="5"/>
<text x="110" y="180" text-anchor="middle" font-size="13" font-weight="600" fill="#333">Consensus Matrix</text>

<!-- Matrix visualization -->
<defs>
<linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
<stop offset="0%" style="stop-color:#0d47a1;stop-opacity:1" />
<stop offset="100%" style="stop-color:#ffffff;stop-opacity:1" />
</linearGradient>
</defs>

<!-- Matrix cells - 8x8 grid -->
<g transform="translate(45, 195)">
<!-- Cluster 1 (patients 1-3) - high consensus -->
<rect x="0" y="0" width="15" height="15" fill="#0d47a1"/>
<rect x="15" y="0" width="15" height="15" fill="#1565c0"/>
<rect x="30" y="0" width="15" height="15" fill="#1976d2"/>
<rect x="0" y="15" width="15" height="15" fill="#1565c0"/>
<rect x="15" y="15" width="15" height="15" fill="#0d47a1"/>
<rect x="30" y="15" width="15" height="15" fill="#1565c0"/>
<rect x="0" y="30" width="15" height="15" fill="#1976d2"/>
<rect x="15" y="30" width="15" height="15" fill="#1565c0"/>
<rect x="30" y="30" width="15" height="15" fill="#0d47a1"/>

<!-- Cluster 2 (patients 4-6) - high consensus -->
<rect x="60" y="60" width="15" height="15" fill="#0d47a1"/>
<rect x="75" y="60" width="15" height="15" fill="#1565c0"/>
<rect x="90" y="60" width="15" height="15" fill="#1976d2"/>
<rect x="60" y="75" width="15" height="15" fill="#1565c0"/>
<rect x="75" y="75" width="15" height="15" fill="#0d47a1"/>
<rect x="90" y="75" width="15" height="15" fill="#1565c0"/>
<rect x="60" y="90" width="15" height="15" fill="#1976d2"/>
<rect x="75" y="90" width="15" height="15" fill="#1565c0"/>
<rect x="90" y="90" width="15" height="15" fill="#0d47a1"/>

<!-- Uncertain region (patient 7-8) -->
<rect x="105" y="105" width="15" height="15" fill="#90caf9"/>
<rect x="120" y="105" width="15" height="15" fill="#bbdefb"/>
<rect x="105" y="120" width="15" height="15" fill="#bbdefb"/>
<rect x="120" y="120" width="15" height="15" fill="#90caf9"/>

<!-- Low consensus between clusters -->
<rect x="0" y="60" width="45" height="45" fill="#e3f2fd"/>
<rect x="60" y="0" width="45" height="45" fill="#e3f2fd"/>
<rect x="0" y="105" width="45" height="30" fill="#e3f2fd"/>
<rect x="60" y="105" width="45" height="30" fill="#e3f2fd"/>
<rect x="105" y="0" width="30" height="105" fill="#e3f2fd"/>
</g>

<text x="110" y="330" text-anchor="middle" font-size="9" fill="#666">Patients/Samples</text>

<!-- Color scale legend -->
<rect x="50" y="310" width="10" height="10" fill="#0d47a1"/>
<text x="65" y="319" font-size="9" fill="#333">1.0 (Always together)</text>
<rect x="50" y="322" width="10" height="10" fill="#e3f2fd"/>
<text x="65" y="331" font-size="9" fill="#333">0.0 (Never together)</text>

<!-- Arrow -->
<path d="M 195 250 L 215 250" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>

<!-- Step 3: Final clusters -->
<rect x="220" y="160" width="150" height="180" fill="#f0f8ff" stroke="#1E64C8" stroke-width="2" rx="5"/>
<text x="295" y="180" text-anchor="middle" font-size="13" font-weight="600" fill="#333">Final Stable Clusters</text>

<!-- Cluster visualization -->
<circle cx="260" cy="220" r="8" fill="#4A90E2"/>
<circle cx="275" cy="210" r="8" fill="#4A90E2"/>
<circle cx="280" cy="230" r="8" fill="#4A90E2"/>
<text x="270" y="255" text-anchor="middle" font-size="11" fill="#1E64C8" font-weight="600">Cluster 1</text>
<text x="270" y="268" text-anchor="middle" font-size="9" fill="#666">(High confidence)</text>

<circle cx="310" cy="220" r="8" fill="#50C878"/>
<circle cx="325" cy="210" r="8" fill="#50C878"/>
<circle cx="330" cy="230" r="8" fill="#50C878"/>
<text x="320" y="255" text-anchor="middle" font-size="11" fill="#2E7D32" font-weight="600">Cluster 2</text>
<text x="320" y="268" text-anchor="middle" font-size="9" fill="#666">(High confidence)</text>

<circle cx="295" cy="295" r="7" fill="#FFD700" opacity="0.6"/>
<circle cx="295" cy="310" r="7" fill="#FFD700" opacity="0.6"/>
<text x="295" y="330" text-anchor="middle" font-size="10" fill="#F57C00">Uncertain</text>

<!-- Arrow definition -->
<defs>
<marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
<polygon points="0 0, 10 3, 0 6" fill="#333"/>
</marker>
</defs>

<!-- Bottom note -->
<text x="200" y="375" text-anchor="middle" font-size="10" fill="#666" font-style="italic">Stability across multiple runs increases confidence</text>
<text x="200" y="392" text-anchor="middle" font-size="9" fill="#999">Typical: 100-1000 iterations with 80% resampling</text>
</svg>
</div>
</div>
</div>

<!-- Summary Comparison Table -->
<div style="margin-top:40px;padding:30px;background:#f0f8ff;border-radius:12px;border:2px solid #1E64C8;">
<div style="font-size:28px;font-weight:700;color:#1E64C8;margin-bottom:25px;text-align:center;">Method Comparison Summary</div>
<table style="width:100%;border-collapse:collapse;background:white;border-radius:8px;overflow:hidden;">
<thead>
<tr style="background:#1E64C8;color:white;">
<th style="padding:15px;text-align:left;font-size:14px;">Method</th>
<th style="padding:15px;text-align:center;font-size:14px;">Pre-specify K?</th>
<th style="padding:15px;text-align:center;font-size:14px;">Scalability</th>
<th style="padding:15px;text-align:center;font-size:14px;">Cluster Shape</th>
<th style="padding:15px;text-align:left;font-size:14px;">Best For</th>
</tr>
</thead>
<tbody>
<tr style="border-bottom:1px solid #e0e0e0;">
<td style="padding:12px;font-weight:600;color:#1E64C8;">K-means</td>
<td style="padding:12px;text-align:center;">✓ Yes</td>
<td style="padding:12px;text-align:center;">⭐⭐⭐ High</td>
<td style="padding:12px;text-align:center;">Spherical</td>
<td style="padding:12px;">Large datasets, well-separated groups</td>
</tr>
<tr style="border-bottom:1px solid #e0e0e0;background:#fafafa;">
<td style="padding:12px;font-weight:600;color:#1E64C8;">Hierarchical</td>
<td style="padding:12px;text-align:center;">✗ No</td>
<td style="padding:12px;text-align:center;">⭐ Low</td>
<td style="padding:12px;text-align:center;">Any</td>
<td style="padding:12px;">Visualization, small-medium datasets</td>
</tr>
<tr style="border-bottom:1px solid #e0e0e0;">
<td style="padding:12px;font-weight:600;color:#1E64C8;">DBSCAN</td>
<td style="padding:12px;text-align:center;">✗ No</td>
<td style="padding:12px;text-align:center;">⭐⭐ Medium</td>
<td style="padding:12px;text-align:center;">Arbitrary</td>
<td style="padding:12px;">Outlier detection, irregular shapes</td>
</tr>
<tr style="background:#fafafa;">
<td style="padding:12px;font-weight:600;color:#1E64C8;">Consensus</td>
<td style="padding:12px;text-align:center;">✓ Yes</td>
<td style="padding:12px;text-align:center;">⭐ Low</td>
<td style="padding:12px;text-align:center;">Depends on base</td>
<td style="padding:12px;">Stability, critical decisions</td>
</tr>
</tbody>
</table>
</div>

</div>
</body>
</html>