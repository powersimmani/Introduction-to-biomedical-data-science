<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integration Methods - Detailed</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .title {
            font-size: 32px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 30px;
            text-align: center;
            border-bottom: 3px solid #1E64C8;
            padding-bottom: 15px;
        }
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 20px;
        }
        .content-card {
            background: white;
            border: 2.5px solid #1E64C8;
            border-radius: 10px;
            padding: 16px;
            transition: all 0.3s;
        }
        .content-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(30, 100, 200, 0.2);
            background: #f8fbff;
        }
        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 8px;
        }
        .card-desc {
            font-size: 15px;
            color: #333;
            line-height: 1.4;
        }
        .note-box {
            background: #f0f5fc;
            border-left: 4px solid #1E64C8;
            border-radius: 6px;
            padding: 12px 18px;
            margin-top: 15px;
            margin-bottom: 30px;
        }
        .note-text {
            font-size: 16px;
            color: #333;
            font-weight: 600;
        }
        .visual-section {
            margin-top: 20px;
            text-align: center;
            margin-bottom: 40px;
        }
        
        /* Detailed sections */
        .detailed-section {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 3px solid #e0e0e0;
        }
        .section-header {
            font-size: 24px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 25px;
            padding-left: 15px;
            border-left: 5px solid #1E64C8;
        }
        .method-detail {
            background: #fafafa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 35px;
            border: 2px solid #e0e0e0;
        }
        .method-title {
            font-size: 22px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        .method-number {
            background: #1E64C8;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 18px;
            font-weight: 700;
        }
        .method-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 20px;
        }
        .method-description {
            padding: 20px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #1E64C8;
        }
        .method-description h4 {
            color: #1E64C8;
            font-size: 16px;
            margin-bottom: 12px;
            font-weight: 700;
        }
        .method-description p {
            color: #555;
            line-height: 1.7;
            margin-bottom: 10px;
            font-size: 14px;
        }
        .method-description ul {
            margin-left: 20px;
            color: #555;
            line-height: 1.8;
        }
        .method-description li {
            margin-bottom: 6px;
            font-size: 14px;
        }
        .method-visual {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
        }
        .key-points {
            background: #E3F2FD;
            padding: 15px 20px;
            border-radius: 8px;
            margin-top: 15px;
        }
        .key-points h4 {
            color: #1565C0;
            font-size: 15px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        .key-points ul {
            margin-left: 20px;
            color: #333;
        }
        .key-points li {
            margin-bottom: 5px;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">Integration Methods for Single-Cell Analysis</div>
        
        <div class="content-grid">
            <div class="content-card">
                <div class="card-title">Anchor-based Methods</div>
                <div class="card-desc">Seurat, LIGER find correspondence between datasets</div>
            </div>
            <div class="content-card">
                <div class="card-title">Deep Learning Approaches</div>
                <div class="card-desc">scVI, scGAN learn shared latent space</div>
            </div>
            <div class="content-card">
                <div class="card-title">Reference Building</div>
                <div class="card-desc">Create comprehensive cell atlases</div>
            </div>
            <div class="content-card">
                <div class="card-title">Query Mapping</div>
                <div class="card-desc">Project new data onto reference</div>
            </div>
            <div class="content-card">
                <div class="card-title">Performance Metrics</div>
                <div class="card-desc">Biological conservation vs batch mixing</div>
            </div>
        </div>
        
        <div class="note-box">
            <div class="note-text">üí° Integration enables meta-analysis and transfer learning</div>
        </div>
        
        <div class="visual-section">
            <svg width="860" height="110" viewBox="0 0 860 110" xmlns="http://www.w3.org/2000/svg">
                <!-- Multiple datasets -->
                <g id="dataset1">
                    <rect x="10" y="10" width="100" height="35" rx="5" fill="#FFCDD2" stroke="#D32F2F" stroke-width="2"/>
                    <text x="60" y="25" font-family="Aptos, sans-serif" font-size="11" font-weight="600" fill="#B71C1C" text-anchor="middle">Dataset 1</text>
                    <text x="60" y="38" font-family="Aptos, sans-serif" font-size="8" fill="#666" text-anchor="middle">10X, Brain</text>
                </g>
                
                <g id="dataset2">
                    <rect x="10" y="50" width="100" height="35" rx="5" fill="#C5E1A5" stroke="#7CB342" stroke-width="2"/>
                    <text x="60" y="65" font-family="Aptos, sans-serif" font-size="11" font-weight="600" fill="#558B2F" text-anchor="middle">Dataset 2</text>
                    <text x="60" y="78" font-family="Aptos, sans-serif" font-size="8" fill="#666" text-anchor="middle">Smart-seq, Brain</text>
                </g>
                
                <g id="dataset3">
                    <rect x="10" y="90" width="100" height="15" rx="3" fill="#BBDEFB" stroke="#1976D2" stroke-width="2"/>
                    <text x="60" y="100" font-family="Aptos, sans-serif" font-size="9" font-weight="600" fill="#0D47A1" text-anchor="middle">Dataset 3...</text>
                </g>
                
                <!-- Arrows to integration -->
                <path d="M 115 27 L 155 50" stroke="#1E64C8" stroke-width="2.5" fill="none"/>
                <path d="M 115 67 L 155 55" stroke="#1E64C8" stroke-width="2.5" fill="none"/>
                <path d="M 115 97 L 155 60" stroke="#1E64C8" stroke-width="2.5" fill="none"/>
                
                <!-- Integration methods -->
                <g id="integration">
                    <rect x="160" y="10" width="180" height="95" rx="6" fill="#E3F2FD" stroke="#1E64C8" stroke-width="2"/>
                    <text x="250" y="25" font-family="Aptos, sans-serif" font-size="12" font-weight="700" fill="#1E64C8" text-anchor="middle">Integration Layer</text>
                    
                    <!-- Method boxes -->
                    <rect x="170" y="35" width="70" height="25" rx="4" fill="#2196F3" opacity="0.8"/>
                    <text x="205" y="50" font-family="Aptos, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Seurat</text>
                    
                    <rect x="250" y="35" width="70" height="25" rx="4" fill="#FF9800" opacity="0.8"/>
                    <text x="285" y="50" font-family="Aptos, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">Harmony</text>
                    
                    <rect x="170" y="65" width="70" height="25" rx="4" fill="#4CAF50" opacity="0.8"/>
                    <text x="205" y="80" font-family="Aptos, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">LIGER</text>
                    
                    <rect x="250" y="65" width="70" height="25" rx="4" fill="#9C27B0" opacity="0.8"/>
                    <text x="285" y="80" font-family="Aptos, sans-serif" font-size="10" font-weight="600" fill="white" text-anchor="middle">scVI</text>
                </g>
                
                <!-- Arrow to integrated space -->
                <path d="M 345 52 L 385 52" stroke="#1E64C8" stroke-width="4" fill="none"/>
                <polygon points="385,52 375,47 375,57" fill="#1E64C8"/>
                
                <!-- Integrated space -->
                <g id="integrated">
                    <rect x="390" y="10" width="200" height="95" rx="6" fill="#E8F5E9" stroke="#2E7D32" stroke-width="2"/>
                    <text x="490" y="25" font-family="Aptos, sans-serif" font-size="12" font-weight="700" fill="#1B5E20" text-anchor="middle">Integrated Space</text>
                    
                    <!-- Coordinate system with mixed cells -->
                    <line x1="410" y1="90" x2="570" y2="90" stroke="#999" stroke-width="1.5"/>
                    <line x1="410" y1="90" x2="410" y2="40" stroke="#999" stroke-width="1.5"/>
                    
                    <!-- Mixed cells from different datasets -->
                    <circle cx="440" cy="65" r="3.5" fill="#D32F2F" opacity="0.7"/>
                    <circle cx="450" cy="70" r="3.5" fill="#7CB342" opacity="0.7"/>
                    <circle cx="445" cy="75" r="3.5" fill="#1976D2" opacity="0.7"/>
                    <circle cx="460" cy="60" r="3.5" fill="#D32F2F" opacity="0.7"/>
                    <circle cx="470" cy="68" r="3.5" fill="#7CB342" opacity="0.7"/>
                    <circle cx="465" cy="73" r="3.5" fill="#D32F2F" opacity="0.7"/>
                    <circle cx="480" cy="55" r="3.5" fill="#1976D2" opacity="0.7"/>
                    <circle cx="490" cy="63" r="3.5" fill="#7CB342" opacity="0.7"/>
                    <circle cx="485" cy="70" r="3.5" fill="#D32F2F" opacity="0.7"/>
                    <circle cx="500" cy="58" r="3.5" fill="#1976D2" opacity="0.7"/>
                    <circle cx="510" cy="65" r="3.5" fill="#7CB342" opacity="0.7"/>
                    <circle cx="505" cy="72" r="3.5" fill="#D32F2F" opacity="0.7"/>
                    <circle cx="520" cy="60" r="3.5" fill="#1976D2" opacity="0.7"/>
                    <circle cx="530" cy="68" r="3.5" fill="#7CB342" opacity="0.7"/>
                    <circle cx="540" cy="63" r="3.5" fill="#D32F2F" opacity="0.7"/>
                    
                    <text x="490" y="35" font-family="Aptos, sans-serif" font-size="9" fill="#2E7D32" text-anchor="middle">Shared cell types identified</text>
                </g>
                
                <!-- Applications -->
                <g id="applications">
                    <rect x="600" y="10" width="250" height="95" rx="6" fill="#FFF3E0" stroke="#F57C00" stroke-width="2"/>
                    <text x="725" y="25" font-family="Aptos, sans-serif" font-size="12" font-weight="700" fill="#E65100" text-anchor="middle">Applications</text>
                    
                    <!-- Use case 1 -->
                    <rect x="610" y="32" width="230" height="15" rx="3" fill="#FFCCBC"/>
                    <text x="620" y="42" font-family="Aptos, sans-serif" font-size="9" font-weight="600" fill="#333">1. Build Reference Atlas</text>
                    
                    <!-- Use case 2 -->
                    <rect x="610" y="50" width="230" height="15" rx="3" fill="#FFCCBC"/>
                    <text x="620" y="60" font-family="Aptos, sans-serif" font-size="9" font-weight="600" fill="#333">2. Transfer Labels (Query ‚Üí Reference)</text>
                    
                    <!-- Use case 3 -->
                    <rect x="610" y="68" width="230" height="15" rx="3" fill="#FFCCBC"/>
                    <text x="620" y="78" font-family="Aptos, sans-serif" font-size="9" font-weight="600" fill="#333">3. Cross-study Meta-analysis</text>
                    
                    <!-- Use case 4 -->
                    <rect x="610" y="86" width="230" height="15" rx="3" fill="#FFCCBC"/>
                    <text x="620" y="96" font-family="Aptos, sans-serif" font-size="9" font-weight="600" fill="#333">4. Multi-modal Integration</text>
                </g>
            </svg>
        </div>

        <!-- Detailed Sections -->
        <div class="detailed-section">
            <div class="section-header">Detailed Method Descriptions</div>

            <!-- Method 1: Anchor-based Methods -->
            <div class="method-detail">
                <div class="method-title">
                    <span class="method-number">1</span>
                    Anchor-based Methods
                </div>
                <div class="method-content">
                    <div class="method-description">
                        <h4>Overview</h4>
                        <p>Anchor-based methods identify mutual nearest neighbors (MNNs) or "anchors" between datasets to align cells across different batches or technologies. These anchors serve as reference points for integration.</p>
                        
                        <h4>Key Algorithms</h4>
                        <ul>
                            <li><strong>Seurat v3/v4:</strong> Uses canonical correlation analysis (CCA) to find shared correlation structures, then identifies anchors via mutual nearest neighbors</li>
                            <li><strong>LIGER:</strong> Uses integrative non-negative matrix factorization (iNMF) to discover shared and dataset-specific factors</li>
                            <li><strong>Harmony:</strong> Iteratively clusters cells and corrects for batch effects using soft k-means clustering</li>
                        </ul>
                        
                        <h4>Advantages</h4>
                        <ul>
                            <li>Computationally efficient for large datasets</li>
                            <li>Preserves biological variation while removing batch effects</li>
                            <li>Well-validated and widely adopted</li>
                        </ul>
                    </div>
                    <div class="method-visual">
                        <svg width="480" height="340" viewBox="0 0 480 340" xmlns="http://www.w3.org/2000/svg">
                            <text x="240" y="20" font-size="14" font-weight="700" fill="#1E64C8" text-anchor="middle">Anchor-based Integration Process</text>
                            
                            <!-- Before Integration -->
                            <text x="120" y="50" font-size="12" font-weight="600" fill="#333" text-anchor="middle">Before Integration</text>
                            <rect x="20" y="60" width="200" height="120" rx="5" fill="#FFF3E0" stroke="#FF9800" stroke-width="2"/>
                            
                            <!-- Dataset 1 cluster -->
                            <ellipse cx="80" cy="100" rx="35" ry="25" fill="#FFCDD2" opacity="0.6" stroke="#D32F2F" stroke-width="2"/>
                            <text x="80" y="105" font-size="10" fill="#B71C1C" text-anchor="middle" font-weight="600">Batch 1</text>
                            
                            <!-- Dataset 2 cluster -->
                            <ellipse cx="160" cy="140" rx="35" ry="25" fill="#C5E1A5" opacity="0.6" stroke="#7CB342" stroke-width="2"/>
                            <text x="160" y="145" font-size="10" fill="#558B2F" text-anchor="middle" font-weight="600">Batch 2</text>
                            
                            <!-- Anchor pairs -->
                            <circle cx="100" cy="110" r="4" fill="#FF6B6B" stroke="#333" stroke-width="1.5"/>
                            <circle cx="140" cy="130" r="4" fill="#4ECDC4" stroke="#333" stroke-width="1.5"/>
                            <line x1="100" y1="110" x2="140" y2="130" stroke="#1E64C8" stroke-width="2" stroke-dasharray="3,3"/>
                            <text x="120" y="115" font-size="8" fill="#1E64C8" font-weight="600">Anchor</text>
                            
                            <!-- Arrow -->
                            <path d="M 230 120 L 250 120" stroke="#1E64C8" stroke-width="3" fill="none"/>
                            <polygon points="250,120 243,116 243,124" fill="#1E64C8"/>
                            
                            <!-- After Integration -->
                            <text x="360" y="50" font-size="12" font-weight="600" fill="#333" text-anchor="middle">After Integration</text>
                            <rect x="260" y="60" width="200" height="120" rx="5" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                            
                            <!-- Integrated cluster -->
                            <ellipse cx="360" cy="120" rx="50" ry="40" fill="#B3E5FC" opacity="0.4" stroke="#0277BD" stroke-width="2"/>
                            
                            <!-- Mixed cells -->
                            <circle cx="340" cy="100" r="3" fill="#D32F2F"/>
                            <circle cx="350" cy="105" r="3" fill="#7CB342"/>
                            <circle cx="345" cy="115" r="3" fill="#D32F2F"/>
                            <circle cx="360" cy="110" r="3" fill="#7CB342"/>
                            <circle cx="355" cy="125" r="3" fill="#D32F2F"/>
                            <circle cx="370" cy="120" r="3" fill="#7CB342"/>
                            <circle cx="365" cy="130" r="3" fill="#D32F2F"/>
                            <circle cx="380" cy="115" r="3" fill="#7CB342"/>
                            <circle cx="375" cy="135" r="3" fill="#D32F2F"/>
                            
                            <text x="360" y="170" font-size="9" fill="#2E7D32" text-anchor="middle">Mixed by cell type,</text>
                            <text x="360" y="182" font-size="9" fill="#2E7D32" text-anchor="middle">not by batch</text>
                            
                            <!-- Algorithm steps -->
                            <rect x="20" y="200" width="440" height="130" rx="5" fill="#E3F2FD" stroke="#1E64C8" stroke-width="2"/>
                            <text x="240" y="220" font-size="12" font-weight="700" fill="#1E64C8" text-anchor="middle">Algorithm Steps</text>
                            
                            <text x="30" y="240" font-size="11" font-weight="600" fill="#333">1. Feature Selection</text>
                            <text x="40" y="255" font-size="9" fill="#666">Identify highly variable genes across datasets</text>
                            
                            <text x="30" y="275" font-size="11" font-weight="600" fill="#333">2. Anchor Identification</text>
                            <text x="40" y="290" font-size="9" fill="#666">Find mutual nearest neighbors (MNNs) between datasets</text>
                            
                            <text x="30" y="310" font-size="11" font-weight="600" fill="#333">3. Integration</text>
                            <text x="40" y="325" font-size="9" fill="#666">Use anchors to align and integrate datasets into shared space</text>
                        </svg>
                    </div>
                </div>
                <div class="key-points">
                    <h4>‚≠ê Key Points</h4>
                    <ul>
                        <li>Anchors are pairs of cells from different datasets that represent the same cell type or state</li>
                        <li>MNN approach ensures bidirectional nearest neighbors, reducing false positives</li>
                        <li>Works well when datasets share common cell types but differ in technology or batch</li>
                    </ul>
                </div>
            </div>

            <!-- Method 2: Deep Learning Approaches -->
            <div class="method-detail">
                <div class="method-title">
                    <span class="method-number">2</span>
                    Deep Learning Approaches
                </div>
                <div class="method-content">
                    <div class="method-description">
                        <h4>Overview</h4>
                        <p>Deep learning methods use neural networks to learn a shared latent representation that captures biological variation while removing technical effects. These models can handle complex non-linear relationships.</p>
                        
                        <h4>Key Algorithms</h4>
                        <ul>
                            <li><strong>scVI (Single-Cell Variational Inference):</strong> Uses variational autoencoders (VAE) to model gene expression with explicit batch correction</li>
                            <li><strong>scGAN:</strong> Generative adversarial network that learns batch-invariant representations</li>
                            <li><strong>scANVI:</strong> Semi-supervised version of scVI that incorporates cell type labels</li>
                            <li><strong>SAUCIE:</strong> Autoencoder with explicit regularization for batch effects</li>
                        </ul>
                        
                        <h4>Advantages</h4>
                        <ul>
                            <li>Captures complex non-linear relationships</li>
                            <li>Probabilistic framework provides uncertainty estimates</li>
                            <li>Can incorporate multiple data modalities</li>
                            <li>Scales to millions of cells</li>
                        </ul>
                    </div>
                    <div class="method-visual">
                        <svg width="480" height="340" viewBox="0 0 480 340" xmlns="http://www.w3.org/2000/svg">
                            <text x="240" y="20" font-size="14" font-weight="700" fill="#9C27B0" text-anchor="middle">Variational Autoencoder Architecture</text>
                            
                            <!-- Input layer -->
                            <rect x="20" y="50" width="80" height="200" rx="5" fill="#FFEBEE" stroke="#E91E63" stroke-width="2"/>
                            <text x="60" y="40" font-size="10" font-weight="600" fill="#333" text-anchor="middle">Input</text>
                            <text x="60" y="160" font-size="11" font-weight="600" fill="#C2185B" text-anchor="middle">Gene</text>
                            <text x="60" y="175" font-size="11" font-weight="600" fill="#C2185B" text-anchor="middle">Expression</text>
                            
                            <!-- Cells representation -->
                            <circle cx="60" cy="80" r="4" fill="#D32F2F"/>
                            <circle cx="60" cy="100" r="4" fill="#7CB342"/>
                            <circle cx="60" cy="120" r="4" fill="#1976D2"/>
                            <text x="60" y="205" font-size="8" fill="#666" text-anchor="middle">n cells √ó p genes</text>
                            <text x="60" y="220" font-size="8" fill="#666" text-anchor="middle">+ batch labels</text>
                            
                            <!-- Encoder -->
                            <path d="M 100 150 L 160 120" stroke="#9C27B0" stroke-width="2" fill="none"/>
                            <path d="M 100 150 L 160 140" stroke="#9C27B0" stroke-width="2" fill="none"/>
                            <path d="M 100 150 L 160 160" stroke="#9C27B0" stroke-width="2" fill="none"/>
                            <text x="130" y="130" font-size="9" font-weight="600" fill="#9C27B0" text-anchor="middle">Encoder</text>
                            
                            <!-- Latent space -->
                            <rect x="165" y="80" width="150" height="140" rx="5" fill="#F3E5F5" stroke="#9C27B0" stroke-width="2"/>
                            <text x="240" y="73" font-size="10" font-weight="600" fill="#333" text-anchor="middle">Latent Space</text>
                            
                            <!-- Latent representation -->
                            <ellipse cx="200" cy="130" rx="20" ry="15" fill="#E1BEE7" opacity="0.6" stroke="#7B1FA2" stroke-width="1.5"/>
                            <ellipse cx="240" cy="150" rx="25" ry="18" fill="#CE93D8" opacity="0.6" stroke="#7B1FA2" stroke-width="1.5"/>
                            <ellipse cx="280" cy="140" rx="22" ry="16" fill="#BA68C8" opacity="0.6" stroke="#7B1FA2" stroke-width="1.5"/>
                            
                            <text x="240" y="190" font-size="9" fill="#7B1FA2" font-weight="600" text-anchor="middle">z ~ N(Œº, œÉ¬≤)</text>
                            <text x="240" y="203" font-size="8" fill="#666" text-anchor="middle">Batch-corrected</text>
                            <text x="240" y="215" font-size="8" fill="#666" text-anchor="middle">representation</text>
                            
                            <!-- Decoder -->
                            <path d="M 315 120 L 380 150" stroke="#9C27B0" stroke-width="2" fill="none"/>
                            <path d="M 315 140 L 380 150" stroke="#9C27B0" stroke-width="2" fill="none"/>
                            <path d="M 315 160 L 380 150" stroke="#9C27B0" stroke-width="2" fill="none"/>
                            <text x="348" y="130" font-size="9" font-weight="600" fill="#9C27B0" text-anchor="middle">Decoder</text>
                            
                            <!-- Output layer -->
                            <rect x="380" y="50" width="80" height="200" rx="5" fill="#E8F5E9" stroke="#4CAF50" stroke-width="2"/>
                            <text x="420" y="40" font-size="10" font-weight="600" fill="#333" text-anchor="middle">Output</text>
                            <text x="420" y="160" font-size="11" font-weight="600" fill="#2E7D32" text-anchor="middle">Reconstructed</text>
                            <text x="420" y="175" font-size="11" font-weight="600" fill="#2E7D32" text-anchor="middle">Expression</text>
                            
                            <!-- Output cells -->
                            <circle cx="420" cy="80" r="4" fill="#D32F2F" opacity="0.7"/>
                            <circle cx="420" cy="100" r="4" fill="#7CB342" opacity="0.7"/>
                            <circle cx="420" cy="120" r="4" fill="#1976D2" opacity="0.7"/>
                            
                            <!-- Loss components -->
                            <rect x="20" y="270" width="440" height="60" rx="5" fill="#FFF9C4" stroke="#F57F17" stroke-width="2"/>
                            <text x="240" y="288" font-size="11" font-weight="700" fill="#F57F17" text-anchor="middle">Loss Function</text>
                            <text x="240" y="305" font-size="9" fill="#666" text-anchor="middle">L = Reconstruction Loss + KL Divergence + Batch Effect Penalty</text>
                            <text x="240" y="320" font-size="8" fill="#666" text-anchor="middle">Balances accurate reconstruction with batch correction and regularization</text>
                        </svg>
                    </div>
                </div>
                <div class="key-points">
                    <h4>‚≠ê Key Points</h4>
                    <ul>
                        <li>VAE learns a probabilistic latent representation with explicit uncertainty quantification</li>
                        <li>Batch information is provided as input but removed from latent space through adversarial training or regularization</li>
                        <li>Can impute missing values and denoise expression data as part of the integration process</li>
                        <li>Requires GPU acceleration for large datasets but provides state-of-the-art performance</li>
                    </ul>
                </div>
            </div>

            <!-- Method 3: Reference Building -->
            <div class="method-detail">
                <div class="method-title">
                    <span class="method-number">3</span>
                    Reference Building
                </div>
                <div class="method-content">
                    <div class="method-description">
                        <h4>Overview</h4>
                        <p>Reference building involves creating comprehensive cell atlases by integrating multiple high-quality datasets. These references serve as standardized maps of cell types and states for a given tissue or organism.</p>
                        
                        <h4>Construction Process</h4>
                        <ul>
                            <li><strong>Data Collection:</strong> Aggregate datasets from multiple sources, technologies, and conditions</li>
                            <li><strong>Quality Control:</strong> Rigorous filtering and validation of cells and annotations</li>
                            <li><strong>Integration:</strong> Harmonize datasets while preserving biological heterogeneity</li>
                            <li><strong>Annotation:</strong> Comprehensive cell type labeling by expert curators</li>
                            <li><strong>Validation:</strong> Cross-validation and benchmarking against known markers</li>
                        </ul>
                        
                        <h4>Major Reference Atlases</h4>
                        <ul>
                            <li><strong>Human Cell Atlas (HCA):</strong> Comprehensive map of human cells</li>
                            <li><strong>Tabula Sapiens:</strong> Reference for human organ systems</li>
                            <li><strong>Mouse Cell Atlas:</strong> Complete mouse cell type map</li>
                        </ul>
                    </div>
                    <div class="method-visual">
                        <svg width="480" height="340" viewBox="0 0 480 340" xmlns="http://www.w3.org/2000/svg">
                            <text x="240" y="20" font-size="14" font-weight="700" fill="#F57C00" text-anchor="middle">Reference Atlas Construction Pipeline</text>
                            
                            <!-- Step 1: Data Collection -->
                            <rect x="20" y="40" width="440" height="50" rx="5" fill="#FFEBEE" stroke="#E53935" stroke-width="2"/>
                            <text x="240" y="60" font-size="11" font-weight="700" fill="#C62828" text-anchor="middle">Step 1: Data Collection</text>
                            
                            <rect x="30" y="68" width="70" height="15" rx="3" fill="#FFCDD2"/>
                            <text x="65" y="78" font-size="8" fill="#333" text-anchor="middle">Study A (10X)</text>
                            
                            <rect x="110" y="68" width="70" height="15" rx="3" fill="#FFCDD2"/>
                            <text x="145" y="78" font-size="8" fill="#333" text-anchor="middle">Study B (SS2)</text>
                            
                            <rect x="190" y="68" width="70" height="15" rx="3" fill="#FFCDD2"/>
                            <text x="225" y="78" font-size="8" fill="#333" text-anchor="middle">Study C (10X)</text>
                            
                            <rect x="270" y="68" width="70" height="15" rx="3" fill="#FFCDD2"/>
                            <text x="305" y="78" font-size="8" fill="#333" text-anchor="middle">Study D (Seq)</text>
                            
                            <rect x="350" y="68" width="100" height="15" rx="3" fill="#FFCDD2"/>
                            <text x="400" y="78" font-size="8" fill="#333" text-anchor="middle">+ more datasets...</text>
                            
                            <!-- Arrow -->
                            <path d="M 240 95 L 240 105" stroke="#F57C00" stroke-width="3" fill="none"/>
                            <polygon points="240,105 236,98 244,98" fill="#F57C00"/>
                            
                            <!-- Step 2: Integration -->
                            <rect x="20" y="110" width="440" height="60" rx="5" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
                            <text x="240" y="130" font-size="11" font-weight="700" fill="#1565C0" text-anchor="middle">Step 2: Integration & Harmonization</text>
                            
                            <circle cx="100" cy="150" r="3" fill="#E53935"/>
                            <circle cx="120" cy="145" r="3" fill="#43A047"/>
                            <circle cx="140" cy="155" r="3" fill="#1E88E5"/>
                            <circle cx="160" cy="148" r="3" fill="#F57C00"/>
                            
                            <circle cx="200" cy="152" r="3" fill="#E53935"/>
                            <circle cx="220" cy="147" r="3" fill="#43A047"/>
                            <circle cx="240" cy="150" r="3" fill="#1E88E5"/>
                            <circle cx="260" cy="153" r="3" fill="#F57C00"/>
                            
                            <circle cx="300" cy="149" r="3" fill="#E53935"/>
                            <circle cx="320" cy="154" r="3" fill="#43A047"/>
                            <circle cx="340" cy="146" r="3" fill="#1E88E5"/>
                            <circle cx="360" cy="151" r="3" fill="#F57C00"/>
                            
                            <text x="240" y="165" font-size="8" fill="#666" text-anchor="middle">Batch correction + Cell type alignment</text>
                            
                            <!-- Arrow -->
                            <path d="M 240 175 L 240 185" stroke="#F57C00" stroke-width="3" fill="none"/>
                            <polygon points="240,185 236,178 244,178" fill="#F57C00"/>
                            
                            <!-- Step 3: Annotation -->
                            <rect x="20" y="190" width="440" height="70" rx="5" fill="#F3E5F5" stroke="#7B1FA2" stroke-width="2"/>
                            <text x="240" y="210" font-size="11" font-weight="700" fill="#6A1B9A" text-anchor="middle">Step 3: Expert Annotation & Validation</text>
                            
                            <!-- Cell type clusters -->
                            <ellipse cx="80" cy="235" rx="20" ry="12" fill="#E1BEE7" stroke="#7B1FA2" stroke-width="1.5"/>
                            <text x="80" y="238" font-size="7" fill="#4A148C" text-anchor="middle" font-weight="600">T cells</text>
                            
                            <ellipse cx="150" cy="235" rx="20" ry="12" fill="#E1BEE7" stroke="#7B1FA2" stroke-width="1.5"/>
                            <text x="150" y="238" font-size="7" fill="#4A148C" text-anchor="middle" font-weight="600">B cells</text>
                            
                            <ellipse cx="220" cy="235" rx="20" ry="12" fill="#E1BEE7" stroke="#7B1FA2" stroke-width="1.5"/>
                            <text x="220" y="238" font-size="7" fill="#4A148C" text-anchor="middle" font-weight="600">NK cells</text>
                            
                            <ellipse cx="290" cy="235" rx="25" ry="12" fill="#E1BEE7" stroke="#7B1FA2" stroke-width="1.5"/>
                            <text x="290" y="238" font-size="7" fill="#4A148C" text-anchor="middle" font-weight="600">Monocytes</text>
                            
                            <ellipse cx="370" cy="235" rx="30" ry="12" fill="#E1BEE7" stroke="#7B1FA2" stroke-width="1.5"/>
                            <text x="370" y="238" font-size="7" fill="#4A148C" text-anchor="middle" font-weight="600">Macrophages</text>
                            
                            <text x="240" y="253" font-size="8" fill="#666" text-anchor="middle">Marker-based + Literature-validated annotations</text>
                            
                            <!-- Arrow -->
                            <path d="M 240 265 L 240 275" stroke="#F57C00" stroke-width="3" fill="none"/>
                            <polygon points="240,275 236,268 244,268" fill="#F57C00"/>
                            
                            <!-- Step 4: Reference Atlas -->
                            <rect x="20" y="280" width="440" height="50" rx="5" fill="#E8F5E9" stroke="#388E3C" stroke-width="2"/>
                            <text x="240" y="300" font-size="12" font-weight="700" fill="#2E7D32" text-anchor="middle">Reference Atlas</text>
                            <text x="240" y="315" font-size="9" fill="#1B5E20" text-anchor="middle">Standardized cell type map</text>
                            <text x="240" y="327" font-size="8" fill="#666" text-anchor="middle">Ready for query mapping and transfer learning</text>
                        </svg>
                    </div>
                </div>
                <div class="key-points">
                    <h4>‚≠ê Key Points</h4>
                    <ul>
                        <li>References require diverse, high-quality datasets spanning multiple conditions and technologies</li>
                        <li>Expert curation ensures accurate and consistent cell type annotations</li>
                        <li>Regular updates incorporate new data and refined annotations</li>
                        <li>Enables standardized analysis and comparison across studies</li>
                    </ul>
                </div>
            </div>

            <!-- Method 4: Query Mapping -->
            <div class="method-detail">
                <div class="method-title">
                    <span class="method-number">4</span>
                    Query Mapping
                </div>
                <div class="method-content">
                    <div class="method-description">
                        <h4>Overview</h4>
                        <p>Query mapping projects new datasets onto existing reference atlases, enabling rapid cell type annotation and comparison without full re-integration. This is a form of transfer learning for single-cell analysis.</p>
                        
                        <h4>Mapping Methods</h4>
                        <ul>
                            <li><strong>Seurat Reference Mapping:</strong> Projects query onto PCA space of reference using supervised anchors</li>
                            <li><strong>Symphony:</strong> Fast reference mapping using harmonized coordinates</li>
                            <li><strong>scArches:</strong> Transfer learning with neural networks, updates model with query data</li>
                            <li><strong>SingleR:</strong> Correlation-based cell type assignment from reference</li>
                        </ul>
                        
                        <h4>Applications</h4>
                        <ul>
                            <li>Rapid annotation of new datasets</li>
                            <li>Cross-study comparisons</li>
                            <li>Disease vs. healthy comparison</li>
                            <li>Time-series or perturbation studies</li>
                        </ul>
                    </div>
                    <div class="method-visual">
                        <svg width="480" height="340" viewBox="0 0 480 340" xmlns="http://www.w3.org/2000/svg">
                            <text x="240" y="20" font-size="14" font-weight="700" fill="#0288D1" text-anchor="middle">Query Mapping Workflow</text>
                            
                            <!-- Reference Atlas -->
                            <rect x="20" y="40" width="180" height="140" rx="5" fill="#E8F5E9" stroke="#388E3C" stroke-width="2"/>
                            <text x="110" y="60" font-size="12" font-weight="700" fill="#2E7D32" text-anchor="middle">Reference Atlas</text>
                            
                            <!-- Reference clusters -->
                            <ellipse cx="70" cy="100" rx="25" ry="18" fill="#81C784" opacity="0.6" stroke="#388E3C" stroke-width="2"/>
                            <text x="70" y="103" font-size="8" fill="#1B5E20" text-anchor="middle" font-weight="600">T cells</text>
                            
                            <ellipse cx="130" cy="90" rx="22" ry="16" fill="#AED581" opacity="0.6" stroke="#689F38" stroke-width="2"/>
                            <text x="130" y="93" font-size="8" fill="#33691E" text-anchor="middle" font-weight="600">B cells</text>
                            
                            <ellipse cx="90" cy="135" rx="20" ry="15" fill="#66BB6A" opacity="0.6" stroke="#388E3C" stroke-width="2"/>
                            <text x="90" y="138" font-size="8" fill="#1B5E20" text-anchor="middle" font-weight="600">NK</text>
                            
                            <ellipse cx="145" cy="135" rx="24" ry="17" fill="#A5D6A7" opacity="0.6" stroke="#66BB6A" stroke-width="2"/>
                            <text x="145" y="138" font-size="8" fill="#2E7D32" text-anchor="middle" font-weight="600">Mono</text>
                            
                            <text x="110" y="165" font-size="8" fill="#666" text-anchor="middle">Well-annotated</text>
                            <text x="110" y="176" font-size="8" fill="#666" text-anchor="middle">Cell types defined</text>
                            
                            <!-- Query Dataset -->
                            <rect x="20" y="200" width="180" height="120" rx="5" fill="#FFF3E0" stroke="#F57C00" stroke-width="2"/>
                            <text x="110" y="220" font-size="12" font-weight="700" fill="#E65100" text-anchor="middle">Query Dataset</text>
                            
                            <!-- Query cells (unlabeled) -->
                            <circle cx="60" cy="255" r="4" fill="#999"/>
                            <circle cx="80" cy="250" r="4" fill="#999"/>
                            <circle cx="100" cy="260" r="4" fill="#999"/>
                            <circle cx="120" cy="255" r="4" fill="#999"/>
                            <circle cx="140" cy="265" r="4" fill="#999"/>
                            <circle cx="160" cy="258" r="4" fill="#999"/>
                            <circle cx="70" cy="275" r="4" fill="#999"/>
                            <circle cx="90" cy="280" r="4" fill="#999"/>
                            <circle cx="110" cy="270" r="4" fill="#999"/>
                            <circle cx="130" cy="285" r="4" fill="#999"/>
                            <circle cx="150" cy="278" r="4" fill="#999"/>
                            
                            <text x="110" y="300" font-size="8" fill="#666" text-anchor="middle">Unknown cell types</text>
                            <text x="110" y="311" font-size="8" fill="#666" text-anchor="middle">Need annotation</text>
                            
                            <!-- Mapping arrow -->
                            <path d="M 210 120 L 260 120" stroke="#0288D1" stroke-width="4" fill="none"/>
                            <polygon points="260,120 250,115 250,125" fill="#0288D1"/>
                            <text x="235" y="112" font-size="10" font-weight="700" fill="#0288D1" text-anchor="middle">Map</text>
                            
                            <!-- Mapped result -->
                            <rect x="270" y="40" width="190" height="280" rx="5" fill="#E1F5FE" stroke="#0288D1" stroke-width="2"/>
                            <text x="365" y="60" font-size="12" font-weight="700" fill="#01579B" text-anchor="middle">Mapped Result</text>
                            
                            <!-- Reference clusters (faded) -->
                            <ellipse cx="320" cy="110" rx="25" ry="18" fill="#81C784" opacity="0.3" stroke="#388E3C" stroke-width="1"/>
                            <text x="320" y="113" font-size="7" fill="#1B5E20" text-anchor="middle">T cells</text>
                            
                            <ellipse cx="385" cy="100" rx="22" ry="16" fill="#AED581" opacity="0.3" stroke="#689F38" stroke-width="1"/>
                            <text x="385" y="103" font-size="7" fill="#33691E" text-anchor="middle">B cells</text>
                            
                            <ellipse cx="340" cy="155" rx="20" ry="15" fill="#66BB6A" opacity="0.3" stroke="#388E3C" stroke-width="1"/>
                            <text x="340" y="158" font-size="7" fill="#1B5E20" text-anchor="middle">NK</text>
                            
                            <ellipse cx="400" cy="155" rx="24" ry="17" fill="#A5D6A7" opacity="0.3" stroke="#66BB6A" stroke-width="1"/>
                            <text x="400" y="158" font-size="7" fill="#2E7D32" text-anchor="middle">Mono</text>
                            
                            <!-- Mapped query cells (now labeled) -->
                            <circle cx="310" cy="105" r="4" fill="#81C784" stroke="#1B5E20" stroke-width="1.5"/>
                            <circle cx="325" cy="115" r="4" fill="#81C784" stroke="#1B5E20" stroke-width="1.5"/>
                            <circle cx="315" cy="120" r="4" fill="#81C784" stroke="#1B5E20" stroke-width="1.5"/>
                            
                            <circle cx="375" cy="95" r="4" fill="#AED581" stroke="#33691E" stroke-width="1.5"/>
                            <circle cx="390" cy="105" r="4" fill="#AED581" stroke="#33691E" stroke-width="1.5"/>
                            <circle cx="380" cy="110" r="4" fill="#AED581" stroke="#33691E" stroke-width="1.5"/>
                            
                            <circle cx="335" cy="150" r="4" fill="#66BB6A" stroke="#1B5E20" stroke-width="1.5"/>
                            <circle cx="345" cy="160" r="4" fill="#66BB6A" stroke="#1B5E20" stroke-width="1.5"/>
                            
                            <circle cx="395" cy="150" r="4" fill="#A5D6A7" stroke="#2E7D32" stroke-width="1.5"/>
                            <circle cx="405" cy="158" r="4" fill="#A5D6A7" stroke="#2E7D32" stroke-width="1.5"/>
                            <circle cx="408" cy="165" r="4" fill="#A5D6A7" stroke="#2E7D32" stroke-width="1.5"/>
                            
                            <text x="365" y="190" font-size="9" fill="#01579B" text-anchor="middle" font-weight="600">Cell types assigned!</text>
                            
                            <!-- Mapping statistics -->
                            <rect x="280" y="205" width="170" height="105" rx="4" fill="#B3E5FC" stroke="#0288D1" stroke-width="1.5"/>
                            <text x="365" y="222" font-size="10" font-weight="700" fill="#01579B" text-anchor="middle">Mapping Statistics</text>
                            
                            <text x="290" y="240" font-size="8" fill="#333" font-weight="600">Predicted Labels:</text>
                            <text x="290" y="253" font-size="8" fill="#555">‚Ä¢ T cells: 35%</text>
                            <text x="290" y="265" font-size="8" fill="#555">‚Ä¢ B cells: 28%</text>
                            <text x="290" y="277" font-size="8" fill="#555">‚Ä¢ NK cells: 18%</text>
                            <text x="290" y="289" font-size="8" fill="#555">‚Ä¢ Monocytes: 19%</text>
                            
                            <text x="290" y="304" font-size="7" fill="#666">Confidence scores provided</text>
                        </svg>
                    </div>
                </div>
                <div class="key-points">
                    <h4>‚≠ê Key Points</h4>
                    <ul>
                        <li>Much faster than full integration (seconds to minutes vs. hours)</li>
                        <li>Provides confidence scores for cell type predictions</li>
                        <li>Works best when query and reference share common cell types</li>
                        <li>Novel cell types in query may be assigned to nearest reference type (limitation)</li>
                        <li>Enables large-scale studies by reusing well-curated references</li>
                    </ul>
                </div>
            </div>

            <!-- Method 5: Performance Metrics -->
            <div class="method-detail">
                <div class="method-title">
                    <span class="method-number">5</span>
                    Performance Metrics
                </div>
                <div class="method-content">
                    <div class="method-description">
                        <h4>Overview</h4>
                        <p>Evaluating integration quality requires balancing two competing objectives: removing technical variation (batch mixing) while preserving biological variation (cell type separation).</p>
                        
                        <h4>Key Metrics</h4>
                        <ul>
                            <li><strong>Batch Mixing Metrics:</strong>
                                <ul>
                                    <li>Batch ASW (Average Silhouette Width): Measures batch separation</li>
                                    <li>kBET (k-nearest neighbor Batch Effect Test): Tests batch mixing</li>
                                    <li>LISI (Local Inverse Simpson's Index): Quantifies local diversity</li>
                                </ul>
                            </li>
                            <li><strong>Bio-conservation Metrics:</strong>
                                <ul>
                                    <li>Cell type ASW: Measures cell type separation</li>
                                    <li>ARI (Adjusted Rand Index): Compares clustering to labels</li>
                                    <li>NMI (Normalized Mutual Information): Information preservation</li>
                                </ul>
                            </li>
                            <li><strong>Trajectory Preservation:</strong> Ensures developmental/temporal relationships maintained</li>
                        </ul>
                        
                        <h4>Benchmarking Studies</h4>
                        <ul>
                            <li>No single method dominates all scenarios</li>
                            <li>Performance depends on dataset characteristics and goals</li>
                        </ul>
                    </div>
                    <div class="method-visual">
                        <svg width="480" height="340" viewBox="0 0 480 340" xmlns="http://www.w3.org/2000/svg">
                            <text x="240" y="20" font-size="14" font-weight="700" fill="#D32F2F" text-anchor="middle">Integration Quality Assessment</text>
                            
                            <!-- Good Integration -->
                            <rect x="20" y="40" width="200" height="140" rx="5" fill="#E8F5E9" stroke="#43A047" stroke-width="3"/>
                            <text x="120" y="60" font-size="12" font-weight="700" fill="#2E7D32" text-anchor="middle">‚úì Good Integration</text>
                            
                            <!-- Cell type clusters with mixed batches -->
                            <ellipse cx="80" cy="105" rx="30" ry="22" fill="#81C784" opacity="0.4" stroke="#388E3C" stroke-width="2"/>
                            <circle cx="70" cy="100" r="3" fill="#D32F2F"/>
                            <circle cx="75" cy="108" r="3" fill="#1976D2"/>
                            <circle cx="85" cy="103" r="3" fill="#D32F2F"/>
                            <circle cx="80" cy="112" r="3" fill="#1976D2"/>
                            <text x="80" y="130" font-size="7" fill="#1B5E20" text-anchor="middle" font-weight="600">Cell Type A</text>
                            
                            <ellipse cx="160" cy="110" rx="28" ry="20" fill="#AED581" opacity="0.4" stroke="#689F38" stroke-width="2"/>
                            <circle cx="155" cy="105" r="3" fill="#D32F2F"/>
                            <circle cx="165" cy="108" r="3" fill="#1976D2"/>
                            <circle cx="160" cy="115" r="3" fill="#D32F2F"/>
                            <circle cx="155" cy="118" r="3" fill="#1976D2"/>
                            <text x="160" y="135" font-size="7" fill="#33691E" text-anchor="middle" font-weight="600">Cell Type B</text>
                            
                            <rect x="30" y="150" width="80" height="20" rx="3" fill="#C8E6C9"/>
                            <text x="70" y="163" font-size="8" fill="#1B5E20" text-anchor="middle" font-weight="600">High Batch Mixing</text>
                            
                            <rect x="120" y="150" width="90" height="20" rx="3" fill="#C8E6C9"/>
                            <text x="165" y="163" font-size="8" fill="#1B5E20" text-anchor="middle" font-weight="600">Cell Types Preserved</text>
                            
                            <!-- Bad Integration: Over-correction -->
                            <rect x="240" y="40" width="220" height="140" rx="5" fill="#FFEBEE" stroke="#E53935" stroke-width="3"/>
                            <text x="350" y="60" font-size="12" font-weight="700" fill="#C62828" text-anchor="middle">‚úó Over-correction</text>
                            
                            <!-- Single mixed cluster -->
                            <ellipse cx="350" cy="110" rx="55" ry="40" fill="#EF9A9A" opacity="0.4" stroke="#D32F2F" stroke-width="2"/>
                            <circle cx="330" cy="100" r="3" fill="#D32F2F"/>
                            <circle cx="340" cy="105" r="3" fill="#1976D2"/>
                            <circle cx="350" cy="95" r="3" fill="#D32F2F"/>
                            <circle cx="360" cy="110" r="3" fill="#1976D2"/>
                            <circle cx="345" cy="120" r="3" fill="#D32F2F"/>
                            <circle cx="355" cy="125" r="3" fill="#1976D2"/>
                            <circle cx="365" cy="115" r="3" fill="#D32F2F"/>
                            <circle cx="340" cy="130" r="3" fill="#1976D2"/>
                            <text x="350" y="145" font-size="7" fill="#B71C1C" text-anchor="middle" font-weight="600">All cells mixed</text>
                            
                            <rect x="250" y="155" width="90" height="20" rx="3" fill="#FFCDD2"/>
                            <text x="295" y="168" font-size="8" fill="#B71C1C" text-anchor="middle" font-weight="600">Lost Biology</text>
                            
                            <rect x="350" y="155" width="100" height="20" rx="3" fill="#FFCDD2"/>
                            <text x="400" y="168" font-size="8" fill="#B71C1C" text-anchor="middle" font-weight="600">No Cell Type Signal</text>
                            
                            <!-- Bad Integration: Under-correction -->
                            <rect x="20" y="195" width="200" height="130" rx="5" fill="#FFEBEE" stroke="#E53935" stroke-width="3"/>
                            <text x="120" y="215" font-size="12" font-weight="700" fill="#C62828" text-anchor="middle">‚úó Under-correction</text>
                            
                            <!-- Separate batch clusters -->
                            <ellipse cx="70" cy="260" rx="25" ry="20" fill="#FFCDD2" opacity="0.6" stroke="#D32F2F" stroke-width="2"/>
                            <circle cx="65" cy="255" r="2.5" fill="#D32F2F"/>
                            <circle cx="72" cy="260" r="2.5" fill="#D32F2F"/>
                            <circle cx="68" cy="265" r="2.5" fill="#D32F2F"/>
                            <text x="70" y="285" font-size="7" fill="#B71C1C" text-anchor="middle" font-weight="600">Batch 1</text>
                            
                            <ellipse cx="150" cy="260" rx="25" ry="20" fill="#BBDEFB" opacity="0.6" stroke="#1976D2" stroke-width="2"/>
                            <circle cx="145" cy="255" r="2.5" fill="#1976D2"/>
                            <circle cx="152" cy="260" r="2.5" fill="#1976D2"/>
                            <circle cx="148" cy="265" r="2.5" fill="#1976D2"/>
                            <text x="150" y="285" font-size="7" fill="#0D47A1" text-anchor="middle" font-weight="600">Batch 2</text>
                            
                            <rect x="30" y="295" width="80" height="20" rx="3" fill="#FFCDD2"/>
                            <text x="70" y="308" font-size="8" fill="#B71C1C" text-anchor="middle" font-weight="600">Batch Separated</text>
                            
                            <rect x="120" y="295" width="90" height="20" rx="3" fill="#FFCDD2"/>
                            <text x="165" y="308" font-size="8" fill="#B71C1C" text-anchor="middle" font-weight="600">Technical Variation</text>
                            
                            <!-- Metrics Panel -->
                            <rect x="240" y="195" width="220" height="130" rx="5" fill="#E3F2FD" stroke="#1976D2" stroke-width="2"/>
                            <text x="350" y="215" font-size="12" font-weight="700" fill="#1565C0" text-anchor="middle">Evaluation Metrics</text>
                            
                            <text x="250" y="235" font-size="9" font-weight="600" fill="#0D47A1">Batch Correction:</text>
                            <text x="260" y="250" font-size="8" fill="#333">‚Ä¢ Batch ASW ‚Üì (lower = better mixing)</text>
                            <text x="260" y="263" font-size="8" fill="#333">‚Ä¢ kBET acceptance rate ‚Üë</text>
                            <text x="260" y="276" font-size="8" fill="#333">‚Ä¢ iLISI ‚Üë (integration LISI)</text>
                            
                            <text x="250" y="295" font-size="9" font-weight="600" fill="#0D47A1">Bio-conservation:</text>
                            <text x="260" y="310" font-size="8" fill="#333">‚Ä¢ Cell type ASW ‚Üë (higher = better)</text>
                            <text x="260" y="323" font-size="8" fill="#333">‚Ä¢ cLISI ‚Üë (cell type LISI)</text>
                            
                            <!-- Legend -->
                            <circle cx="25" cy="340" r="4" fill="#D32F2F"/>
                            <text x="35" y="343" font-size="8" fill="#333">Batch 1</text>
                            
                            <circle cx="85" cy="340" r="4" fill="#1976D2"/>
                            <text x="95" y="343" font-size="8" fill="#333">Batch 2</text>
                        </svg>
                    </div>
                </div>
                <div class="key-points">
                    <h4>‚≠ê Key Points</h4>
                    <ul>
                        <li>Integration is a balancing act: remove batch effects without losing biology</li>
                        <li>Multiple metrics needed to assess both batch mixing and bio-conservation</li>
                        <li>Over-correction merges distinct cell types; under-correction leaves technical variation</li>
                        <li>Optimal method depends on dataset characteristics (number of batches, cell types, technologies)</li>
                        <li>Visual inspection (UMAP plots) combined with quantitative metrics provides best assessment</li>
                    </ul>
                </div>
            </div>

        </div>
    </div>
</body>
</html>