<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RNA Velocity - Comprehensive Guide</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: #f8f9fa;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .title {
            font-size: 36px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 4px solid #1E64C8;
            padding-bottom: 15px;
        }
        .subtitle {
            font-size: 18px;
            color: #666;
            text-align: center;
            margin-bottom: 40px;
        }
        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .content-card {
            background: white;
            border: 2.5px solid #1E64C8;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }
        .content-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(30, 100, 200, 0.25);
            background: #f8fbff;
        }
        .card-title {
            font-size: 20px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 10px;
        }
        .card-desc {
            font-size: 15px;
            color: #333;
            line-height: 1.5;
        }
        .note-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
            color: white;
        }
        .note-text {
            font-size: 18px;
            font-weight: 600;
            text-align: center;
        }
        .visual-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .section-divider {
            margin: 50px 0;
            border-top: 3px solid #1E64C8;
        }
        .detailed-section {
            margin: 40px 0;
            padding: 30px;
            background: white;
            border-left: 5px solid #1E64C8;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        .section-title {
            font-size: 28px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        .section-number {
            background: #1E64C8;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 20px;
            font-weight: 700;
        }
        .section-content {
            font-size: 16px;
            color: #333;
            line-height: 1.8;
            margin-bottom: 20px;
        }
        .key-points {
            background: #f0f5fc;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .key-points-title {
            font-size: 18px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 12px;
        }
        .key-points ul {
            list-style: none;
            padding-left: 0;
        }
        .key-points li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: #333;
            line-height: 1.6;
        }
        .key-points li:before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: #1E64C8;
            font-weight: 700;
        }
        .formula-box {
            background: #fff;
            border: 2px solid #1E64C8;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
        }
        .formula-title {
            font-size: 16px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 10px;
            font-family: Aptos, sans-serif;
        }
        .formula {
            font-size: 18px;
            color: #333;
            text-align: center;
            padding: 10px;
        }
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }
        .comparison-card h4 {
            color: #1E64C8;
            margin-bottom: 10px;
            font-size: 18px;
        }
        .svg-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        .application-item {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #1E64C8;
        }
        .application-title {
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 5px;
        }
        .best-practices {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .best-practices-title {
            font-size: 18px;
            font-weight: 700;
            color: #856404;
            margin-bottom: 15px;
        }
        .pitfall-box {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .pitfall-title {
            font-size: 18px;
            font-weight: 700;
            color: #721c24;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="title">RNA Velocity</div>
        <div class="subtitle">Inferring Cell State Dynamics from Single-Cell RNA-seq Data</div>
        
        <!-- Overview Cards -->
        <div class="content-grid">
            <div class="content-card">
                <div class="card-title">üß¨ Spliced/Unspliced Ratio</div>
                <div class="card-desc">Infer transcriptional dynamics from steady-state snapshots</div>
            </div>
            <div class="content-card">
                <div class="card-title">üìä Velocity Estimation</div>
                <div class="card-desc">Predict future cell states and trajectories</div>
            </div>
            <div class="content-card">
                <div class="card-title">‚öôÔ∏è Dynamic Models</div>
                <div class="card-desc">Account for transcription, splicing, and degradation</div>
            </div>
            <div class="content-card">
                <div class="card-title">üöÄ scVelo Improvements</div>
                <div class="card-desc">Dynamical model with latent time inference</div>
            </div>
            <div class="content-card">
                <div class="card-title">üéØ Interpretation</div>
                <div class="card-desc">Direction and magnitude of cell state changes</div>
            </div>
        </div>
        
        <!-- Key Concept Note -->
        <div class="note-box">
            <div class="note-text">üí° RNA velocity adds a temporal dimension to static single-cell snapshots</div>
        </div>
        
        <!-- Visual Overview Section -->
        <div class="visual-section">
            <svg width="100%" height="140" viewBox="0 0 1100 140" xmlns="http://www.w3.org/2000/svg">
                <!-- Gene Transcription & Splicing -->
                <g id="gene-structure">
                    <text x="10" y="20" font-family="Aptos, sans-serif" font-size="14" font-weight="700" fill="#1E64C8">Gene Transcription & Splicing</text>
                    
                    <!-- Pre-mRNA with exons and introns -->
                    <rect x="10" y="35" width="40" height="18" rx="4" fill="#FF9800"/>
                    <rect x="55" y="35" width="60" height="18" rx="4" fill="#E0E0E0"/>
                    <rect x="120" y="35" width="40" height="18" rx="4" fill="#FF9800"/>
                    <rect x="165" y="35" width="60" height="18" rx="4" fill="#E0E0E0"/>
                    <rect x="230" y="35" width="40" height="18" rx="4" fill="#FF9800"/>
                    
                    <text x="15" y="70" font-family="Aptos, sans-serif" font-size="11" fill="#FF9800" font-weight="600">Exon</text>
                    <text x="68" y="70" font-family="Aptos, sans-serif" font-size="11" fill="#666">Intron</text>
                    
                    <!-- Splicing arrow -->
                    <path d="M 135 75 L 135 95" stroke="#1E64C8" stroke-width="3" fill="none"/>
                    <polygon points="135,95 130,88 140,88" fill="#1E64C8"/>
                    <text x="145" y="88" font-family="Aptos, sans-serif" font-size="12" fill="#1E64C8" font-weight="700">Splicing</text>
                    
                    <!-- Mature mRNA -->
                    <rect x="10" y="105" width="40" height="18" rx="4" fill="#4CAF50"/>
                    <rect x="55" y="105" width="40" height="18" rx="4" fill="#4CAF50"/>
                    <rect x="100" y="105" width="40" height="18" rx="4" fill="#4CAF50"/>
                    
                    <text x="15" y="135" font-family="Aptos, sans-serif" font-size="11" fill="#4CAF50" font-weight="600">Spliced mRNA</text>
                </g>
                
                <!-- Phase Portrait -->
                <g id="velocity-plot">
                    <rect x="320" y="15" width="320" height="115" rx="8" fill="#f5f5f5" stroke="#1E64C8" stroke-width="2"/>
                    <text x="480" y="35" font-family="Aptos, sans-serif" font-size="14" font-weight="700" fill="#1E64C8" text-anchor="middle">Phase Portrait: Unspliced vs Spliced</text>
                    
                    <!-- Axes -->
                    <line x1="345" y1="110" x2="615" y2="110" stroke="#666" stroke-width="2"/>
                    <line x1="345" y1="110" x2="345" y2="50" stroke="#666" stroke-width="2"/>
                    
                    <text x="480" y="125" font-family="Aptos, sans-serif" font-size="10" fill="#666" text-anchor="middle">Spliced ‚Üí</text>
                    <text x="330" y="78" font-family="Aptos, sans-serif" font-size="10" fill="#666" text-anchor="middle" transform="rotate(-90 330 78)">Unspliced ‚Üí</text>
                    
                    <!-- Phase trajectory with states -->
                    <circle cx="375" cy="100" r="5" fill="#FF5722"/>
                    <path d="M 375 100 L 410 80" stroke="#FF5722" stroke-width="3" marker-end="url(#arrowred)"/>
                    
                    <circle cx="440" cy="65" r="5" fill="#FF9800"/>
                    <path d="M 440 65 L 480 72" stroke="#FF9800" stroke-width="3" marker-end="url(#arroworange)"/>
                    
                    <circle cx="510" cy="78" r="5" fill="#FFC107"/>
                    <path d="M 510 78 L 550 92" stroke="#FFC107" stroke-width="3" marker-end="url(#arrowyellow)"/>
                    
                    <circle cx="575" cy="100" r="5" fill="#4CAF50"/>
                    
                    <!-- Labels -->
                    <text x="360" y="115" font-family="Aptos, sans-serif" font-size="9" fill="#FF5722" font-weight="600">Induction</text>
                    <text x="430" y="55" font-family="Aptos, sans-serif" font-size="9" fill="#FF9800" font-weight="600">Peak</text>
                    <text x="560" y="115" font-family="Aptos, sans-serif" font-size="9" fill="#4CAF50" font-weight="600">Steady</text>
                    
                    <defs>
                        <marker id="arrowred" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#FF5722"/>
                        </marker>
                        <marker id="arroworange" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#FF9800"/>
                        </marker>
                        <marker id="arrowyellow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#FFC107"/>
                        </marker>
                    </defs>
                </g>
                
                <!-- UMAP Velocity Field -->
                <g id="cell-projection">
                    <rect x="670" y="15" width="420" height="115" rx="8" fill="#f5f5f5" stroke="#1E64C8" stroke-width="2"/>
                    <text x="880" y="35" font-family="Aptos, sans-serif" font-size="14" font-weight="700" fill="#1E64C8" text-anchor="middle">Velocity Field on UMAP</text>
                    
                    <!-- UMAP axes -->
                    <line x1="695" y1="110" x2="1065" y2="110" stroke="#666" stroke-width="2"/>
                    <line x1="695" y1="110" x2="695" y2="50" stroke="#666" stroke-width="2"/>
                    
                    <text x="880" y="125" font-family="Aptos, sans-serif" font-size="10" fill="#666" text-anchor="middle">UMAP1</text>
                    <text x="680" y="78" font-family="Aptos, sans-serif" font-size="10" fill="#666" text-anchor="middle" transform="rotate(-90 680 78)">UMAP2</text>
                    
                    <!-- Cell clusters with velocity vectors -->
                    <!-- Early cluster -->
                    <circle cx="750" cy="85" r="6" fill="#FF5722" opacity="0.7"/>
                    <circle cx="762" cy="92" r="6" fill="#FF5722" opacity="0.7"/>
                    <circle cx="742" cy="95" r="6" fill="#FF5722" opacity="0.7"/>
                    <path d="M 752 88 L 800 70" stroke="#FF5722" stroke-width="3.5" marker-end="url(#arrowred2)"/>
                    
                    <!-- Transit cluster -->
                    <circle cx="840" cy="60" r="6" fill="#FF9800" opacity="0.7"/>
                    <circle cx="852" cy="67" r="6" fill="#FF9800" opacity="0.7"/>
                    <circle cx="832" cy="72" r="6" fill="#FF9800" opacity="0.7"/>
                    <path d="M 842 63 L 900 75" stroke="#FF9800" stroke-width="3.5" marker-end="url(#arroworange2)"/>
                    
                    <!-- Mature cluster -->
                    <circle cx="945" cy="80" r="6" fill="#4CAF50" opacity="0.7"/>
                    <circle cx="957" cy="87" r="6" fill="#4CAF50" opacity="0.7"/>
                    <circle cx="937" cy="90" r="6" fill="#4CAF50" opacity="0.7"/>
                    <path d="M 948 82 L 980 85" stroke="#4CAF50" stroke-width="3.5" marker-end="url(#arrowgreen2)"/>
                    
                    <!-- Differentiated cluster -->
                    <circle cx="1010" cy="92" r="6" fill="#2196F3" opacity="0.7"/>
                    <circle cx="1022" cy="98" r="6" fill="#2196F3" opacity="0.7"/>
                    <circle cx="1002" cy="100" r="6" fill="#2196F3" opacity="0.7"/>
                    
                    <defs>
                        <marker id="arrowred2" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L8,3 z" fill="#FF5722"/>
                        </marker>
                        <marker id="arroworange2" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L8,3 z" fill="#FF9800"/>
                        </marker>
                        <marker id="arrowgreen2" markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L8,3 z" fill="#4CAF50"/>
                        </marker>
                    </defs>
                    
                    <!-- State labels -->
                    <text x="755" y="108" font-family="Aptos, sans-serif" font-size="10" fill="#FF5722" font-weight="700">Early</text>
                    <text x="840" y="48" font-family="Aptos, sans-serif" font-size="10" fill="#FF9800" font-weight="700">Transit</text>
                    <text x="945" y="68" font-family="Aptos, sans-serif" font-size="10" fill="#4CAF50" font-weight="700">Mature</text>
                    <text x="1005" y="78" font-family="Aptos, sans-serif" font-size="10" fill="#2196F3" font-weight="700">Terminal</text>
                </g>
            </svg>
        </div>
        
        <div class="section-divider"></div>
        
        <!-- DETAILED SECTIONS BEGIN -->
        
        <!-- Section 1: Spliced/Unspliced Ratio -->
        <div class="detailed-section">
            <div class="section-title">
                <div class="section-number">1</div>
                Spliced/Unspliced Ratio Analysis
            </div>
            
            <div class="section-content">
                RNA velocity leverages the natural biology of gene expression to infer cellular dynamics. During transcription, genes produce pre-mRNA containing both exons (coding sequences) and introns (non-coding sequences). Through splicing, introns are removed to create mature mRNA. By measuring both unspliced (pre-mRNA) and spliced (mature mRNA) counts in single cells, we can infer whether a gene is being actively induced, repressed, or in steady state.
            </div>
            
            <div class="key-points">
                <div class="key-points-title">Key Concepts</div>
                <ul>
                    <li><strong>Unspliced mRNA:</strong> Newly transcribed pre-mRNA containing introns, indicates recent transcriptional activity</li>
                    <li><strong>Spliced mRNA:</strong> Mature mRNA after intron removal, represents the functional transcript pool</li>
                    <li><strong>Ratio dynamics:</strong> High unspliced/spliced ratio suggests gene induction; low ratio suggests repression</li>
                    <li><strong>Temporal inference:</strong> The relationship between unspliced and spliced abundance reveals transcriptional state</li>
                    <li><strong>Steady-state assumption:</strong> Most scRNA-seq captures cells at equilibrium, but the ratio reveals direction of change</li>
                </ul>
            </div>
            
            <div class="svg-container">
                <svg width="900" height="250" viewBox="0 0 900 250" xmlns="http://www.w3.org/2000/svg">
                    <!-- Three gene states visualization -->
                    <!-- Induction State -->
                    <g>
                        <rect x="20" y="10" width="260" height="230" rx="8" fill="#fff5f5" stroke="#FF5722" stroke-width="3"/>
                        <text x="150" y="35" font-family="Aptos, sans-serif" font-size="16" font-weight="700" fill="#FF5722" text-anchor="middle">Gene Induction</text>
                        
                        <rect x="50" y="60" width="40" height="130" rx="5" fill="#FF5722" opacity="0.8"/>
                        <text x="70" y="200" font-family="Aptos, sans-serif" font-size="12" fill="#FF5722" font-weight="600" text-anchor="middle">Unspliced</text>
                        <text x="70" y="215" font-family="Aptos, sans-serif" font-size="11" fill="#666" text-anchor="middle">(High)</text>
                        
                        <rect x="120" y="130" width="40" height="60" rx="5" fill="#FF9800" opacity="0.8"/>
                        <text x="140" y="200" font-family="Aptos, sans-serif" font-size="12" fill="#FF9800" font-weight="600" text-anchor="middle">Spliced</text>
                        <text x="140" y="215" font-family="Aptos, sans-serif" font-size="11" fill="#666" text-anchor="middle">(Low)</text>
                        
                        <path d="M 180 100 L 220 100" stroke="#FF5722" stroke-width="3" marker-end="url(#arrow1)"/>
                        <text x="200" y="90" font-family="Aptos, sans-serif" font-size="11" fill="#FF5722" font-weight="700" text-anchor="middle">Active</text>
                        
                        <text x="150" y="235" font-family="Aptos, sans-serif" font-size="13" fill="#333" text-anchor="middle">High u/s ‚Üí Upregulation</text>
                        
                        <defs>
                            <marker id="arrow1" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                                <path d="M0,0 L0,6 L9,3 z" fill="#FF5722"/>
                            </marker>
                        </defs>
                    </g>
                    
                    <!-- Steady State -->
                    <g>
                        <rect x="320" y="10" width="260" height="230" rx="8" fill="#f5fef5" stroke="#4CAF50" stroke-width="3"/>
                        <text x="450" y="35" font-family="Aptos, sans-serif" font-size="16" font-weight="700" fill="#4CAF50" text-anchor="middle">Steady State</text>
                        
                        <rect x="350" y="100" width="40" height="90" rx="5" fill="#FF9800" opacity="0.8"/>
                        <text x="370" y="200" font-family="Aptos, sans-serif" font-size="12" fill="#FF9800" font-weight="600" text-anchor="middle">Unspliced</text>
                        <text x="370" y="215" font-family="Aptos, sans-serif" font-size="11" fill="#666" text-anchor="middle">(Medium)</text>
                        
                        <rect x="420" y="100" width="40" height="90" rx="5" fill="#4CAF50" opacity="0.8"/>
                        <text x="440" y="200" font-family="Aptos, sans-serif" font-size="12" fill="#4CAF50" font-weight="600" text-anchor="middle">Spliced</text>
                        <text x="440" y="215" font-family="Aptos, sans-serif" font-size="11" fill="#666" text-anchor="middle">(Medium)</text>
                        
                        <path d="M 490 120 L 530 120 M 490 140 L 530 140" stroke="#4CAF50" stroke-width="3"/>
                        <path d="M 525 115 L 535 120 L 525 125" fill="#4CAF50"/>
                        <path d="M 495 135 L 485 140 L 495 145" fill="#4CAF50"/>
                        <text x="510" y="110" font-family="Aptos, sans-serif" font-size="11" fill="#4CAF50" font-weight="700" text-anchor="middle">Balanced</text>
                        
                        <text x="450" y="235" font-family="Aptos, sans-serif" font-size="13" fill="#333" text-anchor="middle">Balanced u/s ‚Üí Stable</text>
                    </g>
                    
                    <!-- Repression State -->
                    <g>
                        <rect x="620" y="10" width="260" height="230" rx="8" fill="#f5f5ff" stroke="#2196F3" stroke-width="3"/>
                        <text x="750" y="35" font-family="Aptos, sans-serif" font-size="16" font-weight="700" fill="#2196F3" text-anchor="middle">Gene Repression</text>
                        
                        <rect x="650" y="150" width="40" height="40" rx="5" fill="#FFC107" opacity="0.8"/>
                        <text x="670" y="200" font-family="Aptos, sans-serif" font-size="12" fill="#FFC107" font-weight="600" text-anchor="middle">Unspliced</text>
                        <text x="670" y="215" font-family="Aptos, sans-serif" font-size="11" fill="#666" text-anchor="middle">(Low)</text>
                        
                        <rect x="720" y="70" width="40" height="120" rx="5" fill="#2196F3" opacity="0.8"/>
                        <text x="740" y="200" font-family="Aptos, sans-serif" font-size="12" fill="#2196F3" font-weight="600" text-anchor="middle">Spliced</text>
                        <text x="740" y="215" font-family="Aptos, sans-serif" font-size="11" fill="#666" text-anchor="middle">(High)</text>
                        
                        <circle cx="820" cy="100" r="20" fill="none" stroke="#2196F3" stroke-width="3"/>
                        <line x1="810" y1="110" x2="830" y2="90" stroke="#2196F3" stroke-width="3"/>
                        <text x="820" y="135" font-family="Aptos, sans-serif" font-size="11" fill="#2196F3" font-weight="700" text-anchor="middle">Silenced</text>
                        
                        <text x="750" y="235" font-family="Aptos, sans-serif" font-size="13" fill="#333" text-anchor="middle">Low u/s ‚Üí Downregulation</text>
                    </g>
                </svg>
            </div>
            
            <div class="formula-box">
                <div class="formula-title">Velocity Inference from Ratios</div>
                <div class="formula">
                    If u/s &gt;&gt; expected: <span style="color: #FF5722; font-weight: 700;">positive velocity</span> (gene turning ON)<br>
                    If u/s ‚âà expected: <span style="color: #4CAF50; font-weight: 700;">zero velocity</span> (steady state)<br>
                    If u/s &lt;&lt; expected: <span style="color: #2196F3; font-weight: 700;">negative velocity</span> (gene turning OFF)
                </div>
            </div>
        </div>
        
        <!-- Section 2: Velocity Estimation -->
        <div class="detailed-section">
            <div class="section-title">
                <div class="section-number">2</div>
                Velocity Estimation Methods
            </div>
            
            <div class="section-content">
                RNA velocity estimation transforms the observed unspliced and spliced counts into predicted future states. The core idea is to fit a model that captures the relationship between unspliced and spliced abundances, then use deviations from steady-state to predict directional changes in gene expression. This velocity vector for each gene can then be projected into low-dimensional space (like UMAP or t-SNE) to visualize cell trajectories.
            </div>
            
            <div class="key-points">
                <div class="key-points-title">Estimation Workflow</div>
                <ul>
                    <li><strong>Phase portrait construction:</strong> Plot unspliced vs spliced counts for each gene across all cells</li>
                    <li><strong>Steady-state line fitting:</strong> Identify the expected equilibrium relationship (typically linear)</li>
                    <li><strong>Deviation measurement:</strong> Calculate how far each cell deviates from steady state</li>
                    <li><strong>Velocity vector computation:</strong> Convert deviations into directional change predictions</li>
                    <li><strong>Dimensionality reduction projection:</strong> Project gene-level velocities into embedding space</li>
                    <li><strong>Velocity field smoothing:</strong> Average velocities across similar cells for robustness</li>
                </ul>
            </div>
            
            <div class="formula-box">
                <div class="formula-title">Mathematical Foundation</div>
                <div class="formula" style="text-align: left; padding-left: 30px; font-size: 14px;">
                    <strong>Steady State Model:</strong> At equilibrium, transcription rate Œ± balances degradation: Œ± = Œ≤s + Œ≥u<br><br>
                    <strong>Velocity Equation:</strong> v = du/dt - Œ≥u, where du/dt represents change in unspliced abundance<br><br>
                    <strong>Linear Regression:</strong> Fit u = Œ≥s to identify steady-state relationship from data<br><br>
                    <strong>Residual-based Velocity:</strong> v ‚àù u - Œ≥s<br>
                    &nbsp;&nbsp;‚Ä¢ positive = above line ‚Üí gene increasing<br>
                    &nbsp;&nbsp;‚Ä¢ negative = below line ‚Üí gene decreasing<br><br>
                    <strong>Projection:</strong> Gene velocities projected to low-dimensional space: v_emb = Œ£ (‚àÇx/‚àÇg) √ó v_g
                </div>
            </div>
        </div>
        
        <!-- Section 3: Dynamic Models -->
        <div class="detailed-section">
            <div class="section-title">
                <div class="section-number">3</div>
                Dynamic Models of RNA Kinetics
            </div>
            
            <div class="section-content">
                Dynamic models explicitly capture the kinetics of transcription, splicing, and degradation. Rather than assuming steady state, these models account for how unspliced and spliced abundances change over time through differential equations. This allows for more accurate velocity estimation, especially in systems with rapid transcriptional changes or where genes haven't reached equilibrium.
            </div>
            
            <div class="key-points">
                <div class="key-points-title">Model Components</div>
                <ul>
                    <li><strong>Transcription rate (Œ±):</strong> Rate at which new unspliced mRNA is produced from the gene</li>
                    <li><strong>Splicing rate (Œ≤):</strong> Rate at which unspliced mRNA is converted to spliced mRNA</li>
                    <li><strong>Degradation rates (Œ≥_u, Œ≥_s):</strong> Rates at which unspliced and spliced mRNA are degraded</li>
                    <li><strong>Gene states:</strong> Genes can be in induction, repression, or steady-state phases</li>
                    <li><strong>Time-dependent dynamics:</strong> Models capture temporal evolution of mRNA populations</li>
                    <li><strong>Parameter estimation:</strong> Infer kinetic parameters from observed u and s distributions</li>
                </ul>
            </div>
            
            <div class="formula-box">
                <div class="formula-title">Differential Equations for RNA Dynamics</div>
                <div class="formula" style="text-align: left; padding-left: 50px;">
                    <strong>Unspliced mRNA:</strong><br>
                    du/dt = Œ±(t) - Œ≤u - Œ≥_u¬∑u<br><br>
                    
                    <strong>Spliced mRNA:</strong><br>
                    ds/dt = Œ≤u - Œ≥_s¬∑s<br><br>
                    
                    <strong>Gene States:</strong><br>
                    ‚Ä¢ <span style="color: #FF5722;">Induction:</span> Œ± switches from 0 ‚Üí Œ±_max<br>
                    ‚Ä¢ <span style="color: #4CAF50;">Steady:</span> Œ± constant, du/dt ‚âà 0, ds/dt ‚âà 0<br>
                    ‚Ä¢ <span style="color: #2196F3;">Repression:</span> Œ± switches from Œ±_max ‚Üí 0
                </div>
            </div>
            
            <div class="comparison-grid">
                <div class="comparison-card">
                    <h4>Steady-State Model (velocyto)</h4>
                    <p><strong>Assumption:</strong> Cells are at equilibrium</p>
                    <p><strong>Method:</strong> Linear regression on u vs s</p>
                    <p><strong>Pros:</strong> Simple, fast computation</p>
                    <p><strong>Cons:</strong> Less accurate for transient states</p>
                </div>
                <div class="comparison-card">
                    <h4>Dynamical Model (scVelo)</h4>
                    <p><strong>Assumption:</strong> Cells in different phases</p>
                    <p><strong>Method:</strong> Fit full ODE system</p>
                    <p><strong>Pros:</strong> Captures transitions accurately</p>
                    <p><strong>Cons:</strong> More complex, computationally intensive</p>
                </div>
            </div>
        </div>
        
        <!-- Section 4: scVelo Improvements -->
        <div class="detailed-section">
            <div class="section-title">
                <div class="section-number">4</div>
                scVelo: Advanced Dynamic Modeling
            </div>
            
            <div class="section-content">
                scVelo represents a major advancement in RNA velocity analysis by implementing a fully dynamic model that accounts for gene-specific kinetics across all cells. Unlike the original velocyto approach which assumes steady state, scVelo models the complete transcription-splicing-degradation dynamics and infers a "latent time" variable for each cell, representing its progression through biological processes. This enables more accurate velocity estimates and better resolution of complex differentiation trajectories.
            </div>
            
            <div class="key-points">
                <div class="key-points-title">Key Innovations</div>
                <ul>
                    <li><strong>Dynamical mode:</strong> Jointly models induction, steady-state, and repression phases for each gene</li>
                    <li><strong>Latent time inference:</strong> Estimates internal biological time for each cell along trajectories</li>
                    <li><strong>Gene-specific kinetics:</strong> Learns individual Œ±, Œ≤, Œ≥ parameters for each gene</li>
                    <li><strong>Likelihood-based fitting:</strong> Uses EM algorithm to optimize parameters and latent time simultaneously</li>
                    <li><strong>Velocity confidence:</strong> Provides uncertainty estimates for velocity predictions</li>
                    <li><strong>Improved projection:</strong> Better velocity field smoothing and embedding projection methods</li>
                </ul>
            </div>
            
            <div class="formula-box">
                <div class="formula-title">scVelo Dynamical Model</div>
                <div class="formula" style="text-align: left; padding-left: 30px; font-size: 14px;">
                    <strong>Likelihood-based Optimization:</strong><br>
                    Maximize P(u, s | Œ±, Œ≤, Œ≥, t) across all cells<br><br>
                    
                    <strong>For each gene:</strong><br>
                    ‚Ä¢ Estimate switching time points (when Œ± changes)<br>
                    ‚Ä¢ Fit rate parameters (Œ±, Œ≤, Œ≥) that best explain observed u/s distributions<br>
                    ‚Ä¢ Infer latent time t for each cell<br><br>
                    
                    <strong>Velocity from Model:</strong><br>
                    v = du/dt = Œ±(t) - (Œ≤ + Œ≥_u)¬∑u<br>
                    Computed from fitted parameters and cell's position in latent time
                </div>
            </div>
        </div>
        
        <!-- Section 5: Interpretation -->
        <div class="detailed-section">
            <div class="section-title">
                <div class="section-number">5</div>
                Interpretation and Applications
            </div>
            
            <div class="section-content">
                Understanding RNA velocity results requires careful interpretation of both the direction and magnitude of velocity vectors in the context of biological processes. Velocity arrows indicate the predicted short-term future state of cells, enabling inference of differentiation trajectories, cell fate decisions, and regulatory dynamics. However, velocities should be validated against known biology and complemented with other analyses for robust conclusions.
            </div>
            
            <div class="key-points">
                <div class="key-points-title">Interpretation Guidelines</div>
                <ul>
                    <li><strong>Arrow direction:</strong> Points toward predicted future cell state along differentiation or cell cycle</li>
                    <li><strong>Arrow length:</strong> Indicates magnitude of change; longer arrows suggest faster transitions</li>
                    <li><strong>Velocity consistency:</strong> Coherent flow patterns indicate robust trajectories</li>
                    <li><strong>Terminal states:</strong> Cells with short or inward-pointing arrows may represent endpoints</li>
                    <li><strong>Branching points:</strong> Diverging velocities reveal cell fate bifurcations</li>
                    <li><strong>Confidence assessment:</strong> Check velocity confidence scores and gene-level contributions</li>
                    <li><strong>Biological validation:</strong> Verify predictions with known markers and experimental perturbations</li>
                </ul>
            </div>
            
            <div class="application-item">
                <div class="application-title">üß¨ Developmental Trajectories</div>
                Map cell fate decisions during embryogenesis and organogenesis. Velocity analysis reveals the directionality of differentiation pathways and identifies progenitor populations.
            </div>
            
            <div class="application-item">
                <div class="application-title">üîÑ Cell Cycle Analysis</div>
                Distinguish cycling from non-cycling cells and determine cell cycle phase progression. Velocity vectors show circular patterns for proliferating cells.
            </div>
            
            <div class="application-item">
                <div class="application-title">ü©∫ Disease Progression</div>
                Study cancer evolution, immune response dynamics, and disease state transitions. Identify aberrant differentiation patterns in pathological conditions.
            </div>
            
            <div class="application-item">
                <div class="application-title">üß™ Drug Response</div>
                Assess how perturbations alter cell trajectories. Compare velocity fields before and after treatment to identify mechanistic effects.
            </div>
            
            <div class="application-item">
                <div class="application-title">üß† Neuronal Differentiation</div>
                Trace neural stem cell differentiation into diverse neuronal subtypes. Resolve complex branching patterns in neurogenesis.
            </div>
            
            <div class="best-practices">
                <div class="best-practices-title">‚≠ê Best Practices</div>
                <ul style="list-style-type: none; padding-left: 0;">
                    <li style="margin: 10px 0;">‚úì <strong>Quality control:</strong> Filter low-quality cells and genes before velocity analysis</li>
                    <li style="margin: 10px 0;">‚úì <strong>Multiple approaches:</strong> Compare steady-state and dynamical models</li>
                    <li style="margin: 10px 0;">‚úì <strong>Confidence metrics:</strong> Examine velocity confidence and gene contributions</li>
                    <li style="margin: 10px 0;">‚úì <strong>Biological context:</strong> Interpret results in light of known markers and biology</li>
                    <li style="margin: 10px 0;">‚úì <strong>Validation:</strong> Cross-validate with trajectory inference methods (Monocle, Slingshot)</li>
                    <li style="margin: 10px 0;">‚úì <strong>Visualization:</strong> Use multiple embeddings (UMAP, PCA, force-directed) to assess robustness</li>
                </ul>
            </div>
            
            <div class="pitfall-box">
                <div class="pitfall-title">‚ö†Ô∏è Common Pitfalls to Avoid</div>
                <ul style="list-style-type: none; padding-left: 0;">
                    <li style="margin: 10px 0;">‚úó <strong>Over-interpretation:</strong> RNA velocity predicts SHORT-TERM futures, not long-term fates</li>
                    <li style="margin: 10px 0;">‚úó <strong>Batch effects:</strong> Technical variation can create spurious velocity patterns</li>
                    <li style="margin: 10px 0;">‚úó <strong>Low coverage:</strong> Sparse data reduces velocity reliability, especially for rare cell types</li>
                    <li style="margin: 10px 0;">‚úó <strong>Assuming causality:</strong> Velocity shows correlation with trajectories, not causal mechanisms</li>
                    <li style="margin: 10px 0;">‚úó <strong>Ignoring biology:</strong> Computational predictions must align with experimental evidence</li>
                    <li style="margin: 10px 0;">‚úó <strong>Single-gene focus:</strong> Analyze velocity across many genes, not individual genes in isolation</li>
                </ul>
            </div>
        </div>
        
        <!-- Summary Section -->
        <div class="note-box" style="margin-top: 50px;">
            <div class="note-text" style="font-size: 16px; line-height: 1.6;">
                <strong>Summary:</strong> RNA velocity is a powerful computational method that adds temporal resolution to single-cell RNA-seq data. By leveraging the natural dynamics of RNA splicing, it enables prediction of cell state transitions, identification of differentiation trajectories, and discovery of regulatory relationships. When combined with careful quality control, appropriate modeling choices (steady-state vs. dynamical), and biological validation, RNA velocity provides unique insights into cellular dynamics that are invisible in static gene expression measurements.
            </div>
        </div>
        
        <!-- References Section -->
        <div style="margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 8px;">
            <h3 style="color: #1E64C8; margin-bottom: 15px;">Key References</h3>
            <ul style="line-height: 2; color: #333;">
                <li><strong>velocyto:</strong> La Manno et al. (2018). "RNA velocity of single cells." Nature.</li>
                <li><strong>scVelo:</strong> Bergen et al. (2020). "Generalizing RNA velocity to transient cell states through dynamical modeling." Nature Biotechnology.</li>
                <li><strong>RNA velocity analysis:</strong> Lange et al. (2022). "CellRank for directed single-cell fate mapping." Nature Methods.</li>
                <li><strong>Velocity interpretation:</strong> Gorin et al. (2022). "RNA velocity unraveled." PLoS Computational Biology.</li>
            </ul>
        </div>
    </div>
</body>
</html>