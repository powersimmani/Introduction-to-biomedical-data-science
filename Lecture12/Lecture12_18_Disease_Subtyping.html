<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disease Subtyping - Detailed Lecture</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .main-title {
            font-size: 32px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .subtitle {
            font-size: 18px;
            color: #666;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 50px;
        }
        
        .feature-card {
            background: linear-gradient(135deg, #f8fbff 0%, #e8f4ff 100%);
            border: 2px solid #1E64C8;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(30, 100, 200, 0.25);
        }
        
        .feature-title {
            font-size: 18px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 10px;
        }
        
        .feature-desc {
            font-size: 15px;
            color: #555;
            line-height: 1.5;
        }
        
        .detail-section {
            margin-bottom: 60px;
            padding: 30px;
            background: #fafbfc;
            border-radius: 12px;
            border-left: 5px solid #1E64C8;
        }
        
        .section-title {
            font-size: 26px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .section-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            background: #1E64C8;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            margin-right: 15px;
            font-size: 20px;
        }
        
        .section-content {
            font-size: 16px;
            color: #333;
            line-height: 1.8;
            margin-bottom: 25px;
        }
        
        .section-content p {
            margin-bottom: 15px;
        }
        
        .subsection-title {
            font-size: 19px;
            font-weight: 600;
            color: #2c5aa0;
            margin: 25px 0 15px 0;
        }
        
        .visualization {
            background: white;
            border: 2px solid #e0e6ed;
            border-radius: 10px;
            padding: 30px;
            margin: 25px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .viz-title {
            font-size: 17px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .cluster-viz {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 20px;
        }
        
        .cluster-group {
            text-align: center;
        }
        
        .cluster-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: 600;
            color: white;
            font-size: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .cluster-label {
            font-size: 14px;
            color: #555;
            font-weight: 500;
        }
        
        .flowchart {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .flow-box {
            background: linear-gradient(135deg, #1E64C8 0%, #2c5aa0 100%);
            color: white;
            padding: 20px 25px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 15px;
            text-align: center;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 3px 10px rgba(30, 100, 200, 0.3);
        }
        
        .flow-arrow {
            font-size: 24px;
            color: #1E64C8;
            font-weight: bold;
        }
        
        .heatmap {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 3px;
            padding: 20px;
            background: white;
            border-radius: 8px;
        }
        
        .heatmap-cell {
            width: 100%;
            padding-bottom: 100%;
            border-radius: 3px;
            position: relative;
        }
        
        .timeline {
            position: relative;
            padding: 30px 0;
        }
        
        .timeline-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: #1E64C8;
        }
        
        .timeline-item {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .timeline-content {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #1E64C8;
            width: 45%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .timeline-item:nth-child(odd) .timeline-content {
            margin-right: auto;
        }
        
        .timeline-item:nth-child(even) .timeline-content {
            margin-left: auto;
        }
        
        .timeline-dot {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: #1E64C8;
            border-radius: 50%;
            border: 4px solid white;
            box-shadow: 0 0 0 3px #1E64C8;
        }
        
        .key-points {
            background: #fff9e6;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        
        .key-points-title {
            font-weight: 600;
            color: #f57c00;
            margin-bottom: 10px;
            font-size: 17px;
        }
        
        .key-points ul {
            list-style-position: inside;
            color: #555;
            line-height: 1.8;
        }
        
        .example-box {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .example-title {
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 17px;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .metric-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-title">Disease Subtyping</div>
        <div class="subtitle">Advanced Methods for Identifying and Characterizing Disease Heterogeneity</div>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-title">Molecular Subtypes</div>
                <div class="feature-desc">Identifying disease subtypes from multi-omics data</div>
            </div>
            
            <div class="feature-card">
                <div class="feature-title">Clinical Correlates</div>
                <div class="feature-desc">Linking subtypes to clinical outcomes and treatment response</div>
            </div>
            
            <div class="feature-card">
                <div class="feature-title">Consensus Clustering</div>
                <div class="feature-desc">Robust subtype identification through ensemble methods</div>
            </div>
            
            <div class="feature-card">
                <div class="feature-title">Stability Analysis</div>
                <div class="feature-desc">Assessing subtype reproducibility and confidence</div>
            </div>
            
            <div class="feature-card">
                <div class="feature-title">Validation Cohorts</div>
                <div class="feature-desc">Independent validation across multiple datasets</div>
            </div>
        </div>

        <!-- Section 1: Molecular Subtypes -->
        <div class="detail-section">
            <div class="section-title">
                <span class="section-number">1</span>
                Molecular Subtypes
            </div>
            
            <div class="section-content">
                <p>Molecular subtyping aims to classify diseases based on underlying molecular characteristics rather than clinical symptoms alone. This approach leverages multi-omics data including genomics, transcriptomics, proteomics, and metabolomics to identify distinct disease subtypes with different biological mechanisms.</p>
                
                <p>The integration of multiple data types allows for a more comprehensive understanding of disease heterogeneity, leading to more precise diagnosis and personalized treatment strategies.</p>
            </div>

            <div class="subsection-title">Multi-Omics Integration Approach</div>
            
            <div class="visualization">
                <div class="viz-title">Multi-Omics Data Integration for Subtype Discovery</div>
                <div class="flowchart">
                    <div class="flow-box">Genomics<br/><small>DNA mutations</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Transcriptomics<br/><small>Gene expression</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Proteomics<br/><small>Protein levels</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Integration<br/><small>Subtype discovery</small></div>
                </div>
            </div>

            <div class="visualization">
                <div class="viz-title">Example: Cancer Molecular Subtypes</div>
                <div class="cluster-viz">
                    <div class="cluster-group">
                        <div class="cluster-circle" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                            Subtype A
                        </div>
                        <div class="cluster-label">Immune-enriched<br/>Good prognosis</div>
                    </div>
                    <div class="cluster-group">
                        <div class="cluster-circle" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                            Subtype B
                        </div>
                        <div class="cluster-label">Proliferative<br/>Intermediate</div>
                    </div>
                    <div class="cluster-group">
                        <div class="cluster-circle" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                            Subtype C
                        </div>
                        <div class="cluster-label">Metabolic<br/>Treatment-resistant</div>
                    </div>
                    <div class="cluster-group">
                        <div class="cluster-circle" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                            Subtype D
                        </div>
                        <div class="cluster-label">Mesenchymal<br/>Poor prognosis</div>
                    </div>
                </div>
            </div>

            <div class="key-points">
                <div class="key-points-title">Key Considerations:</div>
                <ul>
                    <li>Feature selection is critical - focus on biologically relevant markers</li>
                    <li>Batch effects must be corrected across different omics platforms</li>
                    <li>Integration methods include early fusion, late fusion, and intermediate fusion</li>
                    <li>Dimensionality reduction (PCA, t-SNE, UMAP) helps visualize subtypes</li>
                </ul>
            </div>

            <div class="example-box">
                <div class="example-title">Real-World Example: Breast Cancer Subtypes</div>
                The PAM50 classifier identifies five intrinsic subtypes of breast cancer based on gene expression: Luminal A, Luminal B, HER2-enriched, Basal-like, and Normal-like. Each subtype has distinct molecular characteristics, prognosis, and treatment response patterns.
            </div>
        </div>

        <!-- Section 2: Clinical Correlates -->
        <div class="detail-section">
            <div class="section-title">
                <span class="section-number">2</span>
                Clinical Correlates
            </div>
            
            <div class="section-content">
                <p>After identifying molecular subtypes, it's essential to establish their clinical relevance by linking them to patient outcomes, treatment response, and disease progression. This validation ensures that molecular classifications translate into actionable clinical insights.</p>
                
                <p>Clinical correlates include survival outcomes, treatment efficacy, disease recurrence, quality of life measures, and biomarker responses. Statistical methods such as Kaplan-Meier survival analysis, Cox proportional hazards models, and logistic regression are commonly employed.</p>
            </div>

            <div class="subsection-title">Survival Analysis by Subtype</div>
            
            <div class="visualization">
                <div class="viz-title">Kaplan-Meier Survival Curves by Disease Subtype</div>
                <svg width="100%" height="300" viewBox="0 0 600 300">
                    <!-- Axes -->
                    <line x1="50" y1="250" x2="550" y2="250" stroke="#333" stroke-width="2"/>
                    <line x1="50" y1="250" x2="50" y2="30" stroke="#333" stroke-width="2"/>
                    
                    <!-- Grid lines -->
                    <line x1="50" y1="200" x2="550" y2="200" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="150" x2="550" y2="150" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="100" x2="550" y2="100" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="50" x2="550" y2="50" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    
                    <!-- Subtype A curve (best survival) -->
                    <polyline points="50,50 150,50 180,80 250,80 300,110 400,120 550,130" 
                              fill="none" stroke="#e74c3c" stroke-width="3"/>
                    
                    <!-- Subtype B curve -->
                    <polyline points="50,50 130,70 170,100 220,130 280,160 350,180 550,200" 
                              fill="none" stroke="#3498db" stroke-width="3"/>
                    
                    <!-- Subtype C curve -->
                    <polyline points="50,50 100,90 140,130 180,170 220,200 270,220 550,240" 
                              fill="none" stroke="#2ecc71" stroke-width="3"/>
                    
                    <!-- Labels -->
                    <text x="300" y="280" text-anchor="middle" font-size="14" fill="#333">Time (months)</text>
                    <text x="20" y="150" text-anchor="middle" font-size="14" fill="#333" transform="rotate(-90 20 150)">Survival Probability</text>
                    
                    <!-- Legend -->
                    <line x1="420" y1="60" x2="460" y2="60" stroke="#e74c3c" stroke-width="3"/>
                    <text x="470" y="65" font-size="13" fill="#333">Subtype A (p < 0.001)</text>
                    
                    <line x1="420" y1="85" x2="460" y2="85" stroke="#3498db" stroke-width="3"/>
                    <text x="470" y="90" font-size="13" fill="#333">Subtype B (p < 0.01)</text>
                    
                    <line x1="420" y1="110" x2="460" y2="110" stroke="#2ecc71" stroke-width="3"/>
                    <text x="470" y="115" font-size="13" fill="#333">Subtype C (reference)</text>
                </svg>
            </div>

            <div class="subsection-title">Treatment Response Analysis</div>
            
            <div class="metrics-grid">
                <div class="metric-card" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                    <div class="metric-value">85%</div>
                    <div class="metric-label">Subtype A Response Rate</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                    <div class="metric-value">62%</div>
                    <div class="metric-label">Subtype B Response Rate</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #2ecc71, #27ae60);">
                    <div class="metric-value">38%</div>
                    <div class="metric-label">Subtype C Response Rate</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                    <div class="metric-value">25%</div>
                    <div class="metric-label">Subtype D Response Rate</div>
                </div>
            </div>

            <div class="key-points">
                <div class="key-points-title">Statistical Methods:</div>
                <ul>
                    <li>Log-rank test for comparing survival curves between subtypes</li>
                    <li>Multivariate Cox regression to adjust for confounding variables</li>
                    <li>Chi-square tests for categorical outcome associations</li>
                    <li>ROC analysis for predictive performance evaluation</li>
                </ul>
            </div>

            <div class="example-box">
                <div class="example-title">Clinical Translation Example:</div>
                In acute myeloid leukemia (AML), molecular subtypes identified through gene expression profiling showed significantly different responses to standard chemotherapy. Patients with favorable-risk subtypes achieved 70% complete remission rates, while adverse-risk subtypes showed only 30% response, leading to risk-adapted treatment protocols.
            </div>
        </div>

        <!-- Section 3: Consensus Clustering -->
        <div class="detail-section">
            <div class="section-title">
                <span class="section-number">3</span>
                Consensus Clustering
            </div>
            
            <div class="section-content">
                <p>Consensus clustering is a robust method for identifying stable clusters by aggregating results from multiple clustering runs with resampling. This approach addresses the instability inherent in many clustering algorithms and provides a measure of cluster confidence.</p>
                
                <p>The method involves repeatedly subsampling the data, performing clustering on each subsample, and then constructing a consensus matrix that records how frequently pairs of samples cluster together. The final clustering is derived from this consensus matrix.</p>
            </div>

            <div class="subsection-title">Consensus Clustering Workflow</div>
            
            <div class="visualization">
                <div class="viz-title">Consensus Clustering Pipeline</div>
                <div class="flowchart">
                    <div class="flow-box">Resample Data<br/><small>80% samples</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Cluster<br/><small>k-means/HC</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Record<br/><small>Co-clustering</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Repeat<br/><small>1000x</small></div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-box">Consensus<br/><small>Matrix</small></div>
                </div>
            </div>

            <div class="subsection-title">Consensus Matrix Heatmap</div>
            
            <div class="visualization">
                <div class="viz-title">Example Consensus Matrix (High stability = Dark colors)</div>
                <div style="text-align: center; padding: 20px;">
                    <svg width="400" height="400" viewBox="0 0 400 400">
                        <!-- Consensus matrix blocks -->
                        <!-- Cluster 1 (strong consensus) -->
                        <rect x="0" y="0" width="120" height="120" fill="#1a1a4d" opacity="0.9"/>
                        <rect x="120" y="0" width="120" height="120" fill="#e8e8ff" opacity="0.3"/>
                        <rect x="240" y="0" width="160" height="120" fill="#e8e8ff" opacity="0.2"/>
                        
                        <!-- Cluster 2 (strong consensus) -->
                        <rect x="0" y="120" width="120" height="120" fill="#e8e8ff" opacity="0.3"/>
                        <rect x="120" y="120" width="120" height="120" fill="#1a1a4d" opacity="0.9"/>
                        <rect x="240" y="120" width="160" height="120" fill="#e8e8ff" opacity="0.2"/>
                        
                        <!-- Cluster 3 (strong consensus) -->
                        <rect x="0" y="240" width="120" height="160" fill="#e8e8ff" opacity="0.2"/>
                        <rect x="120" y="240" width="120" height="160" fill="#e8e8ff" opacity="0.2"/>
                        <rect x="240" y="240" width="160" height="160" fill="#1a1a4d" opacity="0.9"/>
                        
                        <!-- Grid lines -->
                        <line x1="120" y1="0" x2="120" y2="400" stroke="#666" stroke-width="2"/>
                        <line x1="240" y1="0" x2="240" y2="400" stroke="#666" stroke-width="2"/>
                        <line x1="0" y1="120" x2="400" y2="120" stroke="#666" stroke-width="2"/>
                        <line x1="0" y1="240" x2="400" y2="240" stroke="#666" stroke-width="2"/>
                        
                        <!-- Labels -->
                        <text x="60" y="-10" font-size="16" fill="#333" font-weight="bold">Cluster 1</text>
                        <text x="180" y="-10" font-size="16" fill="#333" font-weight="bold">Cluster 2</text>
                        <text x="320" y="-10" font-size="16" fill="#333" font-weight="bold">Cluster 3</text>
                        
                        <text x="-80" y="65" font-size="16" fill="#333" font-weight="bold" transform="rotate(-90 -80 65)">Cluster 1</text>
                        <text x="-80" y="185" font-size="16" fill="#333" font-weight="bold" transform="rotate(-90 -80 185)">Cluster 2</text>
                        <text x="-80" y="325" font-size="16" fill="#333" font-weight="bold" transform="rotate(-90 -80 325)">Cluster 3</text>
                    </svg>
                    <div style="margin-top: 20px; font-size: 14px; color: #666;">
                        <strong>Interpretation:</strong> Dark diagonal blocks indicate high consensus within clusters. 
                        Light off-diagonal regions show low co-clustering between different subtypes.
                    </div>
                </div>
            </div>

            <div class="key-points">
                <div class="key-points-title">Advantages of Consensus Clustering:</div>
                <ul>
                    <li>Reduces sensitivity to initialization and outliers</li>
                    <li>Provides quantitative measure of cluster stability</li>
                    <li>Helps determine optimal number of clusters</li>
                    <li>Identifies ambiguous samples with low consensus</li>
                </ul>
            </div>

            <div class="subsection-title">Determining Optimal Cluster Number</div>
            
            <div class="visualization">
                <div class="viz-title">Consensus CDF and Delta Area</div>
                <svg width="100%" height="250" viewBox="0 0 500 250">
                    <!-- CDF curves for different k values -->
                    <text x="250" y="20" text-anchor="middle" font-size="14" fill="#333" font-weight="bold">Cumulative Distribution Function</text>
                    
                    <!-- Axes -->
                    <line x1="50" y1="220" x2="450" y2="220" stroke="#333" stroke-width="2"/>
                    <line x1="50" y1="220" x2="50" y2="50" stroke="#333" stroke-width="2"/>
                    
                    <!-- CDF curves -->
                    <polyline points="50,220 100,200 150,170 200,130 250,90 300,60 350,50 450,50" 
                              fill="none" stroke="#e74c3c" stroke-width="2"/>
                    <polyline points="50,220 100,190 150,150 200,100 250,70 300,55 350,50 450,50" 
                              fill="none" stroke="#3498db" stroke-width="2"/>
                    <polyline points="50,220 100,180 150,120 200,75 250,55 300,50 350,50 450,50" 
                              fill="none" stroke="#2ecc71" stroke-width="2" stroke-width="3"/>
                    
                    <!-- Labels -->
                    <text x="250" y="245" text-anchor="middle" font-size="12" fill="#333">Consensus Index</text>
                    
                    <!-- Legend -->
                    <text x="360" y="100" font-size="12" fill="#e74c3c">k=2</text>
                    <text x="360" y="120" font-size="12" fill="#3498db">k=3</text>
                    <text x="360" y="140" font-size="12" fill="#2ecc71" font-weight="bold">k=4 (optimal)</text>
                </svg>
            </div>

            <div class="example-box">
                <div class="example-title">Practical Application:</div>
                The Cancer Genome Atlas (TCGA) used consensus clustering to identify robust molecular subtypes across multiple cancer types. For ovarian cancer, they identified four transcriptional subtypes with distinct biological characteristics and clinical outcomes, which have been validated in multiple independent cohorts.
            </div>
        </div>

        <!-- Section 4: Stability Analysis -->
        <div class="detail-section">
            <div class="section-title">
                <span class="section-number">4</span>
                Stability Analysis
            </div>
            
            <div class="section-content">
                <p>Stability analysis assesses the reproducibility and robustness of identified subtypes across different conditions, including data perturbations, feature selections, and algorithmic choices. A stable subtyping solution should be resilient to minor variations in the input data.</p>
                
                <p>Multiple approaches exist for evaluating stability, including bootstrap resampling, cross-validation, subsampling analysis, and noise injection. These methods help distinguish true biological subtypes from artifacts of the clustering algorithm.</p>
            </div>

            <div class="subsection-title">Stability Assessment Methods</div>
            
            <div class="visualization">
                <div class="viz-title">Stability Evaluation Framework</div>
                <div class="flowchart" style="flex-direction: column;">
                    <div style="display: flex; gap: 15px; justify-content: space-around; width: 100%; margin-bottom: 15px;">
                        <div class="flow-box" style="flex: 1;">Bootstrap<br/>Resampling</div>
                        <div class="flow-box" style="flex: 1;">Feature<br/>Subsampling</div>
                        <div class="flow-box" style="flex: 1;">Noise<br/>Injection</div>
                    </div>
                    <div class="flow-arrow" style="transform: rotate(90deg); margin: 10px 0;">→</div>
                    <div style="display: flex; gap: 15px; justify-content: center; width: 100%;">
                        <div class="flow-box" style="min-width: 250px;">Stability Metrics<br/><small>Jaccard, Rand Index, ARI</small></div>
                    </div>
                </div>
            </div>

            <div class="subsection-title">Stability Metrics Visualization</div>
            
            <div class="metrics-grid">
                <div class="metric-card" style="background: linear-gradient(135deg, #27ae60, #229954);">
                    <div class="metric-value">0.92</div>
                    <div class="metric-label">Adjusted Rand Index<br/>(High Stability)</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #27ae60, #229954);">
                    <div class="metric-value">0.88</div>
                    <div class="metric-label">Jaccard Coefficient<br/>(High Stability)</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #f39c12, #d68910);">
                    <div class="metric-value">0.65</div>
                    <div class="metric-label">Silhouette Score<br/>(Moderate)</div>
                </div>
                <div class="metric-card" style="background: linear-gradient(135deg, #3498db, #2980b9);">
                    <div class="metric-value">3.2</div>
                    <div class="metric-label">Gap Statistic<br/>(k=4 optimal)</div>
                </div>
            </div>

            <div class="visualization">
                <div class="viz-title">Stability Across Subsampling Iterations</div>
                <svg width="100%" height="280" viewBox="0 0 550 280">
                    <!-- Axes -->
                    <line x1="50" y1="230" x2="520" y2="230" stroke="#333" stroke-width="2"/>
                    <line x1="50" y1="230" x2="50" y2="30" stroke="#333" stroke-width="2"/>
                    
                    <!-- Grid -->
                    <line x1="50" y1="180" x2="520" y2="180" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="130" x2="520" y2="130" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="50" y1="80" x2="520" y2="80" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    
                    <!-- Stability trend line with variance -->
                    <path d="M 50 150 Q 150 140, 200 145 T 350 148 T 520 150" 
                          fill="none" stroke="#2ecc71" stroke-width="3"/>
                    
                    <!-- Confidence band -->
                    <path d="M 50 170 Q 150 160, 200 165 T 350 168 T 520 170" 
                          fill="none" stroke="#2ecc71" stroke-width="1" opacity="0.5" stroke-dasharray="3,3"/>
                    <path d="M 50 130 Q 150 120, 200 125 T 350 128 T 520 130" 
                          fill="none" stroke="#2ecc71" stroke-width="1" opacity="0.5" stroke-dasharray="3,3"/>
                    
                    <!-- Sample points -->
                    <circle cx="100" cy="148" r="4" fill="#2ecc71"/>
                    <circle cx="200" cy="145" r="4" fill="#2ecc71"/>
                    <circle cx="300" cy="147" r="4" fill="#2ecc71"/>
                    <circle cx="400" cy="149" r="4" fill="#2ecc71"/>
                    <circle cx="500" cy="150" r="4" fill="#2ecc71"/>
                    
                    <!-- Labels -->
                    <text x="285" y="260" text-anchor="middle" font-size="13" fill="#333">Subsampling Iteration</text>
                    <text x="20" y="140" text-anchor="middle" font-size="13" fill="#333" transform="rotate(-90 20 140)">Stability Score</text>
                    
                    <!-- Y-axis values -->
                    <text x="45" y="235" text-anchor="end" font-size="11" fill="#555">0.0</text>
                    <text x="45" y="185" text-anchor="end" font-size="11" fill="#555">0.5</text>
                    <text x="45" y="135" text-anchor="end" font-size="11" fill="#555">0.7</text>
                    <text x="45" y="85" text-anchor="end" font-size="11" fill="#555">0.9</text>
                    <text x="45" y="35" text-anchor="end" font-size="11" fill="#555">1.0</text>
                    
                    <!-- Annotation -->
                    <text x="300" y="60" text-anchor="middle" font-size="13" fill="#27ae60" font-weight="bold">
                        High Stability (Score > 0.85)
                    </text>
                </svg>
            </div>

            <div class="key-points">
                <div class="key-points-title">Stability Metrics Interpretation:</div>
                <ul>
                    <li>Adjusted Rand Index (ARI): 0-1 scale, >0.8 indicates high stability</li>
                    <li>Jaccard Coefficient: Measures overlap between clustering solutions</li>
                    <li>Silhouette Score: Assesses separation between clusters (-1 to 1)</li>
                    <li>Stability > 0.85 suggests robust, reproducible subtypes</li>
                </ul>
            </div>

            <div class="example-box">
                <div class="example-title">Case Study: Alzheimer's Disease Subtypes</div>
                Recent research identified three stable subtypes of Alzheimer's disease through multi-modal neuroimaging and biomarker data. Bootstrap stability analysis with 10,000 iterations showed ARI > 0.90, confirming these subtypes were highly reproducible and not artifacts of the clustering method. Each subtype showed distinct patterns of brain atrophy and cognitive decline trajectories.
            </div>
        </div>

        <!-- Section 5: Validation Cohorts -->
        <div class="detail-section">
            <div class="section-title">
                <span class="section-number">5</span>
                Validation Cohorts
            </div>
            
            <div class="section-content">
                <p>Independent validation is the gold standard for confirming that identified subtypes are generalizable and not specific to the discovery dataset. Validation cohorts should be collected from different populations, time periods, or institutions to ensure broad applicability.</p>
                
                <p>The validation process involves training a classifier on the discovery cohort, then applying it to independent cohorts to assess whether the subtypes maintain their distinct molecular and clinical characteristics. Cross-platform validation is particularly important when different technologies are used.</p>
            </div>

            <div class="subsection-title">Validation Strategy</div>
            
            <div class="visualization">
                <div class="viz-title">Multi-Cohort Validation Framework</div>
                <div class="timeline">
                    <div class="timeline-line"></div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4 style="color: #1E64C8; margin-bottom: 8px; font-size: 16px;">Discovery Cohort</h4>
                            <p style="font-size: 14px; color: #555; margin: 0;">Initial subtype identification<br/>N = 500 patients<br/>Platform: RNA-seq</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4 style="color: #1E64C8; margin-bottom: 8px; font-size: 16px;">Internal Validation</h4>
                            <p style="font-size: 14px; color: #555; margin: 0;">Same institution, different time<br/>N = 200 patients<br/>Platform: RNA-seq</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4 style="color: #1E64C8; margin-bottom: 8px; font-size: 16px;">External Validation</h4>
                            <p style="font-size: 14px; color: #555; margin: 0;">Different institution<br/>N = 350 patients<br/>Platform: RNA-seq</p>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-dot"></div>
                        <div class="timeline-content">
                            <h4 style="color: #1E64C8; margin-bottom: 8px; font-size: 16px;">Cross-Platform Validation</h4>
                            <p style="font-size: 14px; color: #555; margin: 0;">Different technology<br/>N = 180 patients<br/>Platform: Microarray</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="subsection-title">Validation Performance Metrics</div>
            
            <div class="visualization">
                <div class="viz-title">Classification Accuracy Across Validation Cohorts</div>
                <svg width="100%" height="300" viewBox="0 0 600 300">
                    <!-- Axes -->
                    <line x1="80" y1="250" x2="570" y2="250" stroke="#333" stroke-width="2"/>
                    <line x1="80" y1="250" x2="80" y2="30" stroke="#333" stroke-width="2"/>
                    
                    <!-- Grid -->
                    <line x1="80" y1="200" x2="570" y2="200" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="80" y1="150" x2="570" y2="150" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="80" y1="100" x2="570" y2="100" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    <line x1="80" y1="50" x2="570" y2="50" stroke="#ddd" stroke-width="1" stroke-dasharray="5,5"/>
                    
                    <!-- Bars -->
                    <!-- Discovery -->
                    <rect x="120" y="55" width="80" height="195" fill="#27ae60" opacity="0.8"/>
                    <text x="160" y="45" text-anchor="middle" font-size="14" fill="#27ae60" font-weight="bold">95%</text>
                    
                    <!-- Internal -->
                    <rect x="230" y="65" width="80" height="185" fill="#2ecc71" opacity="0.8"/>
                    <text x="270" y="55" text-anchor="middle" font-size="14" fill="#27ae60" font-weight="bold">93%</text>
                    
                    <!-- External -->
                    <rect x="340" y="85" width="80" height="165" fill="#3498db" opacity="0.8"/>
                    <text x="380" y="75" text-anchor="middle" font-size="14" fill="#2980b9" font-weight="bold">88%</text>
                    
                    <!-- Cross-platform -->
                    <rect x="450" y="105" width="80" height="145" fill="#9b59b6" opacity="0.8"/>
                    <text x="490" y="95" text-anchor="middle" font-size="14" fill="#8e44ad" font-weight="bold">82%</text>
                    
                    <!-- X-axis labels -->
                    <text x="160" y="275" text-anchor="middle" font-size="12" fill="#333">Discovery</text>
                    <text x="270" y="275" text-anchor="middle" font-size="12" fill="#333">Internal</text>
                    <text x="380" y="275" text-anchor="middle" font-size="12" fill="#333">External</text>
                    <text x="490" y="275" text-anchor="middle" font-size="12" fill="#333">Cross-platform</text>
                    
                    <!-- Y-axis labels -->
                    <text x="75" y="255" text-anchor="end" font-size="11" fill="#555">0%</text>
                    <text x="75" y="205" text-anchor="end" font-size="11" fill="#555">25%</text>
                    <text x="75" y="155" text-anchor="end" font-size="11" fill="#555">50%</text>
                    <text x="75" y="105" text-anchor="end" font-size="11" fill="#555">75%</text>
                    <text x="75" y="55" text-anchor="end" font-size="11" fill="#555">100%</text>
                    
                    <!-- Axis titles -->
                    <text x="325" y="295" text-anchor="middle" font-size="13" fill="#333">Validation Cohort</text>
                    <text x="30" y="140" text-anchor="middle" font-size="13" fill="#333" transform="rotate(-90 30 140)">Classification Accuracy</text>
                </svg>
            </div>

            <div class="key-points">
                <div class="key-points-title">Validation Best Practices:</div>
                <ul>
                    <li>Use completely independent datasets not involved in subtype discovery</li>
                    <li>Validate across different populations and ethnicities when possible</li>
                    <li>Test robustness across different technical platforms</li>
                    <li>Confirm both molecular characteristics and clinical associations</li>
                    <li>Report confidence intervals and uncertainty estimates</li>
                </ul>
            </div>

            <div class="subsection-title">Multi-Study Meta-Validation</div>
            
            <div class="visualization">
                <div class="viz-title">Forest Plot: Hazard Ratios Across Validation Studies</div>
                <svg width="100%" height="350" viewBox="0 0 600 350">
                    <!-- Reference line at HR = 1 -->
                    <line x1="300" y1="40" x2="300" y2="310" stroke="#999" stroke-width="2" stroke-dasharray="5,5"/>
                    
                    <!-- Study results -->
                    <!-- Study 1 -->
                    <line x1="240" y1="80" x2="340" y2="80" stroke="#1E64C8" stroke-width="2"/>
                    <circle cx="280" cy="80" r="8" fill="#1E64C8"/>
                    <text x="30" y="85" font-size="13" fill="#333">Discovery Cohort</text>
                    <text x="500" y="85" font-size="13" fill="#333" font-weight="bold">2.1 (1.6-2.8)</text>
                    
                    <!-- Study 2 -->
                    <line x1="250" y1="130" x2="350" y2="130" stroke="#1E64C8" stroke-width="2"/>
                    <circle cx="290" cy="130" r="8" fill="#1E64C8"/>
                    <text x="30" y="135" font-size="13" fill="#333">Validation 1 (USA)</text>
                    <text x="500" y="135" font-size="13" fill="#333" font-weight="bold">2.3 (1.7-3.2)</text>
                    
                    <!-- Study 3 -->
                    <line x1="245" y1="180" x2="335" y2="180" stroke="#1E64C8" stroke-width="2"/>
                    <circle cx="285" cy="180" r="8" fill="#1E64C8"/>
                    <text x="30" y="185" font-size="13" fill="#333">Validation 2 (Europe)</text>
                    <text x="500" y="185" font-size="13" fill="#333" font-weight="bold">2.0 (1.5-2.7)</text>
                    
                    <!-- Study 4 -->
                    <line x1="235" y1="230" x2="345" y2="230" stroke="#1E64C8" stroke-width="2"/>
                    <circle cx="275" cy="230" r="8" fill="#1E64C8"/>
                    <text x="30" y="235" font-size="13" fill="#333">Validation 3 (Asia)</text>
                    <text x="500" y="235" font-size="13" fill="#333" font-weight="bold">1.9 (1.4-2.6)</text>
                    
                    <!-- Meta-analysis diamond -->
                    <path d="M 280 280 L 250 265 L 280 250 L 310 265 Z" fill="#e74c3c" opacity="0.8"/>
                    <text x="30" y="270" font-size="14" fill="#e74c3c" font-weight="bold">Meta-Analysis</text>
                    <text x="500" y="270" font-size="14" fill="#e74c3c" font-weight="bold">2.1 (1.8-2.5)</text>
                    
                    <!-- Axis labels -->
                    <text x="200" y="330" text-anchor="middle" font-size="12" fill="#333">0.5</text>
                    <text x="300" y="330" text-anchor="middle" font-size="12" fill="#333">1.0</text>
                    <text x="400" y="330" text-anchor="middle" font-size="12" fill="#333">2.0</text>
                    <text x="300" y="25" text-anchor="middle" font-size="13" fill="#333" font-weight="bold">Hazard Ratio (95% CI)</text>
                    
                    <!-- Favors annotations -->
                    <text x="150" y="315" font-size="11" fill="#555" font-style="italic">Favors Treatment</text>
                    <text x="380" y="315" font-size="11" fill="#555" font-style="italic">Favors Control</text>
                </svg>
            </div>

            <div class="example-box">
                <div class="example-title">Real-World Validation Success:</div>
                The intrinsic subtypes of breast cancer (Basal, HER2-enriched, Luminal A, Luminal B) were initially discovered in a cohort of 85 tumors using hierarchical clustering of gene expression. These subtypes have since been validated in over 50 independent cohorts comprising more than 10,000 patients worldwide, across multiple platforms including microarrays, RNA-seq, and targeted gene panels. The consistency of prognostic associations across all these studies demonstrates the biological and clinical validity of these subtypes.
            </div>

            <div class="key-points">
                <div class="key-points-title">Challenges in Validation:</div>
                <ul>
                    <li>Batch effects between discovery and validation cohorts must be addressed</li>
                    <li>Different platforms may require careful normalization and feature mapping</li>
                    <li>Sample size in validation cohorts should be adequate for statistical power</li>
                    <li>Publication bias may lead to overestimation of validation success rates</li>
                </ul>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="detail-section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-left: none;">
            <div class="section-title" style="color: white;">
                <span class="section-number" style="background: white; color: #667eea;">✓</span>
                Summary and Best Practices
            </div>
            
            <div class="section-content" style="color: white;">
                <p>Successful disease subtyping requires a systematic approach that integrates molecular data, ensures robustness through consensus methods, validates stability, and confirms findings in independent cohorts. The ultimate goal is to identify clinically actionable subtypes that improve patient stratification and treatment selection.</p>
            </div>

            <div class="subsection-title" style="color: white;">Key Takeaways:</div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin: 20px 0;">
                <ol style="color: white; line-height: 2; font-size: 15px; padding-left: 20px;">
                    <li><strong>Multi-omics integration</strong> provides comprehensive molecular characterization</li>
                    <li><strong>Clinical correlation</strong> ensures subtypes have practical relevance</li>
                    <li><strong>Consensus clustering</strong> improves robustness and reliability</li>
                    <li><strong>Stability analysis</strong> distinguishes real subtypes from artifacts</li>
                    <li><strong>Independent validation</strong> confirms generalizability across populations</li>
                </ol>
            </div>

            <div class="subsection-title" style="color: white;">Future Directions:</div>
            
            <div style="color: white; line-height: 1.8;">
                <p>Emerging approaches include single-cell multi-omics for higher resolution subtyping, machine learning methods for integrating diverse data types, spatial transcriptomics for tissue architecture analysis, and real-time subtype classification for clinical decision support systems.</p>
            </div>
        </div>

    </div>
</body>
</html>