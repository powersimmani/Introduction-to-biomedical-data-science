<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docking Simulation - Detailed</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        .container {
            width: 960px;
            background: white;
        }
        
        .slide {
            width: 960px;
            min-height: 540px;
            padding: 40px 60px;
            background: white;
            margin-bottom: 60px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        
        .title {
            font-size: 36px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 25px;
            text-align: center;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 3px solid #1E64C8;
            padding-bottom: 10px;
        }

        .subsection-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin: 20px 0 12px 0;
            padding-left: 12px;
            border-left: 4px solid #1E64C8;
        }
        
        .main-visual {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
        }
        
        .content-card {
            background: #f8f9fa;
            border-left: 4px solid #1E64C8;
            border-radius: 8px;
            padding: 14px 20px;
            transition: all 0.3s;
        }
        
        .content-card:hover {
            background: #e8f2ff;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(30, 100, 200, 0.15);
        }
        
        .content-main {
            font-size: 18px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 4px;
        }
        
        .content-desc {
            font-size: 14px;
            color: #555;
            font-weight: 400;
        }

        .detail-section {
            display: flex;
            gap: 30px;
            margin-bottom: 25px;
            align-items: flex-start;
        }

        .detail-visual {
            flex: 0 0 380px;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #e0e0e0;
        }

        .detail-text {
            flex: 1;
        }

        .detail-text p {
            font-size: 15px;
            line-height: 1.7;
            color: #2c3e50;
            margin-bottom: 12px;
            text-align: justify;
        }

        .detail-text ul {
            margin-left: 25px;
            margin-bottom: 12px;
        }

        .detail-text li {
            font-size: 14px;
            line-height: 1.6;
            color: #34495e;
            margin-bottom: 8px;
        }

        .highlight-box {
            background: #e8f4f8;
            border-left: 4px solid #1E64C8;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .highlight-box p {
            font-size: 14px;
            color: #1E64C8;
            font-weight: 500;
            margin: 0;
        }

        .ligand {
            animation: dock 3s ease-in-out infinite;
        }

        @keyframes dock {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(10px, -5px) rotate(5deg); }
        }

        .binding-energy {
            animation: pulse-energy 2s ease-in-out infinite;
        }

        @keyframes pulse-energy {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        .process-step {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Slide 1: Overview -->
        <div class="slide">
            <div class="title">Docking Simulation</div>
            
            <div class="main-visual">
                <!-- Left side: Protein structure -->
                <svg width="420" height="200" viewBox="0 0 420 200">
                    <!-- Protein pocket -->
                    <g>
                        <!-- Alpha helix representation -->
                        <ellipse cx="150" cy="100" rx="100" ry="80" fill="#e8f4f8" stroke="#1E64C8" stroke-width="3" opacity="0.3"/>
                        
                        <!-- Helix ribbons -->
                        <path d="M 80 60 Q 120 50, 150 60 T 220 60" fill="none" stroke="#64b5f6" stroke-width="8" opacity="0.7"/>
                        <path d="M 80 80 Q 120 70, 150 80 T 220 80" fill="none" stroke="#42a5f5" stroke-width="8" opacity="0.7"/>
                        <path d="M 80 100 Q 120 90, 150 100 T 220 100" fill="none" stroke="#2196f3" stroke-width="8" opacity="0.7"/>
                        <path d="M 80 120 Q 120 110, 150 120 T 220 120" fill="none" stroke="#1e88e5" stroke-width="8" opacity="0.7"/>
                        <path d="M 80 140 Q 120 130, 150 140 T 220 140" fill="none" stroke="#1976d2" stroke-width="8" opacity="0.7"/>
                        
                        <!-- Binding pocket (darker area) -->
                        <ellipse cx="150" cy="100" rx="50" ry="40" fill="#1E64C8" opacity="0.2"/>
                        <text x="150" y="105" text-anchor="middle" font-size="12" font-weight="600" fill="#1E64C8">Binding Site</text>
                        
                        <!-- Key residues -->
                        <circle cx="120" cy="85" r="6" fill="#e74c3c"/>
                        <text x="105" y="78" font-size="9" fill="#666">Lys</text>
                        
                        <circle cx="180" cy="95" r="6" fill="#3498db"/>
                        <text x="188" y="98" font-size="9" fill="#666">Asp</text>
                        
                        <circle cx="150" cy="120" r="6" fill="#2ecc71"/>
                        <text x="135" y="135" font-size="9" fill="#666">Ser</text>
                    </g>

                    <!-- Protein label -->
                    <text x="150" y="30" text-anchor="middle" font-size="14" font-weight="600" fill="#1E64C8">Protein Target</text>
                    <text x="150" y="180" text-anchor="middle" font-size="11" fill="#666">3D Structure</text>
                </svg>

                <!-- Center: Docking process arrow -->
                <svg width="80" height="200" viewBox="0 0 80 200">
                    <g>
                        <line x1="40" y1="70" x2="40" y2="130" stroke="#f39c12" stroke-width="4" marker-end="url(#arrow-dock)"/>
                        <text x="40" y="60" text-anchor="middle" font-size="12" font-weight="600" fill="#f39c12">Docking</text>
                        <text x="40" y="150" text-anchor="middle" font-size="10" fill="#666">Pose</text>
                        <text x="40" y="163" text-anchor="middle" font-size="10" fill="#666">Sampling</text>
                    </g>
                    
                    <defs>
                        <marker id="arrow-dock" markerWidth="12" markerHeight="12" refX="10" refY="3" orient="auto">
                            <polygon points="0 0, 12 3, 0 6" fill="#f39c12"/>
                        </marker>
                    </defs>
                </svg>

                <!-- Right side: Ligand -->
                <svg width="340" height="200" viewBox="0 0 340 200">
                    <g class="ligand">
                        <!-- Small molecule ligand -->
                        <g transform="translate(120, 80)">
                            <!-- Benzene ring -->
                            <polygon points="50,30 70,40 70,60 50,70 30,60 30,40" fill="none" stroke="#2c3e50" stroke-width="2.5"/>
                            
                            <!-- Atoms -->
                            <circle cx="50" cy="30" r="7" fill="#95a5a6"/>
                            <circle cx="70" cy="40" r="7" fill="#95a5a6"/>
                            <circle cx="70" cy="60" r="7" fill="#95a5a6"/>
                            <circle cx="50" cy="70" r="7" fill="#95a5a6"/>
                            <circle cx="30" cy="60" r="7" fill="#95a5a6"/>
                            <circle cx="30" cy="40" r="7" fill="#95a5a6"/>
                            
                            <!-- Functional groups -->
                            <line x1="50" y1="30" x2="50" y2="10" stroke="#2c3e50" stroke-width="2"/>
                            <circle cx="50" cy="10" r="8" fill="#e74c3c"/>
                            <text x="50" y="14" text-anchor="middle" font-size="10" fill="white" font-weight="bold">O</text>
                            
                            <line x1="70" y1="60" x2="88" y2="68" stroke="#2c3e50" stroke-width="2"/>
                            <circle cx="88" cy="68" r="8" fill="#3498db"/>
                            <text x="88" y="72" text-anchor="middle" font-size="10" fill="white" font-weight="bold">N</text>
                            
                            <!-- Hydrogen bonds (dashed lines) -->
                            <line x1="50" y1="10" x2="20" y2="-10" stroke="#e74c3c" stroke-width="2" stroke-dasharray="4,2" opacity="0.6"/>
                            <text x="10" y="-10" font-size="9" fill="#e74c3c">H-bond</text>
                        </g>
                        
                        <!-- Binding energy indicator -->
                        <g class="binding-energy">
                            <rect x="10" y="140" width="180" height="40" rx="6" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
                            <text x="100" y="158" text-anchor="middle" font-size="12" font-weight="600" fill="#155724">ΔG = -8.5 kcal/mol</text>
                            <text x="100" y="173" text-anchor="middle" font-size="10" fill="#666">Binding Affinity</text>
                        </g>
                    </g>
                    
                    <!-- Ligand label -->
                    <text x="170" y="30" text-anchor="middle" font-size="14" font-weight="600" fill="#2c3e50">Drug Molecule</text>
                </svg>
            </div>

            <!-- Scoring function visualization -->
            <div style="text-align: center; margin-bottom: 15px;">
                <svg width="860" height="40" viewBox="0 0 860 40">
                    <rect x="50" y="5" width="760" height="30" rx="5" fill="#f8f9fa" stroke="#1E64C8" stroke-width="2"/>
                    <text x="430" y="26" text-anchor="middle" font-size="13" font-weight="600" fill="#1E64C8">Scoring: vdW + Electrostatic + H-bonds + Solvation + Entropy</text>
                </svg>
            </div>
            
            <div class="content-grid">
                <div class="content-card">
                    <div class="content-main">Protein preparation</div>
                    <div class="content-desc">Structure optimization</div>
                </div>
                <div class="content-card">
                    <div class="content-main">Binding site detection</div>
                    <div class="content-desc">Active site identification</div>
                </div>
                <div class="content-card">
                    <div class="content-main">Conformational sampling</div>
                    <div class="content-desc">Exploring binding modes</div>
                </div>
                <div class="content-card">
                    <div class="content-main">Scoring functions</div>
                    <div class="content-desc">Binding affinity estimation</div>
                </div>
                <div class="content-card">
                    <div class="content-main">Induced fit</div>
                    <div class="content-desc">Protein flexibility modeling</div>
                </div>
            </div>
        </div>

        <!-- Slide 2: Protein Preparation -->
        <div class="slide">
            <div class="section-title">1. Protein Preparation</div>
            
            <div class="detail-section">
                <div class="detail-visual">
                    <svg width="340" height="280" viewBox="0 0 340 280">
                        <!-- Raw structure -->
                        <g>
                            <text x="170" y="20" text-anchor="middle" font-size="14" font-weight="600" fill="#e74c3c">Raw PDB Structure</text>
                            <ellipse cx="80" cy="80" rx="60" ry="50" fill="#e8f4f8" stroke="#e74c3c" stroke-width="2" opacity="0.5"/>
                            
                            <!-- Missing residues -->
                            <path d="M 40 60 Q 60 55, 80 60" fill="none" stroke="#e74c3c" stroke-width="4" stroke-dasharray="5,5"/>
                            <text x="60" y="50" font-size="10" fill="#e74c3c">Missing</text>
                            
                            <!-- Water molecules -->
                            <circle cx="100" cy="70" r="4" fill="#3498db" opacity="0.7"/>
                            <circle cx="110" cy="85" r="4" fill="#3498db" opacity="0.7"/>
                            <circle cx="95" cy="95" r="4" fill="#3498db" opacity="0.7"/>
                            <text x="120" y="85" font-size="9" fill="#3498db">H₂O</text>
                            
                            <!-- Wrong protonation -->
                            <circle cx="50" cy="90" r="6" fill="#f39c12"/>
                            <text x="35" y="108" font-size="9" fill="#f39c12">Wrong H</text>
                        </g>

                        <!-- Arrow -->
                        <g>
                            <line x1="170" y1="80" x2="230" y2="80" stroke="#2ecc71" stroke-width="3" marker-end="url(#arrow-prep)"/>
                            <text x="200" y="70" text-anchor="middle" font-size="11" font-weight="600" fill="#2ecc71">Process</text>
                        </g>

                        <!-- Prepared structure -->
                        <g>
                            <text x="170" y="130" text-anchor="middle" font-size="14" font-weight="600" fill="#2ecc71">Prepared Structure</text>
                            <ellipse cx="260" cy="190" rx="60" ry="50" fill="#e8f4f8" stroke="#2ecc71" stroke-width="2" opacity="0.5"/>
                            
                            <!-- Complete structure -->
                            <path d="M 220 170 Q 240 165, 260 170 T 300 170" fill="none" stroke="#2ecc71" stroke-width="4"/>
                            <path d="M 220 190 Q 240 185, 260 190 T 300 190" fill="none" stroke="#2ecc71" stroke-width="4"/>
                            <path d="M 220 210 Q 240 205, 260 210 T 300 210" fill="none" stroke="#2ecc71" stroke-width="4"/>
                            
                            <!-- Optimized -->
                            <circle cx="240" cy="200" r="6" fill="#27ae60"/>
                            <text x="225" y="225" font-size="9" fill="#27ae60">Optimized</text>
                            
                            <text x="260" y="260" text-anchor="middle" font-size="10" fill="#666">✓ Complete</text>
                            <text x="260" y="273" text-anchor="middle" font-size="10" fill="#666">✓ Correct pH</text>
                        </g>

                        <defs>
                            <marker id="arrow-prep" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#2ecc71"/>
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="detail-text">
                    <div class="process-step">Step 1: Structure Optimization</div>
                    <p>Protein preparation is the critical first step in molecular docking that ensures the structural integrity and chemical accuracy of the target protein. This process transforms raw crystallographic data into a computationally viable model for docking simulations.</p>
                    
                    <div class="subsection-title">Key Procedures:</div>
                    <ul>
                        <li><strong>Addition of missing atoms:</strong> Crystal structures often lack hydrogen atoms and may have missing side chains or loops. These must be computationally reconstructed to create a complete model.</li>
                        <li><strong>Protonation state assignment:</strong> Correct protonation states for ionizable residues (His, Asp, Glu, Lys, Arg) are assigned based on the target pH, typically pH 7.4 for physiological conditions.</li>
                        <li><strong>Removal of crystallographic waters:</strong> Water molecules are evaluated and removed unless they play crucial structural or functional roles in the binding site.</li>
                        <li><strong>Energy minimization:</strong> The structure undergoes geometric optimization to relieve steric clashes and achieve energetically favorable conformations.</li>
                    </ul>

                    <div class="highlight-box">
                        <p><strong>Impact:</strong> Proper protein preparation can improve docking accuracy by 30-40% and is essential for obtaining reliable binding predictions.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Binding Site Detection -->
        <div class="slide">
            <div class="section-title">2. Binding Site Detection</div>
            
            <div class="detail-section">
                <div class="detail-visual">
                    <svg width="340" height="300" viewBox="0 0 340 300">
                        <!-- Protein surface -->
                        <g>
                            <text x="170" y="20" text-anchor="middle" font-size="14" font-weight="600" fill="#1E64C8">Protein Surface Analysis</text>
                            
                            <!-- Surface representation -->
                            <ellipse cx="170" cy="120" rx="140" ry="100" fill="#e8f4f8" stroke="#1E64C8" stroke-width="2" opacity="0.3"/>
                            
                            <!-- Multiple pockets -->
                            <g opacity="0.4">
                                <ellipse cx="100" cy="90" rx="25" ry="20" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2"/>
                                <text x="100" y="95" text-anchor="middle" font-size="9" fill="#555">Pocket 1</text>
                            </g>
                            
                            <g opacity="0.4">
                                <ellipse cx="230" cy="100" rx="22" ry="18" fill="#95a5a6" stroke="#7f8c8d" stroke-width="2"/>
                                <text x="230" y="105" text-anchor="middle" font-size="9" fill="#555">Pocket 2</text>
                            </g>
                            
                            <!-- Active binding site (highlighted) -->
                            <g>
                                <ellipse cx="170" cy="140" rx="40" ry="35" fill="#f39c12" stroke="#e67e22" stroke-width="3" opacity="0.5"/>
                                <text x="170" y="143" text-anchor="middle" font-size="11" font-weight="600" fill="#d35400">Active Site</text>
                                
                                <!-- Key features -->
                                <circle cx="150" cy="130" r="5" fill="#e74c3c"/>
                                <text x="138" y="125" font-size="8" fill="#c0392b">Asp</text>
                                
                                <circle cx="190" cy="135" r="5" fill="#3498db"/>
                                <text x="198" y="138" font-size="8" fill="#2980b9">His</text>
                                
                                <circle cx="170" cy="160" r="5" fill="#2ecc71"/>
                                <text x="155" y="173" font-size="8" fill="#27ae60">Ser</text>
                            </g>
                            
                            <!-- Grid representation -->
                            <g opacity="0.3">
                                <line x1="130" y1="105" x2="210" y2="105" stroke="#1E64C8" stroke-width="1" stroke-dasharray="2,2"/>
                                <line x1="130" y1="125" x2="210" y2="125" stroke="#1E64C8" stroke-width="1" stroke-dasharray="2,2"/>
                                <line x1="130" y1="145" x2="210" y2="145" stroke="#1E64C8" stroke-width="1" stroke-dasharray="2,2"/>
                                <line x1="130" y1="165" x2="210" y2="165" stroke="#1E64C8" stroke-width="1" stroke-dasharray="2,2"/>
                                <line x1="130" y1="185" x2="210" y2="185" stroke="#1E64C8" stroke-width="1" stroke-dasharray="2,2"/>
                            </g>
                        </g>

                        <!-- Detection methods -->
                        <g transform="translate(0, 210)">
                            <rect x="20" y="0" width="100" height="60" rx="5" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
                            <text x="70" y="20" text-anchor="middle" font-size="11" font-weight="600" fill="#155724">Geometric</text>
                            <text x="70" y="35" text-anchor="middle" font-size="9" fill="#155724">Cavity detection</text>
                            <text x="70" y="48" text-anchor="middle" font-size="9" fill="#155724">Surface analysis</text>

                            <rect x="130" y="0" width="100" height="60" rx="5" fill="#cce5ff" stroke="#0066cc" stroke-width="2"/>
                            <text x="180" y="20" text-anchor="middle" font-size="11" font-weight="600" fill="#004080">Energetic</text>
                            <text x="180" y="35" text-anchor="middle" font-size="9" fill="#004080">Grid-based</text>
                            <text x="180" y="48" text-anchor="middle" font-size="9" fill="#004080">scoring</text>

                            <rect x="240" y="0" width="80" height="60" rx="5" fill="#fff3cd" stroke="#ff9800" stroke-width="2"/>
                            <text x="280" y="20" text-anchor="middle" font-size="11" font-weight="600" fill="#b36200">Structural</text>
                            <text x="280" y="35" text-anchor="middle" font-size="9" fill="#b36200">Conservation</text>
                            <text x="280" y="48" text-anchor="middle" font-size="9" fill="#b36200">analysis</text>
                        </g>
                    </svg>
                </div>

                <div class="detail-text">
                    <div class="process-step">Step 2: Active Site Identification</div>
                    <p>Binding site detection identifies the regions on the protein surface where ligands are most likely to bind. Accurate identification of the active site is crucial for focused docking simulations and drug discovery efforts.</p>
                    
                    <div class="subsection-title">Detection Approaches:</div>
                    <ul>
                        <li><strong>Geometric methods:</strong> Algorithms like LIGSITE and SURFNET detect cavities and pockets based on geometric properties of the protein surface, identifying concave regions that can accommodate ligands.</li>
                        <li><strong>Energetic approaches:</strong> Grid-based methods calculate interaction energies with probe atoms across the protein surface, identifying energetically favorable binding regions.</li>
                        <li><strong>Knowledge-based methods:</strong> These utilize evolutionary conservation analysis and structural comparisons with known binding sites to predict likely active sites.</li>
                        <li><strong>Experimental validation:</strong> When available, experimental data from co-crystallized ligands or site-directed mutagenesis confirms predicted binding sites.</li>
                    </ul>

                    <div class="highlight-box">
                        <p><strong>Best Practice:</strong> Combine multiple detection methods for consensus prediction. Consider binding site druggability scores to prioritize pharmaceutically relevant pockets.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: Conformational Sampling -->
        <div class="slide">
            <div class="section-title">3. Conformational Sampling</div>
            
            <div class="detail-section">
                <div class="detail-visual">
                    <svg width="340" height="300" viewBox="0 0 340 300">
                        <text x="170" y="20" text-anchor="middle" font-size="14" font-weight="600" fill="#9b59b6">Exploring Binding Poses</text>
                        
                        <!-- Search space visualization -->
                        <g>
                            <!-- Grid box representing search space -->
                            <rect x="50" y="40" width="240" height="180" rx="8" fill="#f3e5f5" stroke="#9b59b6" stroke-width="2" opacity="0.3"/>
                            <text x="170" y="60" text-anchor="middle" font-size="10" fill="#8e44ad">Search Space</text>
                            
                            <!-- Multiple ligand poses -->
                            <g transform="translate(80, 90)" opacity="0.6">
                                <polygon points="20,10 30,15 30,25 20,30 10,25 10,15" fill="none" stroke="#e74c3c" stroke-width="2"/>
                                <circle cx="20" cy="10" r="3" fill="#e74c3c"/>
                                <text x="35" y="22" font-size="8" fill="#c0392b">Pose 1</text>
                            </g>
                            
                            <g transform="translate(150, 80) rotate(30)" opacity="0.6">
                                <polygon points="20,10 30,15 30,25 20,30 10,25 10,15" fill="none" stroke="#3498db" stroke-width="2"/>
                                <circle cx="20" cy="10" r="3" fill="#3498db"/>
                                <text x="25" y="0" font-size="8" fill="#2980b9">Pose 2</text>
                            </g>
                            
                            <g transform="translate(200, 110) rotate(-20)" opacity="0.6">
                                <polygon points="20,10 30,15 30,25 20,30 10,25 10,15" fill="none" stroke="#f39c12" stroke-width="2"/>
                                <circle cx="20" cy="10" r="3" fill="#f39c12"/>
                                <text x="35" y="22" font-size="8" fill="#e67e22">Pose 3</text>
                            </g>
                            
                            <!-- Best pose (highlighted) -->
                            <g transform="translate(120, 130)">
                                <ellipse cx="20" cy="20" rx="35" ry="30" fill="#2ecc71" opacity="0.2"/>
                                <polygon points="20,10 30,15 30,25 20,30 10,25 10,15" fill="none" stroke="#2ecc71" stroke-width="3"/>
                                <circle cx="20" cy="10" r="4" fill="#2ecc71"/>
                                <circle cx="30" cy="15" r="4" fill="#2ecc71"/>
                                <circle cx="10" cy="25" r="4" fill="#2ecc71"/>
                                <text x="20" y="50" text-anchor="middle" font-size="9" font-weight="600" fill="#27ae60">Best Pose</text>
                                <text x="20" y="62" text-anchor="middle" font-size="8" fill="#27ae60">Lowest Energy</text>
                            </g>
                            
                            <!-- Binding pocket outline -->
                            <ellipse cx="140" cy="150" rx="50" ry="40" fill="none" stroke="#9b59b6" stroke-width="2" stroke-dasharray="4,2"/>
                        </g>

                        <!-- Sampling methods -->
                        <g transform="translate(20, 235)">
                            <rect x="0" y="0" width="90" height="50" rx="5" fill="#e1f5fe" stroke="#0277bd" stroke-width="2"/>
                            <text x="45" y="18" text-anchor="middle" font-size="10" font-weight="600" fill="#01579b">Systematic</text>
                            <text x="45" y="32" text-anchor="middle" font-size="8" fill="#01579b">Grid search</text>
                            <text x="45" y="43" text-anchor="middle" font-size="8" fill="#01579b">Incremental</text>

                            <rect x="100" y="0" width="90" height="50" rx="5" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2"/>
                            <text x="145" y="18" text-anchor="middle" font-size="10" font-weight="600" fill="#4a148c">Stochastic</text>
                            <text x="145" y="32" text-anchor="middle" font-size="8" fill="#4a148c">Monte Carlo</text>
                            <text x="145" y="43" text-anchor="middle" font-size="8" fill="#4a148c">Genetic Alg.</text>

                            <rect x="200" y="0" width="90" height="50" rx="5" fill="#fff3e0" stroke="#ef6c00" stroke-width="2"/>
                            <text x="245" y="18" text-anchor="middle" font-size="10" font-weight="600" fill="#bf360c">Hybrid</text>
                            <text x="245" y="32" text-anchor="middle" font-size="8" fill="#bf360c">Combined</text>
                            <text x="245" y="43" text-anchor="middle" font-size="8" fill="#bf360c">approaches</text>
                        </g>
                    </svg>
                </div>

                <div class="detail-text">
                    <div class="process-step">Step 3: Exploring Binding Modes</div>
                    <p>Conformational sampling is the process of exploring the vast space of possible ligand orientations, positions, and conformations within the binding site. This step generates diverse binding poses that are subsequently evaluated by scoring functions.</p>
                    
                    <div class="subsection-title">Sampling Strategies:</div>
                    <ul>
                        <li><strong>Systematic search:</strong> Exhaustively samples the conformational space using grid-based approaches. While thorough, this method becomes computationally expensive for flexible ligands with many rotatable bonds.</li>
                        <li><strong>Stochastic methods:</strong> Include Monte Carlo simulations, genetic algorithms (AutoDock), and simulated annealing. These methods randomly sample conformational space while biasing toward lower energy states.</li>
                        <li><strong>Incremental construction:</strong> Builds the ligand inside the binding site piece by piece (FlexX algorithm), anchoring core fragments and growing from them.</li>
                        <li><strong>Molecular dynamics:</strong> Uses physics-based simulations to explore binding pathways and conformational transitions in real-time.</li>
                    </ul>

                    <div class="highlight-box">
                        <p><strong>Challenge:</strong> The number of possible conformations grows exponentially with ligand flexibility. A molecule with 10 rotatable bonds can have millions of distinct conformations requiring efficient sampling strategies.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: Scoring Functions -->
        <div class="slide">
            <div class="section-title">4. Scoring Functions</div>
            
            <div class="detail-section">
                <div class="detail-visual">
                    <svg width="340" height="320" viewBox="0 0 340 320">
                        <text x="170" y="20" text-anchor="middle" font-size="14" font-weight="600" fill="#e67e22">Energy Components</text>
                        
                        <!-- Energy diagram -->
                        <g>
                            <!-- Total energy bar -->
                            <rect x="30" y="40" width="280" height="45" rx="5" fill="#2ecc71" opacity="0.8"/>
                            <text x="170" y="60" text-anchor="middle" font-size="12" font-weight="600" fill="white">Total Binding Energy</text>
                            <text x="170" y="75" text-anchor="middle" font-size="11" fill="white">ΔG = -8.5 kcal/mol</text>
                            
                            <!-- Component bars -->
                            <rect x="30" y="100" width="100" height="35" rx="4" fill="#3498db" opacity="0.7"/>
                            <text x="80" y="118" text-anchor="middle" font-size="10" font-weight="600" fill="white">vdW</text>
                            <text x="80" y="130" text-anchor="middle" font-size="9" fill="white">-4.2</text>
                            
                            <rect x="140" y="100" width="80" height="35" rx="4" fill="#9b59b6" opacity="0.7"/>
                            <text x="180" y="118" text-anchor="middle" font-size="10" font-weight="600" fill="white">Elec.</text>
                            <text x="180" y="130" text-anchor="middle" font-size="9" fill="white">-3.8</text>
                            
                            <rect x="230" y="100" width="80" height="35" rx="4" fill="#e74c3c" opacity="0.7"/>
                            <text x="270" y="118" text-anchor="middle" font-size="10" font-weight="600" fill="white">H-bond</text>
                            <text x="270" y="130" text-anchor="middle" font-size="9" fill="white">-2.1</text>
                            
                            <rect x="30" y="145" width="90" height="35" rx="4" fill="#f39c12" opacity="0.7"/>
                            <text x="75" y="163" text-anchor="middle" font-size="10" font-weight="600" fill="white">Solvation</text>
                            <text x="75" y="175" text-anchor="middle" font-size="9" fill="white">+1.8</text>
                            
                            <rect x="130" y="145" width="90" height="35" rx="4" fill="#95a5a6" opacity="0.7"/>
                            <text x="175" y="163" text-anchor="middle" font-size="10" font-weight="600" fill="white">Entropy</text>
                            <text x="175" y="175" text-anchor="middle" font-size="9" fill="white">+0.2</text>
                        </g>

                        <!-- Scoring function types -->
                        <g transform="translate(10, 200)">
                            <text x="160" y="0" text-anchor="middle" font-size="12" font-weight="600" fill="#2c3e50">Types of Scoring Functions</text>
                            
                            <rect x="10" y="15" width="100" height="85" rx="5" fill="#e8f8f5" stroke="#16a085" stroke-width="2"/>
                            <text x="60" y="33" text-anchor="middle" font-size="11" font-weight="600" fill="#117a65">Force-Field</text>
                            <text x="60" y="48" text-anchor="middle" font-size="8" fill="#145a50">Based on</text>
                            <text x="60" y="60" text-anchor="middle" font-size="8" fill="#145a50">physics</text>
                            <text x="60" y="72" text-anchor="middle" font-size="8" fill="#145a50">AMBER</text>
                            <text x="60" y="84" text-anchor="middle" font-size="8" fill="#145a50">CHARMM</text>
                            <text x="60" y="96" text-anchor="middle" font-size="8" fill="#145a50">OPLS</text>

                            <rect x="120" y="15" width="100" height="85" rx="5" fill="#fef5e7" stroke="#d68910" stroke-width="2"/>
                            <text x="170" y="33" text-anchor="middle" font-size="11" font-weight="600" fill="#7d4e00">Empirical</text>
                            <text x="170" y="48" text-anchor="middle" font-size="8" fill="#6b4400">Regression</text>
                            <text x="170" y="60" text-anchor="middle" font-size="8" fill="#6b4400">based</text>
                            <text x="170" y="72" text-anchor="middle" font-size="8" fill="#6b4400">ChemScore</text>
                            <text x="170" y="84" text-anchor="middle" font-size="8" fill="#6b4400">GlideScore</text>
                            <text x="170" y="96" text-anchor="middle" font-size="8" fill="#6b4400">X-Score</text>

                            <rect x="230" y="15" width="90" height="85" rx="5" fill="#ebf5fb" stroke="#2874a6" stroke-width="2"/>
                            <text x="275" y="33" text-anchor="middle" font-size="11" font-weight="600" fill="#1b4f72">ML-Based</text>
                            <text x="275" y="48" text-anchor="middle" font-size="8" fill="#154360">Machine</text>
                            <text x="275" y="60" text-anchor="middle" font-size="8" fill="#154360">learning</text>
                            <text x="275" y="72" text-anchor="middle" font-size="8" fill="#154360">RF-Score</text>
                            <text x="275" y="84" text-anchor="middle" font-size="8" fill="#154360">NNScore</text>
                            <text x="275" y="96" text-anchor="middle" font-size="8" fill="#154360">DeepScore</text>
                        </g>
                    </svg>
                </div>

                <div class="detail-text">
                    <div class="process-step">Step 4: Binding Affinity Estimation</div>
                    <p>Scoring functions evaluate the quality of generated binding poses by estimating the binding affinity between the protein and ligand. These mathematical models predict the free energy of binding (ΔG) to rank different poses and ligands.</p>
                    
                    <div class="subsection-title">Energy Components:</div>
                    <ul>
                        <li><strong>Van der Waals interactions:</strong> Short-range forces from induced dipole interactions, crucial for shape complementarity.</li>
                        <li><strong>Electrostatic interactions:</strong> Coulombic forces between charged and polar groups, important for specificity.</li>
                        <li><strong>Hydrogen bonding:</strong> Directional interactions between donors and acceptors, often key to binding specificity.</li>
                        <li><strong>Desolvation effects:</strong> Energy cost of removing water from protein and ligand surfaces during binding.</li>
                        <li><strong>Entropic penalty:</strong> Loss of conformational freedom upon binding, typically unfavorable.</li>
                    </ul>

                    <div class="subsection-title">Scoring Function Classes:</div>
                    <ul>
                        <li><strong>Force-field based:</strong> Use molecular mechanics potentials from established force fields (AMBER, CHARMM). Most accurate but computationally expensive.</li>
                        <li><strong>Empirical:</strong> Fit to experimental binding data using weighted energy terms. Fast and reasonably accurate (ChemScore, GlideScore).</li>
                        <li><strong>Knowledge-based:</strong> Derive potentials from statistical analysis of protein-ligand complexes.</li>
                        <li><strong>Machine learning:</strong> Train on large datasets to learn complex binding patterns (RF-Score, NNScore, deep learning approaches).</li>
                    </ul>

                    <div class="highlight-box">
                        <p><strong>Limitation:</strong> No single scoring function excels for all systems. Consensus scoring using multiple functions often improves prediction accuracy.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 6: Induced Fit -->
        <div class="slide">
            <div class="section-title">5. Induced Fit</div>
            
            <div class="detail-section">
                <div class="detail-visual">
                    <svg width="340" height="300" viewBox="0 0 340 300">
                        <text x="170" y="20" text-anchor="middle" font-size="14" font-weight="600" fill="#c0392b">Protein Flexibility</text>
                        
                        <!-- Before binding -->
                        <g>
                            <text x="85" y="50" text-anchor="middle" font-size="11" font-weight="600" fill="#34495e">Apo Structure</text>
                            <ellipse cx="85" cy="110" rx="50" ry="60" fill="#ecf0f1" stroke="#7f8c8d" stroke-width="2" opacity="0.5"/>
                            
                            <!-- Open binding pocket -->
                            <path d="M 50 95 Q 65 80, 85 85 Q 105 80, 120 95" fill="none" stroke="#95a5a6" stroke-width="3"/>
                            <path d="M 50 95 L 50 125" stroke="#95a5a6" stroke-width="3"/>
                            <path d="M 120 95 L 120 125" stroke="#95a5a6" stroke-width="3"/>
                            
                            <text x="85" y="115" text-anchor="middle" font-size="10" fill="#7f8c8d">Open</text>
                            <text x="85" y="150" text-anchor="middle" font-size="9" fill="#95a5a6">Unbound</text>
                        </g>

                        <!-- Arrow showing conformational change -->
                        <g>
                            <path d="M 140 110 Q 170 110, 200 110" fill="none" stroke="#e74c3c" stroke-width="3" marker-end="url(#arrow-fit)"/>
                            <text x="170" y="95" text-anchor="middle" font-size="10" font-weight="600" fill="#c0392b">Induced Fit</text>
                            <text x="170" y="130" text-anchor="middle" font-size="9" fill="#c0392b">Conformational</text>
                            <text x="170" y="142" text-anchor="middle" font-size="9" fill="#c0392b">Change</text>
                        </g>

                        <!-- After binding -->
                        <g>
                            <text x="255" y="50" text-anchor="middle" font-size="11" font-weight="600" fill="#34495e">Holo Structure</text>
                            <ellipse cx="255" cy="110" rx="50" ry="60" fill="#d5f4e6" stroke="#27ae60" stroke-width="2" opacity="0.5"/>
                            
                            <!-- Closed binding pocket with ligand -->
                            <path d="M 220 95 Q 235 105, 255 105 Q 275 105, 290 95" fill="none" stroke="#27ae60" stroke-width="3"/>
                            <path d="M 220 95 L 225 115" stroke="#27ae60" stroke-width="3"/>
                            <path d="M 290 95 L 285 115" stroke="#27ae60" stroke-width="3"/>
                            
                            <!-- Ligand inside -->
                            <polygon points="255,108 265,112 265,118 255,122 245,118 245,112" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
                            
                            <text x="255" y="140" text-anchor="middle" font-size="10" fill="#27ae60">Closed</text>
                            <text x="255" y="150" text-anchor="middle" font-size="9" fill="#27ae60">Bound</text>
                        </g>

                        <!-- Flexibility modeling approaches -->
                        <g transform="translate(10, 190)">
                            <text x="160" y="0" text-anchor="middle" font-size="12" font-weight="600" fill="#2c3e50">Flexibility Modeling</text>
                            
                            <rect x="10" y="15" width="95" height="75" rx="5" fill="#fdecea" stroke="#c0392b" stroke-width="2"/>
                            <text x="57" y="32" text-anchor="middle" font-size="10" font-weight="600" fill="#922b21">Side Chain</text>
                            <text x="57" y="46" text-anchor="middle" font-size="8" fill="#7b241c">Rotamer</text>
                            <text x="57" y="58" text-anchor="middle" font-size="8" fill="#7b241c">libraries</text>
                            <text x="57" y="70" text-anchor="middle" font-size="8" fill="#7b241c">Discrete</text>
                            <text x="57" y="82" text-anchor="middle" font-size="8" fill="#7b241c">sampling</text>

                            <rect x="115" y="15" width="95" height="75" rx="5" fill="#ebf5fb" stroke="#2874a6" stroke-width="2"/>
                            <text x="162" y="32" text-anchor="middle" font-size="10" font-weight="600" fill="#1b4f72">Backbone</text>
                            <text x="162" y="46" text-anchor="middle" font-size="8" fill="#154360">Loop</text>
                            <text x="162" y="58" text-anchor="middle" font-size="8" fill="#154360">refinement</text>
                            <text x="162" y="70" text-anchor="middle" font-size="8" fill="#154360">Domain</text>
                            <text x="162" y="82" text-anchor="middle" font-size="8" fill="#154360">motion</text>

                            <rect x="220" y="15" width="95" height="75" rx="5" fill="#f4ecf7" stroke="#7d3c98" stroke-width="2"/>
                            <text x="267" y="32" text-anchor="middle" font-size="10" font-weight="600" fill="#4a235a">Full System</text>
                            <text x="267" y="46" text-anchor="middle" font-size="8" fill="#4a235a">Ensemble</text>
                            <text x="267" y="58" text-anchor="middle" font-size="8" fill="#4a235a">docking</text>
                            <text x="267" y="70" text-anchor="middle" font-size="8" fill="#4a235a">MD-based</text>
                            <text x="267" y="82" text-anchor="middle" font-size="8" fill="#4a235a">refinement</text>
                        </g>

                        <defs>
                            <marker id="arrow-fit" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#e74c3c"/>
                            </marker>
                        </defs>
                    </svg>
                </div>

                <div class="detail-text">
                    <div class="process-step">Step 5: Protein Flexibility Modeling</div>
                    <p>The induced fit model recognizes that both proteins and ligands undergo conformational changes upon binding. Unlike the older "lock-and-key" model, induced fit acknowledges that proteins are dynamic structures that adapt their shape to accommodate ligands.</p>
                    
                    <div class="subsection-title">Flexibility Levels:</div>
                    <ul>
                        <li><strong>Rigid docking:</strong> Simplest approach treating both protein and ligand as rigid bodies. Fast but ignores conformational adaptation.</li>
                        <li><strong>Semi-flexible docking:</strong> Ligand is flexible while protein remains rigid. Most common approach as it balances accuracy and speed.</li>
                        <li><strong>Side-chain flexibility:</strong> Selected binding site residues can sample rotamers from libraries, allowing for local adjustments.</li>
                        <li><strong>Backbone flexibility:</strong> Models larger conformational changes including loop movements and domain rearrangements, computationally intensive.</li>
                        <li><strong>Ensemble docking:</strong> Uses multiple protein conformations from MD simulations or experimental structures, capturing the full conformational landscape.</li>
                    </ul>

                    <div class="subsection-title">Implementation Strategies:</div>
                    <ul>
                        <li><strong>Soft potentials:</strong> Use softened van der Waals potentials to allow some overlap, implicitly modeling flexibility.</li>
                        <li><strong>Refinement protocols:</strong> Initial docking followed by energy minimization or short MD simulations to optimize the complex.</li>
                        <li><strong>Template-based:</strong> Use known conformational states from homologous proteins or different crystal structures.</li>
                    </ul>

                    <div class="highlight-box">
                        <p><strong>Key Insight:</strong> Accounting for induced fit can dramatically improve docking accuracy, particularly for systems with large conformational changes. However, it increases computational cost exponentially.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Final Summary Slide -->
        <div class="slide">
            <div class="section-title">Docking Workflow Summary</div>
            
            <div style="margin-top: 30px;">
                <svg width="840" height="380" viewBox="0 0 840 380">
                    <!-- Workflow diagram -->
                    <g>
                        <!-- Step 1 -->
                        <rect x="20" y="20" width="140" height="80" rx="8" fill="#e8f8f5" stroke="#16a085" stroke-width="3"/>
                        <text x="90" y="45" text-anchor="middle" font-size="13" font-weight="600" fill="#117a65">1. Preparation</text>
                        <text x="90" y="65" text-anchor="middle" font-size="10" fill="#145a50">• Add hydrogens</text>
                        <text x="90" y="80" text-anchor="middle" font-size="10" fill="#145a50">• Assign charges</text>
                        <text x="90" y="95" text-anchor="middle" font-size="10" fill="#145a50">• Optimize geometry</text>

                        <!-- Arrow -->
                        <line x1="160" y1="60" x2="200" y2="60" stroke="#2c3e50" stroke-width="3" marker-end="url(#arrow-sum)"/>

                        <!-- Step 2 -->
                        <rect x="200" y="20" width="140" height="80" rx="8" fill="#fef5e7" stroke="#d68910" stroke-width="3"/>
                        <text x="270" y="45" text-anchor="middle" font-size="13" font-weight="600" fill="#7d4e00">2. Site Detection</text>
                        <text x="270" y="65" text-anchor="middle" font-size="10" fill="#6b4400">• Find cavities</text>
                        <text x="270" y="80" text-anchor="middle" font-size="10" fill="#6b4400">• Define grid box</text>
                        <text x="270" y="95" text-anchor="middle" font-size="10" fill="#6b4400">• Set constraints</text>

                        <!-- Arrow -->
                        <line x1="340" y1="60" x2="380" y2="60" stroke="#2c3e50" stroke-width="3" marker-end="url(#arrow-sum)"/>

                        <!-- Step 3 -->
                        <rect x="380" y="20" width="140" height="80" rx="8" fill="#f4ecf7" stroke="#7d3c98" stroke-width="3"/>
                        <text x="450" y="45" text-anchor="middle" font-size="13" font-weight="600" fill="#4a235a">3. Sampling</text>
                        <text x="450" y="65" text-anchor="middle" font-size="10" fill="#4a235a">• Generate poses</text>
                        <text x="450" y="80" text-anchor="middle" font-size="10" fill="#4a235a">• Search space</text>
                        <text x="450" y="95" text-anchor="middle" font-size="10" fill="#4a235a">• Conformations</text>

                        <!-- Arrow -->
                        <line x1="520" y1="60" x2="560" y2="60" stroke="#2c3e50" stroke-width="3" marker-end="url(#arrow-sum)"/>

                        <!-- Step 4 -->
                        <rect x="560" y="20" width="140" height="80" rx="8" fill="#ebf5fb" stroke="#2874a6" stroke-width="3"/>
                        <text x="630" y="45" text-anchor="middle" font-size="13" font-weight="600" fill="#1b4f72">4. Scoring</text>
                        <text x="630" y="65" text-anchor="middle" font-size="10" fill="#154360">• Rank poses</text>
                        <text x="630" y="80" text-anchor="middle" font-size="10" fill="#154360">• Energy terms</text>
                        <text x="630" y="95" text-anchor="middle" font-size="10" fill="#154360">• Predict affinity</text>

                        <!-- Arrow down -->
                        <line x1="630" y1="100" x2="630" y2="140" stroke="#2c3e50" stroke-width="3" marker-end="url(#arrow-sum)"/>

                        <!-- Step 5 -->
                        <rect x="560" y="140" width="140" height="80" rx="8" fill="#fdecea" stroke="#c0392b" stroke-width="3"/>
                        <text x="630" y="165" text-anchor="middle" font-size="13" font-weight="600" fill="#922b21">5. Refinement</text>
                        <text x="630" y="185" text-anchor="middle" font-size="10" fill="#7b241c">• Induced fit</text>
                        <text x="630" y="200" text-anchor="middle" font-size="10" fill="#7b241c">• Flexibility</text>
                        <text x="630" y="215" text-anchor="middle" font-size="10" fill="#7b241c">• Optimization</text>

                        <!-- Arrow to result -->
                        <line x1="560" y1="180" x2="400" y2="180" stroke="#27ae60" stroke-width="4" marker-end="url(#arrow-result)"/>

                        <!-- Final result -->
                        <rect x="180" y="140" width="220" height="80" rx="8" fill="#d5f4e6" stroke="#27ae60" stroke-width="4"/>
                        <text x="290" y="165" text-anchor="middle" font-size="15" font-weight="700" fill="#196f3d">Final Complex</text>
                        <text x="290" y="185" text-anchor="middle" font-size="11" fill="#145a32">✓ Optimized binding mode</text>
                        <text x="290" y="200" text-anchor="middle" font-size="11" fill="#145a32">✓ Predicted affinity</text>
                        <text x="290" y="215" text-anchor="middle" font-size="11" fill="#145a32">✓ Interaction profile</text>
                    </g>

                    <!-- Key considerations box -->
                    <rect x="50" y="250" width="740" height="110" rx="8" fill="#fff9e6" stroke="#f39c12" stroke-width="3"/>
                    <text x="420" y="275" text-anchor="middle" font-size="14" font-weight="700" fill="#b36200">Critical Success Factors</text>
                    
                    <text x="70" y="300" font-size="11" fill="#6b4400">• <tspan font-weight="600">Accuracy:</tspan> Balance between speed and precision - choose appropriate methods for your system</text>
                    <text x="70" y="318" font-size="11" fill="#6b4400">• <tspan font-weight="600">Validation:</tspan> Always validate predictions with experimental data when available</text>
                    <text x="70" y="336" font-size="11" fill="#6b4400">• <tspan font-weight="600">Limitations:</tspan> Be aware of scoring function biases and system-specific challenges</text>
                    <text x="70" y="354" font-size="11" fill="#6b4400">• <tspan font-weight="600">Iteration:</tspan> Docking is often iterative - refine based on results and use consensus approaches</text>

                    <defs>
                        <marker id="arrow-sum" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                            <polygon points="0 0, 10 3, 0 6" fill="#2c3e50"/>
                        </marker>
                        <marker id="arrow-result" markerWidth="12" markerHeight="12" refX="10" refY="3" orient="auto">
                            <polygon points="0 0, 12 3, 0 6" fill="#27ae60"/>
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>

    </div>
</body>
</html>