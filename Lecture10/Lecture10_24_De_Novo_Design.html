<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>De Novo Design - Comprehensive Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Aptos, 'Segoe UI', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .page {
            width: 960px;
            min-height: 540px;
            margin: 0 auto 30px;
            padding: 40px 60px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            page-break-after: always;
        }
        
        .title {
            font-size: 36px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .section-title {
            font-size: 28px;
            font-weight: 700;
            color: #1E64C8;
            margin-bottom: 20px;
            border-bottom: 3px solid #1E64C8;
            padding-bottom: 10px;
        }
        
        .subsection-title {
            font-size: 20px;
            font-weight: 600;
            color: #1E64C8;
            margin-top: 20px;
            margin-bottom: 12px;
        }
        
        .main-visual {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .content-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
        }
        
        .content-card {
            background: #f8f9fa;
            border-left: 4px solid #1E64C8;
            border-radius: 8px;
            padding: 14px 20px;
            transition: all 0.3s;
        }
        
        .content-card:hover {
            background: #e8f2ff;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(30, 100, 200, 0.15);
        }
        
        .content-main {
            font-size: 18px;
            font-weight: 600;
            color: #1E64C8;
            margin-bottom: 4px;
        }
        
        .content-desc {
            font-size: 14px;
            color: #555;
            font-weight: 400;
        }

        .description-text {
            font-size: 15px;
            line-height: 1.7;
            color: #333;
            margin-bottom: 15px;
        }

        .bullet-list {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .bullet-list li {
            font-size: 14px;
            line-height: 1.8;
            color: #444;
            margin-bottom: 8px;
        }

        .highlight-box {
            background: #e8f4fd;
            border-left: 4px solid #1E64C8;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .highlight-box strong {
            color: #1E64C8;
        }

        .visual-container {
            display: flex;
            justify-content: center;
            margin: 20px 0;
        }

        .generate-pulse {
            animation: generate 3s ease-in-out infinite;
        }

        @keyframes generate {
            0%, 100% { opacity: 0.3; transform: scale(0.95); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .molecule-emerge {
            animation: emerge 2s ease-out infinite;
        }

        @keyframes emerge {
            0% { opacity: 0; transform: translateX(-20px) scale(0.8); }
            100% { opacity: 1; transform: translateX(0) scale(1); }
        }

        .rl-feedback {
            animation: feedback-loop 4s ease-in-out infinite;
        }

        @keyframes feedback-loop {
            0%, 100% { stroke-dashoffset: 0; }
            50% { stroke-dashoffset: 20; }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }
            .page {
                box-shadow: none;
                margin-bottom: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Page 1: Overview -->
    <div class="page">
        <div class="title">De Novo Design</div>
        
        <div class="main-visual">
            <svg width="860" height="220" viewBox="0 0 860 220">
                <!-- Chemical Space -->
                <g transform="translate(50, 20)">
                    <ellipse cx="100" cy="100" rx="90" ry="80" fill="#e3f2fd" stroke="#1E64C8" stroke-width="3" opacity="0.4"/>
                    <text x="100" y="45" text-anchor="middle" font-size="14" font-weight="600" fill="#1E64C8">Chemical Space</text>
                    <text x="100" y="60" text-anchor="middle" font-size="11" fill="#666">10‚Å∂‚Å∞ molecules</text>
                    
                    <!-- Random molecules scattered -->
                    <circle cx="70" cy="80" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="130" cy="90" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="85" cy="120" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="115" cy="110" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="100" cy="95" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="95" cy="135" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="125" cy="125" r="6" fill="#90caf9" opacity="0.6"/>
                    <circle cx="75" cy="105" r="6" fill="#90caf9" opacity="0.6"/>
                    
                    <!-- Known drugs region -->
                    <circle cx="110" cy="100" r="20" fill="#2ecc71" opacity="0.2" stroke="#27ae60" stroke-width="2"/>
                    <text x="110" y="105" text-anchor="middle" font-size="9" font-weight="600" fill="#27ae60">Known</text>
                </g>

                <!-- Arrow to generator -->
                <path d="M 195 110 L 245 110" stroke="#1E64C8" stroke-width="3" marker-end="url(#arrow-gen)"/>

                <!-- Generative Model -->
                <g transform="translate(250, 40)">
                    <rect x="0" y="0" width="140" height="140" rx="12" fill="#fff3cd" stroke="#ffc107" stroke-width="3" class="generate-pulse"/>
                    <text x="70" y="25" text-anchor="middle" font-size="14" font-weight="600" fill="#f57f17">Generator</text>
                    
                    <!-- Neural network layers -->
                    <g transform="translate(20, 40)">
                        <!-- Input layer -->
                        <circle cx="10" cy="20" r="6" fill="#1E64C8"/>
                        <circle cx="10" cy="40" r="6" fill="#1E64C8"/>
                        <circle cx="10" cy="60" r="6" fill="#1E64C8"/>
                        
                        <!-- Hidden layer 1 -->
                        <circle cx="45" cy="15" r="7" fill="#e74c3c"/>
                        <circle cx="45" cy="35" r="7" fill="#e74c3c"/>
                        <circle cx="45" cy="55" r="7" fill="#e74c3c"/>
                        <circle cx="45" cy="75" r="7" fill="#e74c3c"/>
                        
                        <!-- Hidden layer 2 -->
                        <circle cx="80" cy="20" r="7" fill="#9b59b6"/>
                        <circle cx="80" cy="40" r="7" fill="#9b59b6"/>
                        <circle cx="80" cy="60" r="7" fill="#9b59b6"/>
                        
                        <!-- Output layer -->
                        <circle cx="110" cy="30" r="8" fill="#2ecc71"/>
                        <circle cx="110" cy="50" r="8" fill="#2ecc71"/>
                        
                        <!-- Connections (simplified) -->
                        <line x1="16" y1="20" x2="38" y2="15" stroke="#95a5a6" stroke-width="1" opacity="0.3"/>
                        <line x1="16" y1="40" x2="38" y2="35" stroke="#95a5a6" stroke-width="1" opacity="0.3"/>
                        <line x1="52" y1="35" x2="73" y2="40" stroke="#95a5a6" stroke-width="1" opacity="0.3"/>
                        <line x1="87" y1="40" x2="102" y2="40" stroke="#95a5a6" stroke-width="1" opacity="0.3"/>
                    </g>
                    
                    <text x="70" y="125" text-anchor="middle" font-size="11" fill="#666">VAE/GAN/RL</text>
                </g>

                <!-- Arrow to candidates -->
                <path d="M 395 110 L 445 110" stroke="#1E64C8" stroke-width="3" marker-end="url(#arrow-gen)"/>

                <!-- Generated Candidates -->
                <g transform="translate(450, 30)">
                    <rect x="0" y="0" width="160" height="160" rx="10" fill="#f8f9fa" stroke="#1E64C8" stroke-width="2"/>
                    <text x="80" y="20" text-anchor="middle" font-size="13" font-weight="600" fill="#1E64C8">Novel Molecules</text>
                    
                    <!-- Generated molecules (different sizes/colors) -->
                    <g class="molecule-emerge" style="animation-delay: 0s;">
                        <circle cx="40" cy="50" r="15" fill="#3498db" opacity="0.7"/>
                        <text x="40" y="55" text-anchor="middle" font-size="10" fill="white" font-weight="600">M1</text>
                    </g>
                    
                    <g class="molecule-emerge" style="animation-delay: 0.3s;">
                        <circle cx="80" cy="50" r="15" fill="#e74c3c" opacity="0.7"/>
                        <text x="80" y="55" text-anchor="middle" font-size="10" fill="white" font-weight="600">M2</text>
                    </g>
                    
                    <g class="molecule-emerge" style="animation-delay: 0.6s;">
                        <circle cx="120" cy="50" r="15" fill="#2ecc71" opacity="0.7"/>
                        <text x="120" y="55" text-anchor="middle" font-size="10" fill="white" font-weight="600">M3</text>
                    </g>
                    
                    <g class="molecule-emerge" style="animation-delay: 0.9s;">
                        <circle cx="40" cy="90" r="15" fill="#f39c12" opacity="0.7"/>
                        <text x="40" y="95" text-anchor="middle" font-size="10" fill="white" font-weight="600">M4</text>
                    </g>
                    
                    <g class="molecule-emerge" style="animation-delay: 1.2s;">
                        <circle cx="80" cy="90" r="15" fill="#9b59b6" opacity="0.7"/>
                        <text x="80" y="95" text-anchor="middle" font-size="10" fill="white" font-weight="600">M5</text>
                    </g>
                    
                    <g class="molecule-emerge" style="animation-delay: 1.5s;">
                        <circle cx="120" cy="90" r="15" fill="#1abc9c" opacity="0.7"/>
                        <text x="120" y="95" text-anchor="middle" font-size="10" fill="white" font-weight="600">M6</text>
                    </g>
                    
                    <!-- Property bars -->
                    <rect x="20" y="115" width="30" height="8" rx="2" fill="#2ecc71" opacity="0.7"/>
                    <text x="15" y="123" font-size="8" fill="#666">Act</text>
                    
                    <rect x="20" y="128" width="25" height="8" rx="2" fill="#3498db" opacity="0.7"/>
                    <text x="15" y="136" font-size="8" fill="#666">Sol</text>
                    
                    <rect x="20" y="141" width="35" height="8" rx="2" fill="#e74c3c" opacity="0.7"/>
                    <text x="15" y="149" font-size="8" fill="#666">Tox</text>
                    
                    <text x="80" y="132" text-anchor="middle" font-size="9" fill="#666">Multi-objective</text>
                </g>

                <!-- Arrow to evaluation -->
                <path d="M 615 110 L 665 110" stroke="#1E64C8" stroke-width="3" marker-end="url(#arrow-gen)"/>

                <!-- Evaluation & Optimization -->
                <g transform="translate(670, 50)">
                    <rect x="0" y="0" width="140" height="120" rx="10" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
                    <text x="70" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#155724">Evaluate</text>
                    
                    <!-- Checkboxes -->
                    <g transform="translate(15, 35)">
                        <rect x="0" y="0" width="18" height="18" rx="3" fill="#28a745"/>
                        <text x="9" y="13" text-anchor="middle" font-size="12" fill="white" font-weight="bold">‚úì</text>
                        <text x="25" y="13" font-size="11" fill="#155724">Synthesizable</text>
                    </g>
                    
                    <g transform="translate(15, 58)">
                        <rect x="0" y="0" width="18" height="18" rx="3" fill="#28a745"/>
                        <text x="9" y="13" text-anchor="middle" font-size="12" fill="white" font-weight="bold">‚úì</text>
                        <text x="25" y="13" font-size="11" fill="#155724">Novel</text>
                    </g>
                    
                    <g transform="translate(15, 81)">
                        <rect x="0" y="0" width="18" height="18" rx="3" fill="#28a745"/>
                        <text x="9" y="13" text-anchor="middle" font-size="12" fill="white" font-weight="bold">‚úì</text>
                        <text x="25" y="13" font-size="11" fill="#155724">Drug-like</text>
                    </g>
                </g>

                <!-- Reinforcement Learning Feedback Loop -->
                <path d="M 740 55 Q 740 20, 700 20 Q 320 20, 320 55" 
                      fill="none" 
                      stroke="#f39c12" 
                      stroke-width="2.5" 
                      stroke-dasharray="8,4"
                      marker-end="url(#arrow-feedback)"
                      class="rl-feedback"/>
                <text x="520" y="15" text-anchor="middle" font-size="11" font-weight="600" fill="#f39c12">Reward Signal (RL)</text>

                <!-- Arrow markers -->
                <defs>
                    <marker id="arrow-gen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8"/>
                    </marker>
                    <marker id="arrow-feedback" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#f39c12"/>
                    </marker>
                </defs>
            </svg>
        </div>
        
        <div class="content-grid">
            <div class="content-card">
                <div class="content-main">Chemical space exploration</div>
                <div class="content-desc">Novel compound generation</div>
            </div>
            <div class="content-card">
                <div class="content-main">Reinforcement learning</div>
                <div class="content-desc">Goal-directed optimization</div>
            </div>
            <div class="content-card">
                <div class="content-main">VAE/GAN approaches</div>
                <div class="content-desc">Generative architectures</div>
            </div>
            <div class="content-card">
                <div class="content-main">Synthesizability</div>
                <div class="content-desc">Chemical feasibility assessment</div>
            </div>
            <div class="content-card">
                <div class="content-main">Diversity metrics</div>
                <div class="content-desc">Novelty quantification</div>
            </div>
        </div>
    </div>

    <!-- Page 2: Chemical Space Exploration -->
    <div class="page">
        <div class="section-title">1. Chemical Space Exploration</div>
        
        <div class="description-text">
            Chemical space exploration involves navigating the vast universe of possible molecular structures to discover novel compounds with desired properties. The drug-like chemical space is estimated to contain 10‚Å∂‚Å∞ possible molecules, far exceeding the number of atoms in the observable universe.
        </div>

        <div class="visual-container">
            <svg width="800" height="280" viewBox="0 0 800 280">
                <!-- Large chemical space -->
                <rect x="20" y="20" width="760" height="240" rx="10" fill="#e3f2fd" stroke="#1E64C8" stroke-width="2"/>
                <text x="400" y="45" text-anchor="middle" font-size="16" font-weight="600" fill="#1E64C8">Chemical Space (10‚Å∂‚Å∞ molecules)</text>
                
                <!-- Known drugs (small circle) -->
                <circle cx="150" cy="140" r="50" fill="#2ecc71" opacity="0.3" stroke="#27ae60" stroke-width="3"/>
                <text x="150" y="140" text-anchor="middle" font-size="13" font-weight="600" fill="#155724">Known Drugs</text>
                <text x="150" y="158" text-anchor="middle" font-size="11" fill="#155724">~10‚Å¥ molecules</text>
                
                <!-- Exploration vectors -->
                <g opacity="0.6">
                    <path d="M 200 140 L 320 100" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow-explore)" stroke-dasharray="5,5"/>
                    <path d="M 200 140 L 350 180" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow-explore)" stroke-dasharray="5,5"/>
                    <path d="M 150 90 L 150 50" stroke="#f39c12" stroke-width="3" marker-end="url(#arrow-explore)" stroke-dasharray="5,5"/>
                </g>
                
                <!-- Unexplored regions with scattered dots -->
                <g opacity="0.4">
                    <circle cx="400" cy="80" r="4" fill="#1E64C8"/>
                    <circle cx="450" cy="120" r="4" fill="#1E64C8"/>
                    <circle cx="500" cy="90" r="4" fill="#1E64C8"/>
                    <circle cx="550" cy="140" r="4" fill="#1E64C8"/>
                    <circle cx="600" cy="100" r="4" fill="#1E64C8"/>
                    <circle cx="650" cy="160" r="4" fill="#1E64C8"/>
                    <circle cx="420" cy="180" r="4" fill="#1E64C8"/>
                    <circle cx="480" cy="200" r="4" fill="#1E64C8"/>
                    <circle cx="540" cy="220" r="4" fill="#1E64C8"/>
                    <circle cx="620" cy="210" r="4" fill="#1E64C8"/>
                </g>
                
                <!-- Novel region highlight -->
                <ellipse cx="500" cy="140" rx="120" ry="80" fill="none" stroke="#e74c3c" stroke-width="3" stroke-dasharray="10,5"/>
                <text x="500" y="235" text-anchor="middle" font-size="13" font-weight="600" fill="#e74c3c">Novel Chemical Region</text>
                
                <!-- Property gradient -->
                <g transform="translate(650, 60)">
                    <text x="0" y="0" font-size="11" font-weight="600" fill="#666">Property</text>
                    <text x="0" y="15" font-size="11" font-weight="600" fill="#666">Gradient</text>
                    <rect x="0" y="20" width="30" height="15" fill="#ff6b6b"/>
                    <rect x="0" y="35" width="30" height="15" fill="#ffa500"/>
                    <rect x="0" y="50" width="30" height="15" fill="#ffd700"/>
                    <rect x="0" y="65" width="30" height="15" fill="#90ee90"/>
                    <rect x="0" y="80" width="30" height="15" fill="#2ecc71"/>
                    <text x="35" y="30" font-size="9" fill="#666">Low</text>
                    <text x="35" y="90" font-size="9" fill="#666">High</text>
                </g>
                
                <defs>
                    <marker id="arrow-explore" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#f39c12"/>
                    </marker>
                </defs>
            </svg>
        </div>

        <div class="highlight-box">
            <strong>Key Concept:</strong> Generative models learn the distribution of known molecules and can generate novel structures in unexplored regions of chemical space while maintaining drug-like properties.
        </div>

        <div class="subsection-title">Exploration Strategies</div>
        <ul class="bullet-list">
            <li><strong>Latent space interpolation:</strong> Navigate smoothly between known molecules to discover intermediate structures with novel properties</li>
            <li><strong>Scaffold hopping:</strong> Replace molecular scaffolds while maintaining biological activity, leading to novel intellectual property</li>
            <li><strong>Property-guided sampling:</strong> Direct generation toward regions with desired physicochemical or biological properties</li>
            <li><strong>Multi-objective optimization:</strong> Simultaneously optimize multiple properties such as potency, selectivity, and ADMET characteristics</li>
        </ul>

        <div class="subsection-title">Molecular Representations</div>
        <ul class="bullet-list">
            <li><strong>SMILES strings:</strong> Sequential text representation enabling language model approaches</li>
            <li><strong>Molecular graphs:</strong> Nodes represent atoms, edges represent bonds, capturing structural information</li>
            <li><strong>3D conformations:</strong> Spatial arrangements critical for protein-ligand interactions</li>
            <li><strong>Fingerprints:</strong> Binary vectors encoding structural features for similarity calculations</li>
        </ul>
    </div>

    <!-- Page 3: Reinforcement Learning -->
    <div class="page">
        <div class="section-title">2. Reinforcement Learning</div>
        
        <div class="description-text">
            Reinforcement Learning (RL) enables goal-directed molecular design by training agents to generate molecules that maximize a reward function. The agent learns to navigate chemical space through trial and error, receiving rewards for generating molecules with desired properties.
        </div>

        <div class="visual-container">
            <svg width="800" height="260" viewBox="0 0 800 260">
                <!-- RL Agent -->
                <g transform="translate(50, 80)">
                    <rect x="0" y="0" width="120" height="100" rx="10" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
                    <text x="60" y="30" text-anchor="middle" font-size="14" font-weight="600" fill="#f57f17">RL Agent</text>
                    <text x="60" y="50" text-anchor="middle" font-size="11" fill="#666">(Generator)</text>
                    
                    <!-- Neural network icon -->
                    <g transform="translate(30, 55)">
                        <circle cx="10" cy="10" r="5" fill="#e74c3c"/>
                        <circle cx="10" cy="25" r="5" fill="#e74c3c"/>
                        <circle cx="30" cy="17.5" r="5" fill="#9b59b6"/>
                        <circle cx="50" cy="17.5" r="5" fill="#2ecc71"/>
                        <line x1="15" y1="10" x2="25" y2="17.5" stroke="#95a5a6" stroke-width="1"/>
                        <line x1="15" y1="25" x2="25" y2="17.5" stroke="#95a5a6" stroke-width="1"/>
                        <line x1="35" y1="17.5" x2="45" y2="17.5" stroke="#95a5a6" stroke-width="1"/>
                    </g>
                </g>

                <!-- Action arrow -->
                <path d="M 175 130 L 270 130" stroke="#1E64C8" stroke-width="3" marker-end="url(#arrow-rl)"/>
                <text x="222" y="120" text-anchor="middle" font-size="11" font-weight="600" fill="#1E64C8">Action</text>
                <text x="222" y="135" text-anchor="middle" font-size="9" fill="#666">(Generate molecule)</text>

                <!-- Environment -->
                <g transform="translate(275, 80)">
                    <rect x="0" y="0" width="150" height="100" rx="10" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="75" y="25" text-anchor="middle" font-size="14" font-weight="600" fill="#1E64C8">Environment</text>
                    
                    <!-- Molecule representation -->
                    <g transform="translate(35, 35)">
                        <circle cx="20" cy="20" r="15" fill="#3498db" opacity="0.7"/>
                        <circle cx="50" cy="20" r="15" fill="#e74c3c" opacity="0.7"/>
                        <circle cx="65" cy="45" r="15" fill="#2ecc71" opacity="0.7"/>
                        <line x1="30" y1="20" x2="45" y2="20" stroke="#333" stroke-width="2"/>
                        <line x1="55" y1="27" x2="62" y2="38" stroke="#333" stroke-width="2"/>
                    </g>
                    
                    <text x="75" y="85" text-anchor="middle" font-size="10" fill="#666">State: Molecule</text>
                </g>

                <!-- Reward calculation -->
                <g transform="translate(460, 80)">
                    <rect x="0" y="0" width="140" height="100" rx="10" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
                    <text x="70" y="25" text-anchor="middle" font-size="14" font-weight="600" fill="#155724">Reward</text>
                    <text x="70" y="42" text-anchor="middle" font-size="11" fill="#155724">Calculation</text>
                    
                    <!-- Reward components -->
                    <text x="10" y="60" font-size="10" fill="#155724">‚ö° Activity: 0.85</text>
                    <text x="10" y="75" font-size="10" fill="#155724">üíä Drug-like: 0.92</text>
                    <text x="10" y="90" font-size="10" fill="#155724">üî¨ Synth: 0.78</text>
                </g>

                <!-- Return arrow -->
                <path d="M 580 180 Q 620 220, 450 220 Q 280 220, 110 185" 
                      stroke="#28a745" 
                      stroke-width="3" 
                      marker-end="url(#arrow-reward)"
                      fill="none"
                      stroke-dasharray="5,5"/>
                <text x="350" y="245" text-anchor="middle" font-size="11" font-weight="600" fill="#28a745">Reward Signal: R = 0.85</text>

                <!-- Learning process -->
                <g transform="translate(640, 30)">
                    <rect x="0" y="0" width="140" height="80" rx="8" fill="#f8f9fa" stroke="#666" stroke-width="1.5"/>
                    <text x="70" y="20" text-anchor="middle" font-size="12" font-weight="600" fill="#333">Learning</text>
                    <text x="10" y="40" font-size="9" fill="#555">Policy update:</text>
                    <text x="10" y="55" font-size="9" fill="#555">Œ∏ ‚Üê Œ∏ + Œ±‚àáJ(Œ∏)</text>
                    <text x="10" y="70" font-size="9" fill="#555">Maximize E[R]</text>
                </g>

                <defs>
                    <marker id="arrow-rl" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8"/>
                    </marker>
                    <marker id="arrow-reward" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#28a745"/>
                    </marker>
                </defs>
            </svg>
        </div>

        <div class="highlight-box">
            <strong>Reward Function Design:</strong> The reward function combines multiple objectives including biological activity, synthetic accessibility, drug-likeness (Lipinski's rules), and novelty. Proper reward shaping is critical for successful optimization.
        </div>

        <div class="subsection-title">RL Algorithms for Molecular Design</div>
        <ul class="bullet-list">
            <li><strong>Policy Gradient Methods:</strong> REINFORCE algorithm optimizes the generator policy directly based on reward signals</li>
            <li><strong>Actor-Critic:</strong> Combines policy optimization with value function estimation for more stable training</li>
            <li><strong>Proximal Policy Optimization (PPO):</strong> Prevents large policy updates that could destabilize training</li>
            <li><strong>Monte Carlo Tree Search (MCTS):</strong> Explores molecular construction paths systematically</li>
        </ul>

        <div class="subsection-title">Reward Components</div>
        <ul class="bullet-list">
            <li><strong>Target activity:</strong> Predicted binding affinity or activity against target protein (0.0-1.0 scale)</li>
            <li><strong>Synthetic accessibility score (SA):</strong> Estimates how difficult the molecule is to synthesize (1-10 scale)</li>
            <li><strong>QED (Quantitative Estimate of Drug-likeness):</strong> Composite score of drug-like properties</li>
            <li><strong>Novelty bonus:</strong> Rewards molecules that are structurally distinct from known compounds</li>
        </ul>
    </div>

    <!-- Page 4: VAE/GAN Approaches -->
    <div class="page">
        <div class="section-title">3. VAE/GAN Approaches</div>
        
        <div class="description-text">
            Variational Autoencoders (VAEs) and Generative Adversarial Networks (GANs) are powerful generative architectures that learn to model the distribution of molecular structures and generate novel compounds with similar properties.
        </div>

        <div class="subsection-title">Variational Autoencoder (VAE)</div>
        <div class="visual-container">
            <svg width="800" height="200" viewBox="0 0 800 200">
                <!-- Input molecule -->
                <g transform="translate(30, 80)">
                    <text x="40" y="-10" text-anchor="middle" font-size="12" font-weight="600" fill="#333">Input</text>
                    <circle cx="20" cy="20" r="12" fill="#3498db" opacity="0.8"/>
                    <circle cx="45" cy="20" r="12" fill="#e74c3c" opacity="0.8"/>
                    <circle cx="60" cy="40" r="12" fill="#2ecc71" opacity="0.8"/>
                    <line x1="30" y1="20" x2="40" y2="20" stroke="#333" stroke-width="2"/>
                    <line x1="50" y1="27" x2="57" y2="35" stroke="#333" stroke-width="2"/>
                    <text x="40" y="70" text-anchor="middle" font-size="10" fill="#666">Molecule</text>
                </g>

                <!-- Encoder -->
                <path d="M 105 100 L 155 100" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-vae)"/>
                <g transform="translate(160, 50)">
                    <rect x="0" y="0" width="100" height="100" rx="8" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
                    <text x="50" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#f57f17">Encoder</text>
                    
                    <!-- Network layers -->
                    <g transform="translate(20, 35)">
                        <circle cx="10" cy="10" r="4" fill="#1E64C8"/>
                        <circle cx="10" cy="25" r="4" fill="#1E64C8"/>
                        <circle cx="10" cy="40" r="4" fill="#1E64C8"/>
                        <circle cx="30" cy="17" r="5" fill="#e74c3c"/>
                        <circle cx="30" cy="33" r="5" fill="#e74c3c"/>
                        <circle cx="50" cy="25" r="5" fill="#9b59b6"/>
                    </g>
                </g>

                <!-- Latent space -->
                <path d="M 265 100 L 305 100" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-vae)"/>
                <g transform="translate(310, 40)">
                    <ellipse cx="60" cy="60" rx="55" ry="50" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="60" y="35" text-anchor="middle" font-size="12" font-weight="600" fill="#1E64C8">Latent Space</text>
                    <text x="60" y="50" text-anchor="middle" font-size="10" fill="#666">(z ~ N(Œº, œÉ¬≤))</text>
                    
                    <!-- Sample points -->
                    <circle cx="45" cy="65" r="3" fill="#e74c3c"/>
                    <circle cx="60" cy="75" r="3" fill="#2ecc71"/>
                    <circle cx="75" cy="70" r="3" fill="#3498db"/>
                    <circle cx="55" cy="85" r="3" fill="#f39c12"/>
                </g>

                <!-- Decoder -->
                <path d="M 425 100 L 475 100" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-vae)"/>
                <g transform="translate(480, 50)">
                    <rect x="0" y="0" width="100" height="100" rx="8" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
                    <text x="50" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#155724">Decoder</text>
                    
                    <!-- Network layers -->
                    <g transform="translate(20, 35)">
                        <circle cx="10" cy="25" r="5" fill="#9b59b6"/>
                        <circle cx="30" cy="17" r="5" fill="#e74c3c"/>
                        <circle cx="30" cy="33" r="5" fill="#e74c3c"/>
                        <circle cx="50" cy="10" r="4" fill="#2ecc71"/>
                        <circle cx="50" cy="25" r="4" fill="#2ecc71"/>
                        <circle cx="50" cy="40" r="4" fill="#2ecc71"/>
                    </g>
                </g>

                <!-- Output molecule -->
                <path d="M 585 100 L 635 100" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-vae)"/>
                <g transform="translate(640, 80)">
                    <text x="40" y="-10" text-anchor="middle" font-size="12" font-weight="600" fill="#333">Output</text>
                    <circle cx="20" cy="20" r="12" fill="#3498db" opacity="0.8"/>
                    <circle cx="45" cy="20" r="12" fill="#e74c3c" opacity="0.8"/>
                    <circle cx="60" cy="40" r="12" fill="#2ecc71" opacity="0.8"/>
                    <line x1="30" y1="20" x2="40" y2="20" stroke="#333" stroke-width="2"/>
                    <line x1="50" y1="27" x2="57" y2="35" stroke="#333" stroke-width="2"/>
                    <text x="40" y="70" text-anchor="middle" font-size="10" fill="#666">Reconstructed</text>
                </g>

                <defs>
                    <marker id="arrow-vae" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8"/>
                    </marker>
                </defs>
            </svg>
        </div>

        <div class="highlight-box">
            <strong>VAE Loss Function:</strong> Combines reconstruction loss (how well the output matches input) with KL divergence (regularizes the latent space to follow a normal distribution): L = Reconstruction_Loss + Œ≤ √ó KL_Divergence
        </div>

        <div class="subsection-title">Generative Adversarial Network (GAN)</div>
        <div class="visual-container">
            <svg width="700" height="180" viewBox="0 0 700 180">
                <!-- Random noise -->
                <g transform="translate(30, 60)">
                    <rect x="0" y="0" width="80" height="60" rx="6" fill="#f0f0f0" stroke="#666" stroke-width="1.5"/>
                    <text x="40" y="25" text-anchor="middle" font-size="11" font-weight="600" fill="#333">Random</text>
                    <text x="40" y="40" text-anchor="middle" font-size="11" font-weight="600" fill="#333">Noise (z)</text>
                </g>

                <!-- Generator -->
                <path d="M 115 90 L 165 90" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-gan)"/>
                <g transform="translate(170, 50)">
                    <rect x="0" y="0" width="120" height="80" rx="8" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
                    <text x="60" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#f57f17">Generator (G)</text>
                    <text x="60" y="45" text-anchor="middle" font-size="10" fill="#666">Neural Network</text>
                    <text x="60" y="65" text-anchor="middle" font-size="9" fill="#666">Generates fake</text>
                </g>

                <!-- Generated molecule -->
                <path d="M 295 90 L 335 90" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-gan)"/>
                <g transform="translate(340, 70)">
                    <circle cx="20" cy="20" r="12" fill="#3498db" opacity="0.7"/>
                    <circle cx="45" cy="20" r="12" fill="#e74c3c" opacity="0.7"/>
                    <text x="32" y="50" text-anchor="middle" font-size="9" fill="#666">Generated</text>
                </g>

                <!-- Discriminator -->
                <g transform="translate(440, 20)">
                    <rect x="0" y="0" width="140" height="140" rx="8" fill="#e8f4fd" stroke="#1E64C8" stroke-width="2"/>
                    <text x="70" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#1E64C8">Discriminator (D)</text>
                    <text x="70" y="45" text-anchor="middle" font-size="10" fill="#666">Neural Network</text>
                    
                    <!-- Fake input -->
                    <path d="M -30 50 L 10 70" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrow-gan)"/>
                    <text x="70" y="75" text-anchor="middle" font-size="10" fill="#e74c3c">Fake? Score: 0.2</text>
                    
                    <!-- Real input -->
                    <g transform="translate(-80, 85)">
                        <circle cx="20" cy="20" r="10" fill="#2ecc71" opacity="0.7"/>
                        <circle cx="40" cy="20" r="10" fill="#3498db" opacity="0.7"/>
                        <text x="30" y="45" text-anchor="middle" font-size="8" fill="#666">Real data</text>
                    </g>
                    <path d="M -30 105 L 10 100" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrow-gan)"/>
                    <text x="70" y="110" text-anchor="middle" font-size="10" fill="#2ecc71">Real? Score: 0.9</text>
                </g>

                <!-- Feedback loop -->
                <path d="M 510 165 Q 510 200, 230 200 Q 230 135, 230 135" 
                      stroke="#f39c12" 
                      stroke-width="2" 
                      stroke-dasharray="5,5"
                      marker-end="url(#arrow-feedback-gan)"
                      fill="none"/>
                <text x="370" y="195" text-anchor="middle" font-size="10" font-weight="600" fill="#f39c12">Adversarial Training</text>

                <defs>
                    <marker id="arrow-gan" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8"/>
                    </marker>
                    <marker id="arrow-feedback-gan" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#f39c12"/>
                    </marker>
                </defs>
            </svg>
        </div>

        <div class="subsection-title">Key Advantages</div>
        <ul class="bullet-list">
            <li><strong>VAE advantages:</strong> Continuous latent space enables smooth interpolation, explicit probabilistic formulation, stable training dynamics</li>
            <li><strong>GAN advantages:</strong> Can generate sharper, more realistic molecular structures, no need to explicitly define likelihood function</li>
            <li><strong>Conditional generation:</strong> Both architectures can be conditioned on desired properties for targeted molecular design</li>
        </ul>
    </div>

    <!-- Page 5: Synthesizability -->
    <div class="page">
        <div class="section-title">4. Synthesizability</div>
        
        <div class="description-text">
            A crucial aspect of de novo drug design is ensuring that generated molecules can actually be synthesized in the laboratory. Synthesizability assessment evaluates whether a proposed molecule can be practically made using available chemical reactions and starting materials.
        </div>

        <div class="visual-container">
            <svg width="800" height="240" viewBox="0 0 800 240">
                <!-- Input molecule -->
                <g transform="translate(50, 90)">
                    <text x="50" y="-15" text-anchor="middle" font-size="13" font-weight="600" fill="#333">Generated Molecule</text>
                    <rect x="0" y="0" width="100" height="80" rx="8" fill="#f8f9fa" stroke="#1E64C8" stroke-width="2"/>
                    <g transform="translate(25, 20)">
                        <circle cx="15" cy="15" r="10" fill="#3498db" opacity="0.7"/>
                        <circle cx="35" cy="15" r="10" fill="#e74c3c" opacity="0.7"/>
                        <circle cx="45" cy="35" r="10" fill="#2ecc71" opacity="0.7"/>
                        <line x1="23" y1="15" x2="30" y2="15" stroke="#333" stroke-width="2"/>
                        <line x1="40" y1="22" x2="43" y2="28" stroke="#333" stroke-width="2"/>
                    </g>
                </g>

                <!-- Assessment methods -->
                <path d="M 155 130 L 210 130" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-synth)"/>
                
                <g transform="translate(215, 30)">
                    <rect x="0" y="0" width="160" height="200" rx="10" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
                    <text x="80" y="25" text-anchor="middle" font-size="14" font-weight="600" fill="#f57f17">Assessment Methods</text>
                    
                    <!-- SA Score -->
                    <g transform="translate(15, 45)">
                        <rect x="0" y="0" width="130" height="35" rx="5" fill="white" stroke="#ffc107" stroke-width="1.5"/>
                        <text x="10" y="15" font-size="11" font-weight="600" fill="#333">SA Score</text>
                        <text x="10" y="28" font-size="9" fill="#666">Synthetic Accessibility</text>
                        <text x="110" y="22" font-size="13" font-weight="700" fill="#2ecc71">3.2</text>
                    </g>
                    
                    <!-- SCScore -->
                    <g transform="translate(15, 87)">
                        <rect x="0" y="0" width="130" height="35" rx="5" fill="white" stroke="#ffc107" stroke-width="1.5"/>
                        <text x="10" y="15" font-size="11" font-weight="600" fill="#333">SCScore</text>
                        <text x="10" y="28" font-size="9" fill="#666">Complexity Score</text>
                        <text x="110" y="22" font-size="13" font-weight="700" fill="#3498db">2.8</text>
                    </g>
                    
                    <!-- Retrosynthesis -->
                    <g transform="translate(15, 129)">
                        <rect x="0" y="0" width="130" height="35" rx="5" fill="white" stroke="#ffc107" stroke-width="1.5"/>
                        <text x="10" y="15" font-size="11" font-weight="600" fill="#333">Retrosynthesis</text>
                        <text x="10" y="28" font-size="9" fill="#666">Route Planning</text>
                        <circle cx="115" cy="18" r="8" fill="#2ecc71"/>
                        <text x="115" y="22" text-anchor="middle" font-size="10" fill="white" font-weight="bold">‚úì</text>
                    </g>
                </g>

                <!-- Synthesis route -->
                <path d="M 380 130 L 430 130" stroke="#1E64C8" stroke-width="2" marker-end="url(#arrow-synth)"/>
                
                <g transform="translate(435, 20)">
                    <rect x="0" y="0" width="330" height="200" rx="10" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
                    <text x="165" y="25" text-anchor="middle" font-size="14" font-weight="600" fill="#155724">Retrosynthetic Analysis</text>
                    
                    <!-- Target molecule -->
                    <g transform="translate(135, 45)">
                        <circle cx="15" cy="15" r="12" fill="#e74c3c" opacity="0.7" stroke="#c0392b" stroke-width="2"/>
                        <text x="15" y="35" text-anchor="middle" font-size="9" font-weight="600" fill="#155724">Target</text>
                    </g>
                    
                    <!-- Retrosynthetic arrow -->
                    <path d="M 150 75 L 150 95" stroke="#155724" stroke-width="2" marker-end="url(#arrow-retro)"/>
                    <text x="165" y="88" font-size="9" fill="#155724">Disconnect</text>
                    
                    <!-- Precursors level 1 -->
                    <g transform="translate(85, 100)">
                        <circle cx="15" cy="15" r="10" fill="#3498db" opacity="0.7" stroke="#2980b9" stroke-width="2"/>
                    </g>
                    <g transform="translate(185, 100)">
                        <circle cx="15" cy="15" r="10" fill="#9b59b6" opacity="0.7" stroke="#8e44ad" stroke-width="2"/>
                    </g>
                    <text x="165" y="135" text-anchor="middle" font-size="9" fill="#666">Precursors</text>
                    
                    <!-- Further disconnection -->
                    <path d="M 100 130 L 100 145" stroke="#155724" stroke-width="1.5" marker-end="url(#arrow-retro)"/>
                    <path d="M 200 130 L 200 145" stroke="#155724" stroke-width="1.5" marker-end="url(#arrow-retro)"/>
                    
                    <!-- Starting materials -->
                    <g transform="translate(50, 150)">
                        <rect x="0" y="0" width="30" height="25" rx="4" fill="#2ecc71" opacity="0.7" stroke="#27ae60" stroke-width="1.5"/>
                        <text x="15" y="16" text-anchor="middle" font-size="8" fill="white" font-weight="600">SM1</text>
                    </g>
                    <g transform="translate(95, 150)">
                        <rect x="0" y="0" width="30" height="25" rx="4" fill="#2ecc71" opacity="0.7" stroke="#27ae60" stroke-width="1.5"/>
                        <text x="15" y="16" text-anchor="middle" font-size="8" fill="white" font-weight="600">SM2</text>
                    </g>
                    <g transform="translate(185, 150)">
                        <rect x="0" y="0" width="30" height="25" rx="4" fill="#2ecc71" opacity="0.7" stroke="#27ae60" stroke-width="1.5"/>
                        <text x="15" y="16" text-anchor="middle" font-size="8" fill="white" font-weight="600">SM3</text>
                    </g>
                    <g transform="translate(230, 150)">
                        <rect x="0" y="0" width="30" height="25" rx="4" fill="#2ecc71" opacity="0.7" stroke="#27ae60" stroke-width="1.5"/>
                        <text x="15" y="16" text-anchor="middle" font-size="8" fill="white" font-weight="600">SM4</text>
                    </g>
                    
                    <text x="165" y="195" text-anchor="middle" font-size="9" font-weight="600" fill="#155724">Available Starting Materials</text>
                </g>

                <defs>
                    <marker id="arrow-synth" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#1E64C8"/>
                    </marker>
                    <marker id="arrow-retro" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                        <polygon points="0 0, 10 3, 0 6" fill="#155724"/>
                    </marker>
                </defs>
            </svg>
        </div>

        <div class="highlight-box">
            <strong>SA Score Range:</strong> Scores range from 1 (very easy to synthesize) to 10 (very difficult). Molecules with SA scores below 4 are generally considered synthetically accessible. The score considers molecular complexity, stereochemistry, and availability of building blocks.
        </div>

        <div class="subsection-title">Synthesizability Metrics</div>
        <ul class="bullet-list">
            <li><strong>SA Score (Synthetic Accessibility):</strong> Rule-based score considering fragment contributions and molecular complexity penalties</li>
            <li><strong>SCScore (Synthetic Complexity):</strong> Machine learning model trained on reaction data to predict synthesis difficulty</li>
            <li><strong>RA Score (Retrosynthetic Accessibility):</strong> Evaluates whether a valid retrosynthetic pathway can be found</li>
            <li><strong>RAscore:</strong> Combines retrosynthetic analysis with availability of starting materials from chemical catalogs</li>
        </ul>

        <div class="subsection-title">Retrosynthetic Planning Tools</div>
        <ul class="bullet-list">
            <li><strong>Computer-Aided Synthesis Planning (CASP):</strong> Automated tools that propose synthesis routes by working backward from target to starting materials</li>
            <li><strong>Reaction template matching:</strong> Identifies known chemical transformations applicable to the target molecule</li>
            <li><strong>Forward synthesis validation:</strong> Verifies proposed routes by simulating forward reactions</li>
            <li><strong>Commercial availability check:</strong> Ensures starting materials are purchasable from chemical suppliers</li>
        </ul>
    </div>

    <!-- Page 6: Diversity Metrics -->
    <div class="page">
        <div class="section-title">5. Diversity Metrics</div>
        
        <div class="description-text">
            Diversity metrics quantify the structural novelty and chemical variety of generated molecules. High diversity ensures exploration of different regions of chemical space while avoiding redundant similar structures. These metrics guide the generation process toward novel chemical matter.
        </div>

        <div class="visual-container">
            <svg width="800" height="240" viewBox="0 0 800 240">
                <!-- Chemical space representation -->
                <rect x="20" y="20" width="760" height="200" rx="10" fill="#f0f8ff" stroke="#1E64C8" stroke-width="2"/>
                <text x="400" y="45" text-anchor="middle" font-size="14" font-weight="600" fill="#1E64C8">Chemical Space Diversity Analysis</text>
                
                <!-- Known drugs cluster -->
                <g transform="translate(100, 80)">
                    <ellipse cx="60" cy="60" rx="50" ry="40" fill="#2ecc71" opacity="0.2" stroke="#27ae60" stroke-width="2"/>
                    <text x="60" y="40" text-anchor="middle" font-size="11" font-weight="600" fill="#27ae60">Known Drugs</text>
                    <circle cx="45" cy="55" r="5" fill="#27ae60"/>
                    <circle cx="60" cy="65" r="5" fill="#27ae60"/>
                    <circle cx="75" cy="58" r="5" fill="#27ae60"/>
                    <circle cx="55" cy="75" r="5" fill="#27ae60"/>
                    <circle cx="68" cy="52" r="5" fill="#27ae60"/>
                </g>
                
                <!-- Low diversity generation -->
                <g transform="translate(280, 80)">
                    <ellipse cx="60" cy="60" rx="45" ry="35" fill="#e74c3c" opacity="0.15" stroke="#c0392b" stroke-width="2" stroke-dasharray="5,5"/>
                    <text x="60" y="35" text-anchor="middle" font-size="11" font-weight="600" fill="#c0392b">Low Diversity</text>
                    <circle cx="50" cy="55" r="6" fill="#e74c3c" opacity="0.7"/>
                    <circle cx="58" cy="60" r="6" fill="#e74c3c" opacity="0.7"/>
                    <circle cx="65" cy="56" r="6" fill="#e74c3c" opacity="0.7"/>
                    <circle cx="55" cy="68" r="6" fill="#e74c3c" opacity="0.7"/>
                    <circle cx="70" cy="65" r="6" fill="#e74c3c" opacity="0.7"/>
                    <text x="60" y="115" text-anchor="middle" font-size="9" fill="#c0392b">Avg. Tanimoto > 0.85</text>
                </g>
                
                <!-- High diversity generation -->
                <g transform="translate(500, 70)">
                    <ellipse cx="80" cy="70" rx="100" ry="65" fill="#3498db" opacity="0.1" stroke="#2980b9" stroke-width="2"/>
                    <text x="80" y="40" text-anchor="middle" font-size="11" font-weight="600" fill="#2980b9">High Diversity</text>
                    <circle cx="40" cy="60" r="6" fill="#3498db" opacity="0.7"/>
                    <circle cx="75" cy="80" r="6" fill="#3498db" opacity="0.7"/>
                    <circle cx="110" cy="65" r="6" fill="#3498db" opacity="0.7"/>
                    <circle cx="55" cy="105" r="6" fill="#3498db" opacity="0.7"/>
                    <circle cx="120" cy="95" r="6" fill="#3498db" opacity="0.7"/>
                    <circle cx="95" cy="50" r="6" fill="#3498db" opacity="0.7"/>
                    <circle cx="60" cy="75" r="6" fill="#3498db" opacity="0.7"/>
                    <text x="80" y="155" text-anchor="middle" font-size="9" fill="#2980b9">Avg. Tanimoto < 0.50</text>
                </g>
                
                <!-- Distance indicators -->
                <g transform="translate(300, 110)">
                    <line x1="0" y1="0" x2="25" y2="5" stroke="#666" stroke-width="1.5" stroke-dasharray="3,3"/>
                    <text x="12" y="-5" font-size="8" fill="#666">d‚âà0.1</text>
                </g>
                
                <g transform="translate(520, 95)">
                    <line x1="0" y1="0" x2="50" y2="20" stroke="#666" stroke-width="1.5" stroke-dasharray="3,3"/>
                    <text x="25" y="-5" font-size="8" fill="#666">d‚âà0.7</text>
                </g>
            </svg>
        </div>

        <div class="highlight-box">
            <strong>Tanimoto Similarity:</strong> Measures structural similarity between two molecules based on fingerprint overlap. Values range from 0 (completely different) to 1 (identical). A Tanimoto coefficient below 0.5 typically indicates structurally distinct molecules.
        </div>

        <div class="subsection-title">Key Diversity Metrics</div>
        
        <div class="visual-container">
            <svg width="750" height="180" viewBox="0 0 750 180">
                <!-- Tanimoto -->
                <g transform="translate(30, 20)">
                    <rect x="0" y="0" width="220" height="140" rx="8" fill="#f8f9fa" stroke="#1E64C8" stroke-width="2"/>
                    <text x="110" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#1E64C8">Tanimoto Coefficient</text>
                    
                    <!-- Venn diagram -->
                    <circle cx="80" cy="85" r="30" fill="#3498db" opacity="0.5"/>
                    <circle cx="110" cy="85" r="30" fill="#e74c3c" opacity="0.5"/>
                    <text x="95" y="90" text-anchor="middle" font-size="11" font-weight="600" fill="#333">‚à©</text>
                    
                    <text x="110" y="130" text-anchor="middle" font-size="10" fill="#666">T = |A ‚à© B| / |A ‚à™ B|</text>
                </g>
                
                <!-- Scaffold diversity -->
                <g transform="translate(270, 20)">
                    <rect x="0" y="0" width="220" height="140" rx="8" fill="#f8f9fa" stroke="#2ecc71" stroke-width="2"/>
                    <text x="110" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#2ecc71">Scaffold Diversity</text>
                    
                    <!-- Different scaffolds -->
                    <g transform="translate(30, 45)">
                        <rect x="0" y="0" width="40" height="30" rx="3" fill="#2ecc71" opacity="0.6"/>
                        <text x="20" y="20" text-anchor="middle" font-size="9" fill="white" font-weight="600">S1</text>
                    </g>
                    <g transform="translate(80, 45)">
                        <circle cx="20" cy="15" r="15" fill="#3498db" opacity="0.6"/>
                        <text x="20" y="20" text-anchor="middle" font-size="9" fill="white" font-weight="600">S2</text>
                    </g>
                    <g transform="translate(130, 45)">
                        <polygon points="20,5 35,25 5,25" fill="#e74c3c" opacity="0.6"/>
                        <text x="20" y="22" text-anchor="middle" font-size="9" fill="white" font-weight="600">S3</text>
                    </g>
                    
                    <text x="110" y="105" text-anchor="middle" font-size="10" fill="#666">Unique core structures</text>
                    <text x="110" y="125" text-anchor="middle" font-size="9" fill="#666">Murcko scaffolds</text>
                </g>
                
                <!-- Internal diversity -->
                <g transform="translate(510, 20)">
                    <rect x="0" y="0" width="220" height="140" rx="8" fill="#f8f9fa" stroke="#f39c12" stroke-width="2"/>
                    <text x="110" y="25" text-anchor="middle" font-size="13" font-weight="600" fill="#f39c12">Internal Diversity</text>
                    
                    <!-- Distance matrix visualization -->
                    <g transform="translate(40, 45)">
                        <rect x="0" y="0" width="15" height="15" fill="#2ecc71" opacity="0.8"/>
                        <rect x="20" y="0" width="15" height="15" fill="#f39c12" opacity="0.6"/>
                        <rect x="40" y="0" width="15" height="15" fill="#e74c3c" opacity="0.4"/>
                        
                        <rect x="0" y="20" width="15" height="15" fill="#f39c12" opacity="0.6"/>
                        <rect x="20" y="20" width="15" height="15" fill="#2ecc71" opacity="0.8"/>
                        <rect x="40" y="20" width="15" height="15" fill="#f39c12" opacity="0.5"/>
                        
                        <rect x="0" y="40" width="15" height="15" fill="#e74c3c" opacity="0.4"/>
                        <rect x="20" y="40" width="15" height="15" fill="#f39c12" opacity="0.5"/>
                        <rect x="40" y="40" width="15" height="15" fill="#2ecc71" opacity="0.8"/>
                        
                        <text x="70" y="25" font-size="9" fill="#666">Pairwise</text>
                        <text x="70" y="38" font-size="9" fill="#666">distances</text>
                    </g>
                    
                    <text x="110" y="115" text-anchor="middle" font-size="10" fill="#666">Avg. pairwise dissimilarity</text>
                </g>
            </svg>
        </div>

        <div class="subsection-title">Diversity Calculations</div>
        <ul class="bullet-list">
            <li><strong>Tanimoto coefficient:</strong> Structural similarity based on molecular fingerprints (ECFP, MACCS keys). Lower values indicate greater diversity</li>
            <li><strong>Scaffold diversity:</strong> Counts unique Murcko scaffolds (core ring systems) in generated set. Higher scaffold count indicates greater chemical diversity</li>
            <li><strong>Internal diversity:</strong> Average pairwise dissimilarity within generated set. ID = (1/N(N-1)) Œ£(1 - Tanimoto_ij)</li>
            <li><strong>Novelty score:</strong> Minimum Tanimoto similarity to nearest neighbor in reference database. High novelty indicates genuinely new structures</li>
        </ul>

        <div class="subsection-title">Applications in De Novo Design</div>
        <ul class="bullet-list">
            <li><strong>Diversity penalty in loss function:</strong> Encourages generator to produce structurally distinct molecules rather than minor variations</li>
            <li><strong>Batch diversity optimization:</strong> Generate sets of molecules that collectively explore different chemical regions</li>
            <li><strong>Novelty-guided search:</strong> Prioritize regions of chemical space distant from known compounds</li>
            <li><strong>Scaffold hopping strategies:</strong> Systematically replace core structures while maintaining activity to discover new intellectual property</li>
        </ul>
    </div>

</body>
</html>